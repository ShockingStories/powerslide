function getRangeValues(){return{carNumber:document.getElementById("carNumber").value,solarNumber:document.getElementById("solarNumber").value,homeNumber:document.getElementById("homeNumber").value,powerOffNumber:document.getElementById("powerOffNumber").value,windfarmNumber:document.getElementById("windfarmNumber").value,busNumber:document.getElementById("busNumber").value,bicycleNumber:document.getElementById("bicycleNumber").value}}function updateCars(e){document.getElementById("carNumber").value=e,document.getElementById("carRange").value=e;var t=shockingUpdate(getRangeValues());console.log("Data from shockingUpdate: ",t),updateGraph("gwh-chart",t.gen_production),updateGraph("co2-chart",{Geothermal:t.gen_emissions.Geothermal,Coal:t.gen_emissions.Coal,Gas:t.gen_emissions.Gas,Road:t.fleet_emissions.Road})}function preprocessData(e,t){var n=[1],r=0;for(var a in e)e.hasOwnProperty(a)&&(r+=e[a],n.push(e[a]));t>0&&n.push(t);for(var o=1;o<n.length;o++)n[o]=Math.round(n[o]/r*100);return n}function updateTotal(e,t){var n=0;for(var r in t)t.hasOwnProperty(r)&&(n+=t[r]);return n=Math.round(n),console.log("Updated total: ",n),document.getElementById(e).innerHTML=n,n}function updateGraph(e,t){var n=80,r=300;console.log("Data passed in: ",t);var a=e.split("-")[0]+"-total",o=updateTotal(a,t);totals[a]||(console.log("Element: ",a,document.getElementById(a).innerHTML),totals[a]=parseInt(document.getElementById(a).innerHTML,10),console.log("TOTALS: ",totals));for(var l=totals[a]-o,s=document.getElementById(e);s.firstChild;)s.removeChild(s.firstChild);var u=d3.select("#"+e).append("svg:svg").attr("class","chart").attr("width",n).attr("height",r).append("svg:g").attr("transform","translate(0,"+r+")");console.log("DELTA: ",l);for(var c=[preprocessData(t,l)],d=[],i=0;i<c[0].length-1;i++)d.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")"),l>0&&(d[c[0].length-1]="rgb(255,255,255)");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,r]),z=d3.scale.ordinal().range(d);for(var m=[],i=1;i<c[0].length;i++)m.push("c"+i);var g=m.map(function(e,t){return c.map(function(e,n){return{x:n,y:e[t+1]}})}),p=d3.layout.stack()(g);x.domain(p[0].map(function(e){return e.x})),y.domain([0,d3.max(p[p.length-1],function(e){return e.y0+e.y})]);{var f=u.selectAll("g.valgroup").data(p).enter().append("svg:g").attr("class","valgroup").style("fill",function(e,t){return z(t)}).style("stroke",function(e,t){return d3.rgb(z(t)).darker()});f.selectAll("rect").data(function(e){return e}).enter().append("svg:rect").attr("x",function(e){return x(e.x)}).attr("y",function(e){return-y(e.y0)-y(e.y)}).attr("height",function(e){return y(e.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function randomRGB(){return Math.floor(256*Math.random())}function columnGraph(e,t){for(var n=80,r=300,a=d3.select(e).append("svg:svg").attr("class","chart").attr("width",n).attr("height",r).append("svg:g").attr("transform","translate(0,300)"),o=[t],l=[],s=0;s<o[0].length-1;s++)l.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,r]),z=d3.scale.ordinal().range(l);var u=["c1","c2","c3","c4","c5"].map(function(e,t){return o.map(function(e,n){return{x:n,y:e[t+1]}})}),c=d3.layout.stack()(u);x.domain(c[0].map(function(e){return e.x})),y.domain([0,d3.max(c[c.length-1],function(e){return e.y0+e.y})]);{var d=a.selectAll("g.valgroup").data(c).enter().append("svg:g").attr("class","valgroup").style("fill",function(e,t){return z(t)}).style("stroke",function(e,t){return d3.rgb(z(t)).darker()});d.selectAll("rect").data(function(e){return e}).enter().append("svg:rect").attr("x",function(e){return x(e.x)}).attr("y",function(e){return-y(e.y0)-y(e.y)}).attr("height",function(e){return y(e.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function shockingUpdate(e){console.log("shockingUpdate - Inputs: "+JSON.stringify(e));var t=getBaseline(),n=t.gen_production,r=t.gen_emissions,a=t.gen_cost,o={Road:12688},l=e.carNumber,s=l/100;o.Road=o.Road*(1-s),ev_power_reqts=2406.4*3341013*s,ev_power_reqts/=1e6;var u=0;for(var c in n)u+=n[c];var d=1+ev_power_reqts/u;console.log("total: "+u),console.log("increase from electric vehicles: "+d),console.log("ev_power_reqts "+ev_power_reqts);var i=(e.solarNumber,5260*e.solarNumber);i/=1e6,console.log("solar production: "+i);var m=i/u;d-=m;for(var c in r)r[c]=r[c]*d;for(var c in n)n[c]=n[c]*d;n.Solar=i;for(var c in r)r[c]=r[c]*d;for(var c in a)a[c]=a[c]*d;var g={gen_production:n,gen_emissions:r,gen_cost:a,fleet_emissions:o};return console.log("Result: "+JSON.stringify(g)),g}function getBaseline(){var e={Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626},t={Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51},n={Hydro:53872180,Geothermal:59535e3,Wind:43484e3,Coal:34177200,Gas:161044192},r={gen_production:e,gen_emissions:t,gen_cost:n};return r}function mockGWh(){return{Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626}}function mockAdjustGWh(){return{Hydro:24,Geothermal:648,Wind:1218,Coal:832,Gas:362}}function mockGenerationEmissions(){return{Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51}}function mockFleetEmissions(){return{Road:12688}}var totals={};document.addEventListener("DOMContentLoaded",function(e){updateCars(0),columnGraph("#cost-chart",[1,10,15,15,35,50]),columnGraph("#investment-chart",[1,5,10,15,45,50])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXJ0LmpzIiwiZW5naW5lLmpzIiwibW9jay5qcyJdLCJuYW1lcyI6WyJnZXRSYW5nZVZhbHVlcyIsImNhck51bWJlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsInNvbGFyTnVtYmVyIiwiaG9tZU51bWJlciIsInBvd2VyT2ZmTnVtYmVyIiwid2luZGZhcm1OdW1iZXIiLCJidXNOdW1iZXIiLCJiaWN5Y2xlTnVtYmVyIiwidXBkYXRlQ2FycyIsImRhdGEiLCJzaG9ja2luZ1VwZGF0ZSIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVHcmFwaCIsImdlbl9wcm9kdWN0aW9uIiwiR2VvdGhlcm1hbCIsImdlbl9lbWlzc2lvbnMiLCJDb2FsIiwiR2FzIiwiUm9hZCIsImZsZWV0X2VtaXNzaW9ucyIsInByZXByb2Nlc3NEYXRhIiwiZGVsdGEiLCJ2YWx1ZXMiLCJ0b3RhbCIsImsiLCJoYXNPd25Qcm9wZXJ0eSIsInB1c2giLCJpIiwibGVuZ3RoIiwiTWF0aCIsInJvdW5kIiwidXBkYXRlVG90YWwiLCJ0b3RhbElkIiwiaW5uZXJIVE1MIiwiYmluZFRvIiwidyIsImgiLCJzcGxpdCIsIm5ld1RvdGFsIiwidG90YWxzIiwicGFyc2VJbnQiLCJlbGVtZW50IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwic3ZnIiwiZDMiLCJzZWxlY3QiLCJhcHBlbmQiLCJhdHRyIiwibWF0cml4IiwiY29sb3JzIiwicmFuZG9tUkdCIiwieCIsInNjYWxlIiwib3JkaW5hbCIsInJhbmdlUm91bmRCYW5kcyIsInkiLCJsaW5lYXIiLCJyYW5nZSIsInoiLCJhIiwicmVtYXBwZWQiLCJtYXAiLCJkYXQiLCJkIiwiaWkiLCJzdGFja2VkIiwibGF5b3V0Iiwic3RhY2siLCJkb21haW4iLCJtYXgiLCJ5MCIsInZhbGdyb3VwIiwic2VsZWN0QWxsIiwiZW50ZXIiLCJzdHlsZSIsInJnYiIsImRhcmtlciIsIm1pbiIsImFwcGx5IiwicmFuZ2VCYW5kIiwiZmxvb3IiLCJyYW5kb20iLCJjb2x1bW5HcmFwaCIsImlucHV0cyIsIkpTT04iLCJzdHJpbmdpZnkiLCJiYXNlbGluZSIsImdldEJhc2VsaW5lIiwiZ2VuX2Nvc3QiLCJlbGVjdHJpY19wY3QiLCJldl9wb3dlcl9yZXF0cyIsInRvdGFsX2dlbiIsImtleSIsImluY3JlYXNlX2luX3Bvd2VyX3JlcXRzIiwic29sYXJfcHJvZHVjdGlvbiIsImRlY3JlYXNlX2R1ZV90b19zb2xhciIsInJlc3VsdCIsIkh5ZHJvIiwiV2luZCIsIm1vY2tHV2giLCJtb2NrQWRqdXN0R1doIiwibW9ja0dlbmVyYXRpb25FbWlzc2lvbnMiLCJtb2NrRmxlZXRFbWlzc2lvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiXSwibWFwcGluZ3MiOiJBQWFBLFFBQUFBLGtCQUNBLE9BQ0FDLFVBQUFDLFNBQUFDLGVBQUEsYUFBQUMsTUFDQUMsWUFBQUgsU0FBQUMsZUFBQSxlQUFBQyxNQUNBRSxXQUFBSixTQUFBQyxlQUFBLGNBQUFDLE1BQ0FHLGVBQUFMLFNBQUFDLGVBQUEsa0JBQUFDLE1BQ0FJLGVBQUFOLFNBQUFDLGVBQUEsa0JBQUFDLE1BQ0FLLFVBQUFQLFNBQUFDLGVBQUEsYUFBQUMsTUFDQU0sY0FBQVIsU0FBQUMsZUFBQSxpQkFBQUMsT0FJQSxRQUFBTyxZQUFBUCxHQUNBRixTQUFBQyxlQUFBLGFBQUFDLE1BQUFBLEVBQ0FGLFNBQUFDLGVBQUEsWUFBQUMsTUFBQUEsQ0FFQSxJQUFBUSxHQUFBQyxlQUFBYixpQkFFQWMsU0FBQUMsSUFBQSw2QkFBQUgsR0FDQUksWUFBQSxZQUFBSixFQUFBSyxnQkFDQUQsWUFBQSxhQUNBRSxXQUFBTixFQUFBTyxjQUFBLFdBQ0FDLEtBQUFSLEVBQUFPLGNBQUEsS0FDQUUsSUFBQVQsRUFBQU8sY0FBQSxJQUNBRyxLQUFBVixFQUFBVyxnQkFBQSxPQ3JDQSxRQUFBQyxnQkFBQVosRUFBQWEsR0FFQSxHQUFBQyxJQUFBLEdBQ0FDLEVBQUEsQ0FDQSxLQUFBLEdBQUFDLEtBQUFo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LGNBQUFBLEVBQ0EwRSxTQUFBQSxFQUdBLE9BQUFRLEdDbEpBLFFBQUFHLFdBQ0EsT0FDQUYsTUFBQSxNQUNBcEYsV0FBQSxLQUNBcUYsS0FBQSxLQUNBbkYsS0FBQSxLQUNBQyxJQUFBLE1BSUEsUUFBQW9GLGlCQUNBLE9BQ0FILE1BQUEsR0FDQXBGLFdBQUEsSUFDQXFGLEtBQUEsS0FDQW5GLEtBQUEsSUFDQUMsSUFBQSxLQUlBLFFBQUFxRiwyQkFDQSxPQUNBSixNQUFBLEVBQ0FwRixXQUFBLE9BQ0FxRixLQUFBLEVBQ0FuRixLQUFBLE9BQ0FDLElBQUEsU0FJQSxRQUFBc0Ysc0JBQ0EsT0FDQXJGLEtBQUEsT0hoQ0EsR0FBQXFCLFVBRUF6QyxVQUFBMEcsaUJBQUEsbUJBQUEsU0FBQUMsR0FDQWxHLFdBQUEsR0FDQTRFLFlBQUEsZUFDQSxFQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsS0FFQUEsWUFBQSxxQkFDQSxFQUFBLEVBQUEsR0FBQSxHQUFBLEdBQUEiLCJmaWxlIjoianMvYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHRvdGFscyA9IHt9O1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbihldmVudCkge1xuICB1cGRhdGVDYXJzKDApO1xuICBjb2x1bW5HcmFwaChcIiNjb3N0LWNoYXJ0XCIsIFtcbiAgICAxLCAxMCwgMTUsIDE1LCAzNSwgNTBcbiAgXSk7XG4gIGNvbHVtbkdyYXBoKFwiI2ludmVzdG1lbnQtY2hhcnRcIiwgW1xuICAgIDEsIDUsIDEwLCAxNSwgNDUsIDUwXG4gIF0pO1xufSk7XG5cbi8vIEVhY2ggc2xpZGVyJ3MgdmFsdWUsIHRvIHBhc3MgdG8gY2FsY3VsYXRvclxuZnVuY3Rpb24gZ2V0UmFuZ2VWYWx1ZXMgKCkge1xuICByZXR1cm4ge1xuICAgICdjYXJOdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyTnVtYmVyJykudmFsdWUsXG4gICAgJ3NvbGFyTnVtYmVyJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvbGFyTnVtYmVyJykudmFsdWUsXG4gICAgJ2hvbWVOdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG9tZU51bWJlcicpLnZhbHVlLFxuICAgICdwb3dlck9mZk51bWJlcic6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3dlck9mZk51bWJlcicpLnZhbHVlLFxuICAgICd3aW5kZmFybU51bWJlcic6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5kZmFybU51bWJlcicpLnZhbHVlLFxuICAgICdidXNOdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVzTnVtYmVyJykudmFsdWUsXG4gICAgJ2JpY3ljbGVOdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmljeWNsZU51bWJlcicpLnZhbHVlXG4gIH07XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNhcnMgKHZhbHVlKSB7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJOdW1iZXInKS52YWx1ZSA9IHZhbHVlO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyUmFuZ2UnKS52YWx1ZSA9IHZhbHVlO1xuXG4gIHZhciBkYXRhID0gc2hvY2tpbmdVcGRhdGUoZ2V0UmFuZ2VWYWx1ZXMoKSk7XG5cbiAgY29uc29sZS5sb2coXCJEYXRhIGZyb20gc2hvY2tpbmdVcGRhdGU6IFwiLCBkYXRhKTtcbiAgdXBkYXRlR3JhcGgoJ2d3aC1jaGFydCcsIGRhdGEuZ2VuX3Byb2R1Y3Rpb24pO1xuICB1cGRhdGVHcmFwaCgnY28yLWNoYXJ0Jywge1xuICAgICdHZW90aGVybWFsJzogZGF0YS5nZW5fZW1pc3Npb25zWydHZW90aGVybWFsJ10sXG4gICAgJ0NvYWwnOiBkYXRhLmdlbl9lbWlzc2lvbnNbJ0NvYWwnXSxcbiAgICAnR2FzJzogZGF0YS5nZW5fZW1pc3Npb25zWydHYXMnXSxcbiAgICAnUm9hZCc6IGRhdGEuZmxlZXRfZW1pc3Npb25zWydSb2FkJ11cbiAgfSk7XG59XG5cbiIsImZ1bmN0aW9uIHByZXByb2Nlc3NEYXRhIChkYXRhLCBkZWx0YSkge1xuICAvLyBIb3JyaWJsZSBrbHVkZ2UgdG8gZ2V0IHRoaW5ncyB3b3JraW5nIGZvciBwcm9vZiBvZiBjb25jZXB0Li4uXG4gIHZhciB2YWx1ZXMgPSBbMV07XG4gIHZhciB0b3RhbCA9IDA7XG4gIGZvciAodmFyIGsgaW4gZGF0YSkge1xuICAgIGlmKGRhdGEuaGFzT3duUHJvcGVydHkoaykpe1xuICAgICAgdG90YWwgKz0gZGF0YVtrXTtcbiAgICAgIHZhbHVlcy5wdXNoKGRhdGFba10pO1xuICAgIH1cbiAgfVxuXG4gIC8vIGRlbHRhIHJlcHJlc2VudHMgY2hhbmdlIGluIHRvdGFsIHZhbHVlXG4gIGlmIChkZWx0YSA+IDApIHtcbiAgICB2YWx1ZXMucHVzaChkZWx0YSk7XG4gIH1cblxuICAvLyBOZWVkIHBlcmNlbnQgdmFsdWVzIGZvciBjaGFydFxuICBmb3IgKHZhciBpID0gMTsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhbHVlc1tpXSA9IE1hdGgucm91bmQoKHZhbHVlc1tpXSAvIHRvdGFsKSAqIDEwMCk7XG4gIH1cblxuICByZXR1cm4gdmFsdWVzO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVUb3RhbCh0b3RhbElkLCBkYXRhKSB7XG4gIHZhciB0b3RhbCA9IDA7XG4gIGZvciAodmFyIGsgaW4gZGF0YSkge1xuICAgIGlmKGRhdGEuaGFzT3duUHJvcGVydHkoaykpe1xuICAgICAgdG90YWwgKz0gZGF0YVtrXTtcbiAgICB9XG4gIH1cbiAgdG90YWwgPSBNYXRoLnJvdW5kKHRvdGFsKTtcbiAgY29uc29sZS5sb2coXCJVcGRhdGVkIHRvdGFsOiBcIiwgdG90YWwpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0b3RhbElkKS5pbm5lckhUTUwgPSB0b3RhbDtcblxuICByZXR1cm4gdG90YWw7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUdyYXBoIChiaW5kVG8sIGRhdGEpIHtcbiAgdmFyIHcgPSA4MDtcbiAgdmFyIGggPSAzMDA7XG5cbiAgY29uc29sZS5sb2coXCJEYXRhIHBhc3NlZCBpbjogXCIsIGRhdGEpO1xuICB2YXIgdG90YWxJZCA9IGJpbmRUby5zcGxpdCgnLScpWzBdICsgJy10b3RhbCc7XG4gIHZhciBuZXdUb3RhbCA9IHVwZGF0ZVRvdGFsKHRvdGFsSWQsIGRhdGEpO1xuXG4gIC8vIFN0b3JlIGFzIGdsb2JhbCBmb3IgdGhlIGxpZmUgb2YgdGhlIGRvY3VtZW50XG4gIGlmICghdG90YWxzW3RvdGFsSWRdKSB7XG4gICAgY29uc29sZS5sb2coXCJFbGVtZW50OiBcIix0b3RhbElkLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0b3RhbElkKS5pbm5lckhUTUwpO1xuICAgIHRvdGFsc1t0b3RhbElkXSA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRvdGFsSWQpLmlubmVySFRNTCwgMTApO1xuICAgIGNvbnNvbGUubG9nKFwiVE9UQUxTOiBcIiwgdG90YWxzKTtcbiAgfVxuICB2YXIgZGVsdGEgPSB0b3RhbHNbdG90YWxJZF0gLSBuZXdUb3RhbDtcblxuICAvLyBIYWNreTogcmVtb3ZlIGNoYXJ0IGlmIGl0IGV4aXN0c1xuICAvLyBUT0RPOiB0cmFuc2l0aW9uIVxuICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJpbmRUbyk7XG4gIHdoaWxlIChlbGVtZW50LmZpcnN0Q2hpbGQpIHtcbiAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gIH1cblxuICB2YXIgc3ZnID0gZDMuc2VsZWN0KCcjJyArIGJpbmRUbykuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgdylcbiAgICAuYXR0cihcImhlaWdodFwiLCBoIClcbiAgICAuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLFwiICsgaCArIFwiKVwiKTtcblxuICAvLyBJZiBkaWZmZXJlbmNlIGJldHdlZW4gdG90YWxzIGlzIHBvc2l0aXZlLCBhbiBhZGRpdGlvbmFsIGFycmF5IGVsZW1lbnRcbiAgLy8gd2lsbCBiZSBhZGRlZCB0byBwYWQgdGhlIGNoYXJ0IGFzIHRoZSB0b3RhbCBzaHJpbmtzXG4gIGNvbnNvbGUubG9nKFwiREVMVEE6IFwiLCBkZWx0YSk7XG4gIHZhciBtYXRyaXggPSBbcHJlcHJvY2Vzc0RhdGEoZGF0YSwgZGVsdGEpXTtcblxuICAvLyBSYW5kb20gZm9yIG5vd1xuICB2YXIgY29sb3JzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0cml4WzBdLmxlbmd0aCAtMTsgaSsrKSB7XG4gICAgY29sb3JzLnB1c2goJ3JnYignICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJyknKTtcblxuICAgIC8vIFBhZGRpbmcgY29sb3VyXG4gICAgaWYgKGRlbHRhID4gMCkge1xuICAgICAgY29sb3JzW21hdHJpeFswXS5sZW5ndGgtMV0gPSBcInJnYigyNTUsMjU1LDI1NSlcIjtcbiAgICB9XG4gIH1cblxuICB4ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlUm91bmRCYW5kcyhbMCwgd10pO1xuICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKTtcbiAgeiA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZShjb2xvcnMpO1xuXG4gIC8vIENvcGUgd2l0aCB2YXJpYWJsZSBudW1iZXIgb2YgcHJvcGVydGllcywgZm9yIG5vd1xuICB2YXIgYSA9IFtdO1xuICBmb3IgKHZhciBpID0gMTsgaSA8IG1hdHJpeFswXS5sZW5ndGg7IGkrKykge1xuICAgIGEucHVzaChcImNcIiArIGkpO1xuICB9XG4gIC8vdmFyIHJlbWFwcGVkID0gW1wiYzFcIixcImMyXCIsXCJjM1wiLFwiYzRcIixcImM1XCJdLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gIHZhciByZW1hcHBlZCA9IGEubWFwKGZ1bmN0aW9uKGRhdCxpKXtcbiAgICByZXR1cm4gbWF0cml4Lm1hcChmdW5jdGlvbihkLGlpKXtcbiAgICAgIHJldHVybiB7eDogaWksIHk6IGRbaSsxXSB9O1xuICAgIH0pXG4gIH0pO1xuXG4gIHZhciBzdGFja2VkID0gZDMubGF5b3V0LnN0YWNrKCkocmVtYXBwZWQpXG5cbiAgeC5kb21haW4oc3RhY2tlZFswXS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KSk7XG4gIHkuZG9tYWluKFswLCBkMy5tYXgoc3RhY2tlZFtzdGFja2VkLmxlbmd0aCAtIDFdLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkwICsgZC55OyB9KV0pO1xuXG4gIHZhciB2YWxncm91cCA9IHN2Zy5zZWxlY3RBbGwoXCJnLnZhbGdyb3VwXCIpXG4gICAgLmRhdGEoc3RhY2tlZClcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ2YWxncm91cFwiKVxuICAgIC5zdHlsZShcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4geihpKTsgfSlcbiAgICAuc3R5bGUoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gZDMucmdiKHooaSkpLmRhcmtlcigpOyB9KTtcblxuICB2YXIgcmVjdCA9IHZhbGdyb3VwLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAuZGF0YShmdW5jdGlvbihkKXtyZXR1cm4gZDt9KVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHgoZC54KTsgfSlcbiAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gLXkoZC55MCkgLSB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLnkpOyB9KVxuICAgIC5hdHRyKFwid2lkdGhcIiwgTWF0aC5taW4uYXBwbHkobnVsbCwgW3gucmFuZ2VCYW5kKCktMiwgMTAwXSkpO1xufVxuXG5mdW5jdGlvbiByYW5kb21SR0IgKCkge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjU2KTtcbn1cblxuZnVuY3Rpb24gY29sdW1uR3JhcGggKGJpbmRUbywgdmFsdWVzKSB7XG4gIHZhciB3ID0gODA7XG4gIHZhciBoID0gMzAwO1xuXG4gIHZhciBzdmcgPSBkMy5zZWxlY3QoYmluZFRvKS5hcHBlbmQoXCJzdmc6c3ZnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcImNoYXJ0XCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGggKVxuICAgIC5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsMzAwKVwiKTtcblxuICB2YXIgbWF0cml4ID0gW3ZhbHVlc107XG5cbiAgLy8gUmFuZG9tIGZvciBub3dcbiAgdmFyIGNvbG9ycyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdHJpeFswXS5sZW5ndGggLTE7IGkrKykge1xuICAgIGNvbG9ycy5wdXNoKCdyZ2IoJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcpJyk7XG4gIH1cblxuICB4ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlUm91bmRCYW5kcyhbMCwgd10pO1xuICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKTtcbiAgeiA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZShjb2xvcnMpO1xuXG4gIHZhciByZW1hcHBlZCA9W1wiYzFcIixcImMyXCIsXCJjM1wiLFwiYzRcIixcImM1XCJdLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gICAgcmV0dXJuIG1hdHJpeC5tYXAoZnVuY3Rpb24oZCxpaSl7XG4gICAgICByZXR1cm4ge3g6IGlpLCB5OiBkW2krMV0gfTtcbiAgICB9KVxuICB9KTtcblxuICB2YXIgc3RhY2tlZCA9IGQzLmxheW91dC5zdGFjaygpKHJlbWFwcGVkKTtcblxuICB4LmRvbWFpbihzdGFja2VkWzBdLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLng7IH0pKTtcbiAgeS5kb21haW4oWzAsIGQzLm1heChzdGFja2VkW3N0YWNrZWQubGVuZ3RoIC0gMV0sIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueTAgKyBkLnk7IH0pXSk7XG5cbiAgdmFyIHZhbGdyb3VwID0gc3ZnLnNlbGVjdEFsbChcImcudmFsZ3JvdXBcIilcbiAgICAuZGF0YShzdGFja2VkKVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInZhbGdyb3VwXCIpXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiB6KGkpOyB9KVxuICAgIC5zdHlsZShcInN0cm9rZVwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBkMy5yZ2IoeihpKSkuZGFya2VyKCk7IH0pO1xuXG4gIHZhciByZWN0ID0gdmFsZ3JvdXAuc2VsZWN0QWxsKFwicmVjdFwiKVxuICAgIC5kYXRhKGZ1bmN0aW9uKGQpe3JldHVybiBkO30pXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOnJlY3RcIilcbiAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLngpOyB9KVxuICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiAteShkLnkwKSAtIHkoZC55KTsgfSlcbiAgICAuYXR0cihcImhlaWdodFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBNYXRoLm1pbi5hcHBseShudWxsLCBbeC5yYW5nZUJhbmQoKS0yLCAxMDBdKSk7XG59XG5cbiIsIi8vIHJlZmVyZW5jZTogaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvMXJqWlpnMTlnSDRTVDNYRmZQYVVtdmdDOTBBQ0tnUnc4eC1NZ29vemtMZkkvZWRpdCNnaWQ9MFxuXG5cbmZ1bmN0aW9uIHNob2NraW5nVXBkYXRlKGlucHV0cykge1xuXG5cdGNvbnNvbGUubG9nKFwic2hvY2tpbmdVcGRhdGUgLSBJbnB1dHM6IFwiICsgSlNPTi5zdHJpbmdpZnkoaW5wdXRzKSk7XG5cblx0dmFyIGJhc2VsaW5lID0gZ2V0QmFzZWxpbmUoKTtcblx0dmFyIGdlbl9wcm9kdWN0aW9uID0gYmFzZWxpbmVbJ2dlbl9wcm9kdWN0aW9uJ107XG5cdHZhciBnZW5fZW1pc3Npb25zICA9IGJhc2VsaW5lWydnZW5fZW1pc3Npb25zJ107XG5cdHZhciBnZW5fY29zdCAgICAgICA9IGJhc2VsaW5lWydnZW5fY29zdCddO1xuXG5cdC8vIGFubnVhbCB2ZWhpY2xlIGZsZWV0IGVtaXNzaW9ucyBpbiBLaWxvdG9ucyBvZiBDTzIgRXF1aXZhbGVudFxuXHR2YXIgZmxlZXRfZW1pc3Npb25zID0ge1xuXHRcdCdSb2FkJzogMTI2ODhcblx0fVxuIFxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBCdXNpbmVzcyBsb2dpY1xuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gWzFdIEVsZWN0cmljIGNhcnNcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblxuXHQvLyBBU1NVTVBUSU9OOiB0aGVyZSBhcmUgZXNzZW50aWFsbHkgMCBlbGVjdHJpYyBjYXJzIGluIHRoZSBjdXJyZW50IGZsZWV0XG5cdHZhciBjYXJOdW1iZXIgPSBpbnB1dHNbJ2Nhck51bWJlciddO1xuXHR2YXIgZWxlY3RyaWNfcGN0ID0gY2FyTnVtYmVyLzEwMDtcblxuXHRmbGVldF9lbWlzc2lvbnNbJ1JvYWQnXSA9IGZsZWV0X2VtaXNzaW9uc1snUm9hZCddICogKDEtZWxlY3RyaWNfcGN0KTtcblxuXHQvLyBBU1NVTVBUSU9OOiBhbnkgdXB0aWNrIGluIHBvd2VyIGdlbmVyYXRpb24gcmVxdWlyZWQgdG8gbWVldFxuXHQvLyBlbGVjdHJpYyBjYXIgZGVtYW5kLCB3aWxsIGJlIG1ldCBwcm9wb3J0aW9uYWxseSBieSBhbGwgZ2VuZXJhdGlvbiBzb3VyY2VzXG5cdC8vIEFTU1VNUFRJT046IHR5cGljYWwgRVYgd2lsbCB1c2UgMC4yIGtXaCBmb3IgMSBrbSB0cmF2ZWxsZWRcblx0Ly8gYXZlcmFnZSB0cmF2ZWwgaXMgMTIwMzIga20gcGVyIHllYXJcblx0Ly8gZmxlZXQgc2l6ZSBpcyAzMzQxMDEzXG5cdGV2X3Bvd2VyX3JlcXRzID0gMTIwMzIgKiAwLjIgKiAzMzQxMDEzICogZWxlY3RyaWNfcGN0O1xuXHRcblx0Ly8gY29udmVydCBrd2ggdG8gZ3doXG5cdGV2X3Bvd2VyX3JlcXRzID0gZXZfcG93ZXJfcmVxdHMgLyAxMDAwMDAwO1xuXG5cdC8vIHdvcmsgb3V0IHRvdGFsIGN1cnJlbnQgZ2VuZXJhdGlvblxuXHR2YXIgdG90YWxfZ2VuID0gMDtcblx0Zm9yICh2YXIga2V5IGluIGdlbl9wcm9kdWN0aW9uKSB7XG5cdFx0dG90YWxfZ2VuICs9IGdlbl9wcm9kdWN0aW9uW2tleV07XG5cdH1cblxuXHR2YXIgaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMgPSAxICsgKGV2X3Bvd2VyX3JlcXRzIC8gdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ3RvdGFsOiAnICsgdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ2luY3JlYXNlIGZyb20gZWxlY3RyaWMgdmVoaWNsZXM6ICcgKyBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyk7XG5cblx0Y29uc29sZS5sb2coJ2V2X3Bvd2VyX3JlcXRzICcgKyBldl9wb3dlcl9yZXF0cyk7XG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gWzJdIFNvbGFyIEhvdXNlc1xuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLVxuXHR2YXIgc29sYXJOdW1iZXIgPSBpbnB1dHNbJ3NvbGFyTnVtYmVyJ107XG5cblx0Ly8gQVNTVU1QVElPTiAtIGVhY2ggaG91c2Vob2xkIGdlbmVyYXRlcyA1MjYwIEtXaCBwZXIgeWVhclxuXHR2YXIgc29sYXJfcHJvZHVjdGlvbiA9IGlucHV0c1snc29sYXJOdW1iZXInXSAqIDUyNjA7XG5cdC8vIGNvbnZlcnQgdG8gR3doXG5cdHNvbGFyX3Byb2R1Y3Rpb24gPSBzb2xhcl9wcm9kdWN0aW9uIC8gMTAwMDAwMDtcblxuXHRjb25zb2xlLmxvZygnc29sYXIgcHJvZHVjdGlvbjogJyArIHNvbGFyX3Byb2R1Y3Rpb24pO1xuXHRcblx0Ly8gcmVkdWNlIHByb3BvcnRpb25hbGx5IGFsbCB0aGUgb3RoZXIgcHJvZHVjdGlvbiBhbmQgZW1pc3Npb25zXG5cdHZhciBkZWNyZWFzZV9kdWVfdG9fc29sYXIgPSBzb2xhcl9wcm9kdWN0aW9uIC8gdG90YWxfZ2VuO1xuXHRpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyAtPSBkZWNyZWFzZV9kdWVfdG9fc29sYXI7XG5cdFxuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX2VtaXNzaW9ucykge1xuXHRcdGdlbl9lbWlzc2lvbnNba2V5XSA9IGdlbl9lbWlzc2lvbnNba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gYXBwbHkgdGhlIGZhY3RvciB0byB0aGUgcHJvZHVjdGlvblxuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX3Byb2R1Y3Rpb24pIHtcblx0XHRnZW5fcHJvZHVjdGlvbltrZXldID0gZ2VuX3Byb2R1Y3Rpb25ba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gbm93IGFkZCBpbiB0aGUgc29sYXJcblx0Z2VuX3Byb2R1Y3Rpb25bJ1NvbGFyJ10gPSBzb2xhcl9wcm9kdWN0aW9uO1xuXG5cdC8vIG5vdyBhcHBseSB0aGF0IGZhY3RvciB0byB0aGUgZW1pc3Npb25zIC0gZW1pc3Npb25zIGZyb20gRVYgcG93ZXIgcmVxdWlyZW1lbnRzXG5cdGZvciAodmFyIGtleSBpbiBnZW5fZW1pc3Npb25zKSB7XG5cdFx0Z2VuX2VtaXNzaW9uc1trZXldID0gZ2VuX2VtaXNzaW9uc1trZXldICogaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHM7XG5cdH1cblxuXHQvLyBhbHNvIGFwcGx5IHRoZSBzYW1lIGZhY3RvciB0byB0aGUgZ2VuZXJhdGlvbiBjb3N0XG5cdGZvciAodmFyIGtleSBpbiBnZW5fY29zdCkge1xuXHRcdGdlbl9jb3N0W2tleV0gPSBnZW5fY29zdFtrZXldICogaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHM7XG5cdH1cblxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBPdXRwdXRcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0dmFyIHJlc3VsdCA9IHtcblx0XHQnZ2VuX3Byb2R1Y3Rpb24nOiBnZW5fcHJvZHVjdGlvbixcblx0XHQnZ2VuX2VtaXNzaW9ucyc6IGdlbl9lbWlzc2lvbnMsXG5cdFx0J2dlbl9jb3N0JzogZ2VuX2Nvc3QsXG5cdFx0J2ZsZWV0X2VtaXNzaW9ucyc6IGZsZWV0X2VtaXNzaW9uc1xuXHR9XG5cblx0Y29uc29sZS5sb2coXCJSZXN1bHQ6IFwiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG5cblx0cmV0dXJuIHJlc3VsdDtcbn1cblxuXG5mdW5jdGlvbiBnZXRCYXNlbGluZSgpIHtcblxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBCYXNlbGluZSBkYXRhIDogMjAxMy8yMDE0XG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cblx0Ly8gYW5udWFsIGdlbmVyYXRpb24gaW4gR2lnYXdhdHQgSG91cnNcblx0dmFyIGdlbl9wcm9kdWN0aW9uID0ge1xuXHRcdCdIeWRybyc6IDI0MDk1LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4Nyxcblx0XHQnV2luZCc6IDIxODcsXG5cdFx0J0NvYWwnOiAxODMyLFxuXHRcdCdHYXMnOiA2NjI2XG5cdH1cblxuXHQvLyBhbm51YWwgZ2VuZXJhdGlvbiBlbWlzc2lvbnMgaW4gS2lsb3RvbnMgb2YgQ08yIEVxdWl2YWxlbnRcblx0dmFyIGdlbl9lbWlzc2lvbnMgPSB7XG5cdFx0J0h5ZHJvJzogMCxcblx0XHQnR2VvdGhlcm1hbCc6IDg0Ny4zMixcblx0XHQnV2luZCc6IDAsXG5cdFx0J0NvYWwnOiAxMjIyLjIsXG5cdFx0J0dhcyc6IDM0MDUuNTFcblx0fVxuXG5cdC8vIGFubnVhbCBnZW5lcmF0aW9uIGNvc3RzIGluICROWiBwZXIgeWVhciAoSSB0aGluaylcblx0dmFyIGdlbl9jb3N0ID0ge1xuXHRcdCdIeWRybyc6IDUzODcyMTgwLFxuXHRcdCdHZW90aGVybWFsJzogNTk1MzUwMDAsXG5cdFx0J1dpbmQnOiA0MzQ4NDAwMCxcblx0XHQnQ29hbCc6IDM0MTc3MjAwLFxuXHRcdCdHYXMnOiAxNjEwNDQxOTJcblx0fVxuXG5cdHZhciByZXN1bHQgPSB7XG5cdFx0J2dlbl9wcm9kdWN0aW9uJzogZ2VuX3Byb2R1Y3Rpb24sXG5cdFx0J2dlbl9lbWlzc2lvbnMnOiBnZW5fZW1pc3Npb25zLFxuXHRcdCdnZW5fY29zdCc6IGdlbl9jb3N0LFxuXHR9XG5cblx0cmV0dXJuIHJlc3VsdDtcbn1cbiIsImZ1bmN0aW9uIG1vY2tHV2ggKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDI0MDk1LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4Nyxcblx0XHQnV2luZCc6IDIxODcsXG5cdFx0J0NvYWwnOiAxODMyLFxuXHRcdCdHYXMnOiA2NjI2XG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tBZGp1c3RHV2ggKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDI0LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4LFxuXHRcdCdXaW5kJzogMTIxOCxcblx0XHQnQ29hbCc6IDgzMixcblx0XHQnR2FzJzogMzYyXG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tHZW5lcmF0aW9uRW1pc3Npb25zICgpIHtcbiAgcmV0dXJuIHtcblx0XHQnSHlkcm8nOiAwLFxuXHRcdCdHZW90aGVybWFsJzogODQ3LjMyLFxuXHRcdCdXaW5kJzogMCxcblx0XHQnQ29hbCc6IDEyMjIuMixcblx0XHQnR2FzJzogMzQwNS41MVxuXHR9O1xufVxuXG5mdW5jdGlvbiBtb2NrRmxlZXRFbWlzc2lvbnMgKCkge1xuICByZXR1cm4ge1xuXHRcdCdSb2FkJzogMTI2ODhcblx0fTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==