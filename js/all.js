function updateCars(r){document.getElementById("carNumber").value=r,document.getElementById("carRange").value=r;var t=shockingUpdate({electric_cars:r});console.log(" ---- ",r," : ",t.gen_production),updateGraph("gwh-chart",t.gen_production),updateGraph("co2-chart",{Geothermal:t.gen_emissions.Geothermal,Coal:t.gen_emissions.Coal,Gas:t.gen_emissions.Gas,Road:t.fleet_emissions.Road})}function columnGraph(r,t){for(var n=80,e=300,a=d3.select(r).append("svg:svg").attr("class","chart").attr("width",n).attr("height",e).append("svg:g").attr("transform","translate(0,300)"),o=[t],s=[],l=0;l<o[0].length-1;l++)s.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,e]),z=d3.scale.ordinal().range(s);var c=["c1","c2","c3","c4","c5"].map(function(r,t){return o.map(function(r,n){return{x:n,y:r[t+1]}})}),i=d3.layout.stack()(c);x.domain(i[0].map(function(r){return r.x})),y.domain([0,d3.max(i[i.length-1],function(r){return r.y0+r.y})]);{var d=a.selectAll("g.valgroup").data(i).enter().append("svg:g").attr("class","valgroup").style("fill",function(r,t){return z(t)}).style("stroke",function(r,t){return d3.rgb(z(t)).darker()});d.selectAll("rect").data(function(r){return r}).enter().append("svg:rect").attr("x",function(r){return x(r.x)}).attr("y",function(r){return-y(r.y0)-y(r.y)}).attr("height",function(r){return y(r.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function preprocessData(r){var t=[1],n=0;for(var e in r)r.hasOwnProperty(e)&&(n+=r[e],t.push(r[e]));for(var a=1;a<t.length;a++)t[a]=Math.round(t[a]/n*100);return t}function updateGraph(r,t){var n=80,e=300,a=document.getElementById(r);for(console.log(a);a.firstChild;)a.removeChild(a.firstChild);for(var o=d3.select("#"+r).append("svg:svg").attr("class","chart").attr("width",n).attr("height",e).append("svg:g").attr("transform","translate(0,"+e+")"),s=[preprocessData(t)],l=[],c=0;c<s[0].length-1;c++)l.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,e]),z=d3.scale.ordinal().range(l);for(var i=[],c=1;c<s[0].length;c++)i.push("c"+c);var d=i.map(function(r,t){return s.map(function(r,n){return{x:n,y:r[t+1]}})}),u=d3.layout.stack()(d);x.domain(u[0].map(function(r){return r.x})),y.domain([0,d3.max(u[u.length-1],function(r){return r.y0+r.y})]);{var g=o.selectAll("g.valgroup").data(u).enter().append("svg:g").attr("class","valgroup").style("fill",function(r,t){return z(t)}).style("stroke",function(r,t){return d3.rgb(z(t)).darker()});g.selectAll("rect").data(function(r){return r}).enter().append("svg:rect").attr("x",function(r){return x(r.x)}).attr("y",function(r){return-y(r.y0)-y(r.y)}).attr("height",function(r){return y(r.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function randomRGB(){return Math.floor(256*Math.random())}function shockingUpdate(r){console.log("shockingUpdate - Inputs: "+JSON.stringify(r));var t={Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626},n={Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51},e={Road:12688},a=r.electric_cars,o=a/100;e.Road=e.Road*(1-o),ev_power_reqts=2406.4*3341013*o,ev_power_reqts/=1e6;var s=0;for(var l in t)s+=t[l];var c=1+ev_power_reqts/s;console.log("total: "+s),console.log("increase from electric vehicles: "+c),console.log("ev_power_reqts "+ev_power_reqts);for(var l in n)n[l]=n[l]*c;var i={gen_production:t,gen_emissions:n,fleet_emissions:e};return console.log("Result: "+JSON.stringify(i)),i}function mockGWh(){return{Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626}}function mockAdjustGWh(){return{Hydro:24,Geothermal:648,Wind:1218,Coal:832,Gas:362}}function mockGenerationEmissions(){return{Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51}}function mockFleetEmissions(){return{Road:12688}}document.addEventListener("DOMContentLoaded",function(r){updateCars(0),columnGraph("#cost-chart",[1,10,15,15,35,50]),columnGraph("#investment-chart",[1,5,10,15,45,50])});var input_example={electric_cars:2};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXJ0LmpzIiwiZW5naW5lLmpzIiwibW9jay5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVDYXJzIiwidmFsdWUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZGF0YSIsInNob2NraW5nVXBkYXRlIiwiZWxlY3RyaWNfY2FycyIsImNvbnNvbGUiLCJsb2ciLCJnZW5fcHJvZHVjdGlvbiIsInVwZGF0ZUdyYXBoIiwiR2VvdGhlcm1hbCIsImdlbl9lbWlzc2lvbnMiLCJDb2FsIiwiR2FzIiwiUm9hZCIsImZsZWV0X2VtaXNzaW9ucyIsImNvbHVtbkdyYXBoIiwiYmluZFRvIiwidmFsdWVzIiwidyIsImgiLCJzdmciLCJkMyIsInNlbGVjdCIsImFwcGVuZCIsImF0dHIiLCJtYXRyaXgiLCJjb2xvcnMiLCJpIiwibGVuZ3RoIiwicHVzaCIsInJhbmRvbVJHQiIsIngiLCJzY2FsZSIsIm9yZGluYWwiLCJyYW5nZVJvdW5kQmFuZHMiLCJ5IiwibGluZWFyIiwicmFuZ2UiLCJ6IiwicmVtYXBwZWQiLCJtYXAiLCJkYXQiLCJkIiwiaWkiLCJzdGFja2VkIiwibGF5b3V0Iiwic3RhY2siLCJkb21haW4iLCJtYXgiLCJ5MCIsInZhbGdyb3VwIiwic2VsZWN0QWxsIiwiZW50ZXIiLCJzdHlsZSIsInJnYiIsImRhcmtlciIsIk1hdGgiLCJtaW4iLCJhcHBseSIsInJhbmdlQmFuZCIsInByZXByb2Nlc3NEYXRhIiwidG90YWwiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJyb3VuZCIsImVsZW1lbnQiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJhIiwiZmxvb3IiLCJyYW5kb20iLCJpbnB1dHMiLCJKU09OIiwic3RyaW5naWZ5IiwiSHlkcm8iLCJXaW5kIiwiZWxlY3RyaWNfcGN0IiwiZXZfcG93ZXJfcmVxdHMiLCJ0b3RhbF9nZW4iLCJrZXkiLCJpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyIsInJlc3VsdCIsIm1vY2tHV2giLCJtb2NrQWRqdXN0R1doIiwibW9ja0dlbmVyYXRpb25FbWlzc2lvbnMiLCJtb2NrRmxlZXRFbWlzc2lvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbnB1dF9leGFtcGxlIl0sIm1hcHBpbmdzIjoiQUFrQkEsUUFBQUEsWUFBQUMsR0FDQUMsU0FBQUMsZUFBQSxhQUFBRixNQUFBQSxFQUNBQyxTQUFBQyxlQUFBLFlBQUFGLE1BQUFBLENBR0EsSUFBQUcsR0FBQUMsZ0JBQUFDLGNBQUFMLEdBQ0FNLFNBQUFDLElBQUEsU0FBQVAsRUFBQSxNQUFBRyxFQUFBSyxnQkFFQUMsWUFBQSxZQUFBTixFQUFBSyxnQkFDQUMsWUFBQSxhQUNBQyxXQUFBUCxFQUFBUSxjQUFBLFdBQ0FDLEtBQUFULEVBQUFRLGNBQUEsS0FDQUUsSUFBQVYsRUFBQVEsY0FBQSxJQUNBRyxLQUFBWCxFQUFBWSxnQkFBQSxPQy9CQSxRQUFBQyxhQUFBQyxFQUFBQyxHQWVBLElBQUEsR0FkQUMsR0FBQSxHQUNBQyxFQUFBLElBRUFDLEVBQUFDLEdBQUFDLE9BQUFOLEdBQUFPLE9BQUEsV0FDQUMsS0FBQSxRQUFBLFNBQ0FBLEtBQUEsUUFBQU4sR0FDQU0sS0FBQSxTQUFBTCxHQUNBSSxPQUFBLFNBQ0FDLEtBQUEsWUFBQSxvQkFFQUMsR0FBQVIsR0FHQVMsS0FDQUMsRUFBQSxFQUFBQSxFQUFBRixFQUFBLEdBQUFHLE9BQUEsRUFBQUQsSUFDQUQsRUFBQUcsS0FBQSxPQUFBQyxZQUFBLElBQUFBLFlBQUEsSUFBQUEsWUFBQSxJQUdBQyxHQUFBVixHQUFBVyxNQUFBQyxVQUFBQyxpQkFBQSxFQUFBaEIsSUFDQWlCLEVBQUFkLEdBQUFXLE1BQUFJLFNBQUFDLE9BQUEsRUFBQWxCLElBQ0FtQixFQUFBakIsR0FBQVcsTUFBQUMsVUFBQUksTUFBQVgsRUFFQSxJQUFBYSxJQUFBLEtBQUEsS0FBQSxLQUFBLEtBQUEsTUFBQUMsSUFBQSxTQUFBQyxFQUFBZCxHQUNBLE1BQUFGLEdBQUFlLElBQUEsU0FBQUUsRUFBQUMsR0FDQSxPQUFBWixFQUFBWSxFQUFB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QUMsS0FBQXhFLEdBQ0F1RSxHQUFBdkUsRUFBQXdFLEVBR0EsSUFBQUMsR0FBQSxFQUFBSCxlQUFBQyxDQUNBekUsU0FBQUMsSUFBQSxVQUFBd0UsR0FDQXpFLFFBQUFDLElBQUEsb0NBQUEwRSxHQUVBM0UsUUFBQUMsSUFBQSxrQkFBQXVFLGVBR0EsS0FBQSxHQUFBRSxLQUFBckUsR0FDQUEsRUFBQXFFLEdBQUFyRSxFQUFBcUUsR0FBQUMsQ0FNQSxJQUFBQyxJQUNBMUUsZUFBQUEsRUFDQUcsY0FBQUEsRUFDQUksZ0JBQUFBLEVBS0EsT0FGQVQsU0FBQUMsSUFBQSxXQUFBa0UsS0FBQUMsVUFBQVEsSUFFQUEsRUN6RkEsUUFBQUMsV0FDQSxPQUNBUixNQUFBLE1BQ0FqRSxXQUFBLEtBQ0FrRSxLQUFBLEtBQ0FoRSxLQUFBLEtBQ0FDLElBQUEsTUFJQSxRQUFBdUUsaUJBQ0EsT0FDQVQsTUFBQSxHQUNBakUsV0FBQSxJQUNBa0UsS0FBQSxLQUNBaEUsS0FBQSxJQUNBQyxJQUFBLEtBSUEsUUFBQXdFLDJCQUNBLE9BQ0FWLE1BQUEsRUFDQWpFLFdBQUEsT0FDQWtFLEtBQUEsRUFDQWhFLEtBQUEsT0FDQUMsSUFBQSxTQUlBLFFBQUF5RSxzQkFDQSxPQUNBeEUsS0FBQSxPSGhDQWIsU0FBQXNGLGlCQUFBLG1CQUFBLFNBQUFDLEdBSUF6RixXQUFBLEdBS0FpQixZQUFBLGVBQ0EsRUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBRUFBLFlBQUEscUJBQ0EsRUFBQSxFQUFBLEdBQUEsR0FBQSxHQUFBLE1FWEEsSUFBQXlFLGdCQUVBcEYsY0FBQSIsImZpbGUiOiJqcy9hbGwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbihldmVudCkge1xuICAvL2NvbHVtbkdyYXBoKFwiI2NvMi1jaGFydFwiLCBbXG4gICAgLy8xLCAxMCwgMjAsIDIwLCAyNSwgNTBcbiAgLy9dKTtcbiAgdXBkYXRlQ2FycygwKTtcbiAgLy91cGRhdGVHcmFwaCgnZ3doLWNoYXJ0JywgbW9ja0dXaCgpKTtcbiAgLy9jb2x1bW5HcmFwaChcIiNnd2gtY2hhcnRcIiwgW1xuICAgIC8vMSwgMTAsIDE1LCAyMCwgMzAsIDUwXG4gIC8vXSk7XG4gIGNvbHVtbkdyYXBoKFwiI2Nvc3QtY2hhcnRcIiwgW1xuICAgIDEsIDEwLCAxNSwgMTUsIDM1LCA1MFxuICBdKTtcbiAgY29sdW1uR3JhcGgoXCIjaW52ZXN0bWVudC1jaGFydFwiLCBbXG4gICAgMSwgNSwgMTAsIDE1LCA0NSwgNTBcbiAgXSk7XG59KTtcblxuXG5mdW5jdGlvbiB1cGRhdGVDYXJzICh2YWx1ZSkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyTnVtYmVyJykudmFsdWUgPSB2YWx1ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhclJhbmdlJykudmFsdWUgPSB2YWx1ZTtcbiAgLy91cGRhdGVHcmFwaCgnZ3doLWNoYXJ0JywgbW9ja0FkanVzdEdXaCgpKTsgXG5cbiAgdmFyIGRhdGEgPSBzaG9ja2luZ1VwZGF0ZSh7J2VsZWN0cmljX2NhcnMnOiB2YWx1ZX0pO1xuICBjb25zb2xlLmxvZyhcIiAtLS0tIFwiLCB2YWx1ZSwgXCIgOiBcIiwgZGF0YS5nZW5fcHJvZHVjdGlvbik7XG5cbiAgdXBkYXRlR3JhcGgoJ2d3aC1jaGFydCcsIGRhdGEuZ2VuX3Byb2R1Y3Rpb24pO1xuICB1cGRhdGVHcmFwaCgnY28yLWNoYXJ0Jywge1xuICAgICdHZW90aGVybWFsJzogZGF0YS5nZW5fZW1pc3Npb25zWydHZW90aGVybWFsJ10sXG4gICAgJ0NvYWwnOiBkYXRhLmdlbl9lbWlzc2lvbnNbJ0NvYWwnXSxcbiAgICAnR2FzJzogZGF0YS5nZW5fZW1pc3Npb25zWydHYXMnXSxcbiAgICAnUm9hZCc6IGRhdGEuZmxlZXRfZW1pc3Npb25zWydSb2FkJ11cbiAgfSk7XG59XG5cbiIsImZ1bmN0aW9uIGNvbHVtbkdyYXBoIChiaW5kVG8sIHZhbHVlcykge1xuICB2YXIgdyA9IDgwO1xuICB2YXIgaCA9IDMwMDtcblxuICB2YXIgc3ZnID0gZDMuc2VsZWN0KGJpbmRUbykuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgdylcbiAgICAuYXR0cihcImhlaWdodFwiLCBoIClcbiAgICAuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLDMwMClcIik7XG5cbiAgdmFyIG1hdHJpeCA9IFt2YWx1ZXNdO1xuXG4gIC8vIFJhbmRvbSBmb3Igbm93XG4gIHZhciBjb2xvcnMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRyaXhbMF0ubGVuZ3RoIC0xOyBpKyspIHtcbiAgICBjb2xvcnMucHVzaCgncmdiKCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnKScpO1xuICB9XG5cbiAgeCA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZVJvdW5kQmFuZHMoWzAsIHddKTtcbiAgeSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFswLCBoXSk7XG4gIHogPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2UoY29sb3JzKTtcblxuICB2YXIgcmVtYXBwZWQgPVtcImMxXCIsXCJjMlwiLFwiYzNcIixcImM0XCIsXCJjNVwiXS5tYXAoZnVuY3Rpb24oZGF0LGkpe1xuICAgIHJldHVybiBtYXRyaXgubWFwKGZ1bmN0aW9uKGQsaWkpe1xuICAgICAgcmV0dXJuIHt4OiBpaSwgeTogZFtpKzFdIH07XG4gICAgfSlcbiAgfSk7XG5cbiAgdmFyIHN0YWNrZWQgPSBkMy5sYXlvdXQuc3RhY2soKShyZW1hcHBlZCk7XG5cbiAgeC5kb21haW4oc3RhY2tlZFswXS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KSk7XG4gIHkuZG9tYWluKFswLCBkMy5tYXgoc3RhY2tlZFtzdGFja2VkLmxlbmd0aCAtIDFdLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkwICsgZC55OyB9KV0pO1xuXG4gIHZhciB2YWxncm91cCA9IHN2Zy5zZWxlY3RBbGwoXCJnLnZhbGdyb3VwXCIpXG4gICAgLmRhdGEoc3RhY2tlZClcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ2YWxncm91cFwiKVxuICAgIC5zdHlsZShcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4geihpKTsgfSlcbiAgICAuc3R5bGUoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gZDMucmdiKHooaSkpLmRhcmtlcigpOyB9KTtcblxuICB2YXIgcmVjdCA9IHZhbGdyb3VwLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAuZGF0YShmdW5jdGlvbihkKXtyZXR1cm4gZDt9KVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHgoZC54KTsgfSlcbiAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gLXkoZC55MCkgLSB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLnkpOyB9KVxuICAgIC5hdHRyKFwid2lkdGhcIiwgTWF0aC5taW4uYXBwbHkobnVsbCwgW3gucmFuZ2VCYW5kKCktMiwgMTAwXSkpO1xufVxuXG5mdW5jdGlvbiBwcmVwcm9jZXNzRGF0YSAoZGF0YSkge1xuICAvLyBIb3JyaWJsZSBrbHVkZ2UgdG8gZ2V0IHRoaW5ncyB3b3JraW5nIGZvciBwcm9vZiBvZiBjb25jZXB0Li4uXG4gIHZhciB2YWx1ZXMgPSBbMV07XG4gIHZhciB0b3RhbCA9IDA7XG4gIGZvciAodmFyIGsgaW4gZGF0YSkge1xuICAgIGlmKGRhdGEuaGFzT3duUHJvcGVydHkoaykpe1xuICAgICAgdG90YWwgKz0gZGF0YVtrXTtcbiAgICAgIHZhbHVlcy5wdXNoKGRhdGFba10pO1xuICAgIH1cbiAgfVxuXG4gIC8vIE5lZWQgcGVyY2VudCB2YWx1ZXMgZm9yIGNoYXJ0XG4gIGZvciAodmFyIGkgPSAxOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFsdWVzW2ldID0gTWF0aC5yb3VuZCgodmFsdWVzW2ldIC8gdG90YWwpICogMTAwKTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZXM7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUdyYXBoIChiaW5kVG8sIGRhdGEpIHtcbiAgdmFyIHcgPSA4MDtcbiAgdmFyIGggPSAzMDA7XG5cbiAgLy8gSGFja3k6IHJlbW92ZSBjaGFydCBpZiBpdCBleGlzdHNcbiAgLy8gVE9ETzogdHJhbnNpdGlvbiFcbiAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChiaW5kVG8pO1xuICBjb25zb2xlLmxvZyhlbGVtZW50KTtcbiAgd2hpbGUgKGVsZW1lbnQuZmlyc3RDaGlsZCkge1xuICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcbiAgfVxuXG4gIHZhciBzdmcgPSBkMy5zZWxlY3QoJyMnICsgYmluZFRvKS5hcHBlbmQoXCJzdmc6c3ZnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcImNoYXJ0XCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGggKVxuICAgIC5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsXCIgKyBoICsgXCIpXCIpO1xuXG4gIHZhciBtYXRyaXggPSBbcHJlcHJvY2Vzc0RhdGEoZGF0YSldO1xuXG4gIC8vIFJhbmRvbSBmb3Igbm93XG4gIHZhciBjb2xvcnMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRyaXhbMF0ubGVuZ3RoIC0xOyBpKyspIHtcbiAgICBjb2xvcnMucHVzaCgncmdiKCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnKScpO1xuICB9XG5cbiAgeCA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZVJvdW5kQmFuZHMoWzAsIHddKTtcbiAgeSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFswLCBoXSk7XG4gIHogPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2UoY29sb3JzKTtcblxuICAvLyBDb3BlIHdpdGggdmFyaWFibGUgbnVtYmVyIG9mIHByb3BlcnRpZXMsIGZvciBub3dcbiAgdmFyIGEgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBtYXRyaXhbMF0ubGVuZ3RoOyBpKyspIHtcbiAgICBhLnB1c2goXCJjXCIgKyBpKTtcbiAgfVxuICAvL3ZhciByZW1hcHBlZCA9IFtcImMxXCIsXCJjMlwiLFwiYzNcIixcImM0XCIsXCJjNVwiXS5tYXAoZnVuY3Rpb24oZGF0LGkpe1xuICB2YXIgcmVtYXBwZWQgPSBhLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gICAgcmV0dXJuIG1hdHJpeC5tYXAoZnVuY3Rpb24oZCxpaSl7XG4gICAgICByZXR1cm4ge3g6IGlpLCB5OiBkW2krMV0gfTtcbiAgICB9KVxuICB9KTtcblxuICB2YXIgc3RhY2tlZCA9IGQzLmxheW91dC5zdGFjaygpKHJlbWFwcGVkKVxuXG4gIHguZG9tYWluKHN0YWNrZWRbMF0ubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSkpO1xuICB5LmRvbWFpbihbMCwgZDMubWF4KHN0YWNrZWRbc3RhY2tlZC5sZW5ndGggLSAxXSwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55MCArIGQueTsgfSldKTtcblxuICB2YXIgdmFsZ3JvdXAgPSBzdmcuc2VsZWN0QWxsKFwiZy52YWxncm91cFwiKVxuICAgIC5kYXRhKHN0YWNrZWQpXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwidmFsZ3JvdXBcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIHooaSk7IH0pXG4gICAgLnN0eWxlKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGQzLnJnYih6KGkpKS5kYXJrZXIoKTsgfSk7XG5cbiAgdmFyIHJlY3QgPSB2YWxncm91cC5zZWxlY3RBbGwoXCJyZWN0XCIpXG4gICAgLmRhdGEoZnVuY3Rpb24oZCl7cmV0dXJuIGQ7fSlcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6cmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQueCk7IH0pXG4gICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIC15KGQueTApIC0geShkLnkpOyB9KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC55KTsgfSlcbiAgICAuYXR0cihcIndpZHRoXCIsIE1hdGgubWluLmFwcGx5KG51bGwsIFt4LnJhbmdlQmFuZCgpLTIsIDEwMF0pKTtcbn1cblxuZnVuY3Rpb24gcmFuZG9tUkdCICgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1Nik7XG59XG4iLCIvLyByZWZlcmVuY2U6IGh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kLzFyalpaZzE5Z0g0U1QzWEZmUGFVbXZnQzkwQUNLZ1J3OHgtTWdvb3prTGZJL2VkaXQjZ2lkPTBcblxudmFyIGlucHV0X2V4YW1wbGUgPSB7XG5cdC8vICUgb2YgZWxlY3RyaWMgY2Fyc1xuXHQnZWxlY3RyaWNfY2Fycyc6IDJcbn1cblxuXG5mdW5jdGlvbiBzaG9ja2luZ1VwZGF0ZShpbnB1dHMpIHtcblxuXHRjb25zb2xlLmxvZyhcInNob2NraW5nVXBkYXRlIC0gSW5wdXRzOiBcIiArIEpTT04uc3RyaW5naWZ5KGlucHV0cykpO1xuXG5cblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0Ly8gQmFzZWxpbmUgZGF0YSBcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuXHQvLyBhbm51YWwgZ2VuZXJhdGlvbiBpbiBHaWdhd2F0dCBIb3Vyc1xuXHR2YXIgZ2VuX3Byb2R1Y3Rpb24gPSB7XG5cdFx0J0h5ZHJvJzogMjQwOTUsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDg3LFxuXHRcdCdXaW5kJzogMjE4Nyxcblx0XHQnQ29hbCc6IDE4MzIsXG5cdFx0J0dhcyc6IDY2MjZcblx0fVxuXG5cdC8vIGFubnVhbCBnZW5lcmF0aW9uIGVtaXNzaW9ucyBpbiBLaWxvdG9ucyBvZiBDTzIgRXF1aXZhbGVudFxuXHR2YXIgZ2VuX2VtaXNzaW9ucyA9IHtcblx0XHQnSHlkcm8nOiAwLFxuXHRcdCdHZW90aGVybWFsJzogODQ3LjMyLFxuXHRcdCdXaW5kJzogMCxcblx0XHQnQ29hbCc6IDEyMjIuMixcblx0XHQnR2FzJzogMzQwNS41MVxuXHR9XG5cblx0Ly8gYW5udWFsIHZlaGljbGUgZmxlZXQgZW1pc3Npb25zIGluIEtpbG90b25zIG9mIENPMiBFcXVpdmFsZW50XG5cdHZhciBmbGVldF9lbWlzc2lvbnMgPSB7XG5cdFx0J1JvYWQnOiAxMjY4OFxuXHR9XG4gXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdC8vIEJ1c2luZXNzIGxvZ2ljXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdFxuXHQvLyBbMV0gRWxlY3RyaWMgY2Fyc1xuXHQvLyBBU1NVTVBUSU9OOiB0aGVyZSBhcmUgZXNzZW50aWFsbHkgMCBlbGVjdHJpYyBjYXJzIGluIHRoZSBjdXJyZW50IGZsZWV0XG5cdHZhciBlbGVjdHJpY19jYXJzID0gaW5wdXRzWydlbGVjdHJpY19jYXJzJ107XG5cdHZhciBlbGVjdHJpY19wY3QgPSBlbGVjdHJpY19jYXJzLzEwMDtcblxuXHRmbGVldF9lbWlzc2lvbnNbJ1JvYWQnXSA9IGZsZWV0X2VtaXNzaW9uc1snUm9hZCddICogKDEtZWxlY3RyaWNfcGN0KTtcblxuXHQvLyBBU1NVTVBUSU9OOiBhbnkgdXB0aWNrIGluIHBvd2VyIGdlbmVyYXRpb24gcmVxdWlyZWQgdG8gbWVldFxuXHQvLyBlbGVjdHJpYyBjYXIgZGVtYW5kLCB3aWxsIGJlIG1ldCBwcm9wb3J0aW9uYWxseSBieSBhbGwgZ2VuZXJhdGlvbiBzb3VyY2VzXG5cdC8vIEFTU1VNUFRJT046IHR5cGljYWwgRVYgd2lsbCB1c2UgMC4yIGtXaCBmb3IgMSBrbSB0cmF2ZWxsZWRcblx0Ly8gYXZlcmFnZSB0cmF2ZWwgaXMgMTIwMzIga20gcGVyIHllYXJcblx0Ly8gZmxlZXQgc2l6ZSBpcyAzMzQxMDEzXG5cdGV2X3Bvd2VyX3JlcXRzID0gMTIwMzIgKiAwLjIgKiAzMzQxMDEzICogZWxlY3RyaWNfcGN0O1xuXHRcblx0Ly8gY29udmVydCBrd2ggdG8gZ3doXG5cdGV2X3Bvd2VyX3JlcXRzID0gZXZfcG93ZXJfcmVxdHMgLyAxMDAwMDAwO1xuXG5cdC8vIHdvcmsgb3V0IHRvdGFsIGN1cnJlbnQgZ2VuZXJhdGlvblxuXHR2YXIgdG90YWxfZ2VuID0gMDtcblx0Zm9yICh2YXIga2V5IGluIGdlbl9wcm9kdWN0aW9uKSB7XG5cdFx0dG90YWxfZ2VuICs9IGdlbl9wcm9kdWN0aW9uW2tleV07XG5cdH1cblxuXHR2YXIgaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMgPSAxICsgKGV2X3Bvd2VyX3JlcXRzIC8gdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ3RvdGFsOiAnICsgdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ2luY3JlYXNlIGZyb20gZWxlY3RyaWMgdmVoaWNsZXM6ICcgKyBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyk7XG5cblx0Y29uc29sZS5sb2coJ2V2X3Bvd2VyX3JlcXRzICcgKyBldl9wb3dlcl9yZXF0cyk7XG5cblx0Ly8gbm93IGFwcGx5IHRoYXQgZmFjdG9yIHRvIHRoZSBlbWlzc2lvbnMgLSBlbWlzc2lvbnMgZnJvbSBFViBwb3dlciByZXF1aXJlbWVudHNcblx0Zm9yICh2YXIga2V5IGluIGdlbl9lbWlzc2lvbnMpIHtcblx0XHRnZW5fZW1pc3Npb25zW2tleV0gPSBnZW5fZW1pc3Npb25zW2tleV0gKiBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cztcblx0fVxuXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdC8vIE91dHB1dFxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHR2YXIgcmVzdWx0ID0ge1xuXHRcdCdnZW5fcHJvZHVjdGlvbic6IGdlbl9wcm9kdWN0aW9uLFxuXHRcdCdnZW5fZW1pc3Npb25zJzogZ2VuX2VtaXNzaW9ucyxcblx0XHQnZmxlZXRfZW1pc3Npb25zJzogZmxlZXRfZW1pc3Npb25zXG5cdH1cblxuXHRjb25zb2xlLmxvZyhcIlJlc3VsdDogXCIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcblxuXHRyZXR1cm4gcmVzdWx0O1xufVxuIiwiZnVuY3Rpb24gbW9ja0dXaCAoKSB7XG4gIHJldHVybiB7XG5cdFx0J0h5ZHJvJzogMjQwOTUsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDg3LFxuXHRcdCdXaW5kJzogMjE4Nyxcblx0XHQnQ29hbCc6IDE4MzIsXG5cdFx0J0dhcyc6IDY2MjZcblx0fTtcbn1cblxuZnVuY3Rpb24gbW9ja0FkanVzdEdXaCAoKSB7XG4gIHJldHVybiB7XG5cdFx0J0h5ZHJvJzogMjQsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDgsXG5cdFx0J1dpbmQnOiAxMjE4LFxuXHRcdCdDb2FsJzogODMyLFxuXHRcdCdHYXMnOiAzNjJcblx0fTtcbn1cblxuZnVuY3Rpb24gbW9ja0dlbmVyYXRpb25FbWlzc2lvbnMgKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDAsXG5cdFx0J0dlb3RoZXJtYWwnOiA4NDcuMzIsXG5cdFx0J1dpbmQnOiAwLFxuXHRcdCdDb2FsJzogMTIyMi4yLFxuXHRcdCdHYXMnOiAzNDA1LjUxXG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tGbGVldEVtaXNzaW9ucyAoKSB7XG4gIHJldHVybiB7XG5cdFx0J1JvYWQnOiAxMjY4OFxuXHR9O1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9