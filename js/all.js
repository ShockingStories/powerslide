function updateCars(r){document.getElementById("carNumber").value=r,document.getElementById("carRange").value=r,updateGraph("gwh-chart",mockAdjustGWh())}function columnGraph(r,t){for(var n=80,e=300,a=d3.select(r).append("svg:svg").attr("class","chart").attr("width",n).attr("height",e).append("svg:g").attr("transform","translate(0,300)"),o=[t],c=[],l=0;l<o[0].length-1;l++)c.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,e]),z=d3.scale.ordinal().range(c);var s=["c1","c2","c3","c4","c5"].map(function(r,t){return o.map(function(r,n){return{x:n,y:r[t+1]}})}),u=d3.layout.stack()(s);x.domain(u[0].map(function(r){return r.x})),y.domain([0,d3.max(u[u.length-1],function(r){return r.y0+r.y})]);{var d=a.selectAll("g.valgroup").data(u).enter().append("svg:g").attr("class","valgroup").style("fill",function(r,t){return z(t)}).style("stroke",function(r,t){return d3.rgb(z(t)).darker()});d.selectAll("rect").data(function(r){return r}).enter().append("svg:rect").attr("x",function(r){return x(r.x)}).attr("y",function(r){return-y(r.y0)-y(r.y)}).attr("height",function(r){return y(r.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function preprocessData(r){var t=[1],n=0;for(var e in r)r.hasOwnProperty(e)&&(n+=r[e],t.push(r[e]));for(var a=1;a<t.length;a++)t[a]=Math.round(t[a]/n*100);return t}function updateGraph(r,t){var n=80,e=300,a=document.getElementById(r);for(console.log(a);a.firstChild;)a.removeChild(a.firstChild);for(var o=d3.select("#"+r).append("svg:svg").attr("class","chart").attr("width",n).attr("height",e).append("svg:g").attr("transform","translate(0,"+e+")"),c=[preprocessData(t)],l=[],s=0;s<c[0].length-1;s++)l.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,n]),y=d3.scale.linear().range([0,e]),z=d3.scale.ordinal().range(l);var u=["c1","c2","c3","c4","c5"].map(function(r,t){return c.map(function(r,n){return{x:n,y:r[t+1]}})}),d=d3.layout.stack()(u);x.domain(d[0].map(function(r){return r.x})),y.domain([0,d3.max(d[d.length-1],function(r){return r.y0+r.y})]);{var i=o.selectAll("g.valgroup").data(d).enter().append("svg:g").attr("class","valgroup").style("fill",function(r,t){return z(t)}).style("stroke",function(r,t){return d3.rgb(z(t)).darker()});i.selectAll("rect").data(function(r){return r}).enter().append("svg:rect").attr("x",function(r){return x(r.x)}).attr("y",function(r){return-y(r.y0)-y(r.y)}).attr("height",function(r){return y(r.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function randomRGB(){return Math.floor(256*Math.random())}function shockingUpdate(r){console.log("shockingUpdate - Inputs: "+JSON.stringify(r));var t={Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626},n={Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51},e={Road:12688},a=r.electric_cars,o=a/100;e.Road=e.Road*(1-o),ev_power_reqts=2406.4*3341013*o,ev_power_reqts/=1e6;var c=0;for(var l in t)c+=t[l];var s=1+ev_power_reqts/c;console.log("total: "+c),console.log("increase from electric vehicles: "+s),console.log("ev_power_reqts "+ev_power_reqts);for(var l in n)n[l]=n[l]*s;var u={gen_production:t,gen_emissions:n,fleet_emissions:e};return console.log("Result: "+JSON.stringify(u)),u}function mockGWh(){return{Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626}}function mockAdjustGWh(){return{Hydro:24,Geothermal:648,Wind:1218,Coal:832,Gas:362}}function mockGenerationEmissions(){return{Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51}}function mockFleetEmissions(){return{Road:12688}}document.addEventListener("DOMContentLoaded",function(r){columnGraph("#co2-chart",[1,10,20,20,25,50]),updateGraph("gwh-chart",mockGWh()),columnGraph("#cost-chart",[1,10,15,15,35,50]),columnGraph("#investment-chart",[1,5,10,15,45,50])});var input_example={electric_cars:2};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXJ0LmpzIiwiZW5naW5lLmpzIiwibW9jay5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVDYXJzIiwidmFsdWUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidXBkYXRlR3JhcGgiLCJtb2NrQWRqdXN0R1doIiwiY29sdW1uR3JhcGgiLCJiaW5kVG8iLCJ2YWx1ZXMiLCJ3IiwiaCIsInN2ZyIsImQzIiwic2VsZWN0IiwiYXBwZW5kIiwiYXR0ciIsIm1hdHJpeCIsImNvbG9ycyIsImkiLCJsZW5ndGgiLCJwdXNoIiwicmFuZG9tUkdCIiwieCIsInNjYWxlIiwib3JkaW5hbCIsInJhbmdlUm91bmRCYW5kcyIsInkiLCJsaW5lYXIiLCJyYW5nZSIsInoiLCJyZW1hcHBlZCIsIm1hcCIsImRhdCIsImQiLCJpaSIsInN0YWNrZWQiLCJsYXlvdXQiLCJzdGFjayIsImRvbWFpbiIsIm1heCIsInkwIiwidmFsZ3JvdXAiLCJzZWxlY3RBbGwiLCJkYXRhIiwiZW50ZXIiLCJzdHlsZSIsInJnYiIsImRhcmtlciIsIk1hdGgiLCJtaW4iLCJhcHBseSIsInJhbmdlQmFuZCIsInByZXByb2Nlc3NEYXRhIiwidG90YWwiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJyb3VuZCIsImVsZW1lbnQiLCJjb25zb2xlIiwibG9nIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiZmxvb3IiLCJyYW5kb20iLCJzaG9ja2luZ1VwZGF0ZSIsImlucHV0cyIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZW5fcHJvZHVjdGlvbiIsIkh5ZHJvIiwiR2VvdGhlcm1hbCIsIldpbmQiLCJDb2FsIiwiR2FzIiwiZ2VuX2VtaXNzaW9ucyIsImZsZWV0X2VtaXNzaW9ucyIsIlJvYWQiLCJlbGVjdHJpY19jYXJzIiwiZWxlY3RyaWNfcGN0IiwiZXZfcG93ZXJfcmVxdHMiLCJ0b3RhbF9nZW4iLCJrZXkiLCJpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyIsInJlc3VsdCIsIm1vY2tHV2giLCJtb2NrR2VuZXJhdGlvbkVtaXNzaW9ucyIsIm1vY2tGbGVldEVtaXNzaW9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImlucHV0X2V4YW1wbGUiXSwibWFwcGluZ3MiOiJBQWlCQSxRQUFBQSxZQUFBQyxHQUNBQyxTQUFBQyxlQUFBLGFBQUFGLE1BQUFBLEVBQ0FDLFNBQUFDLGVBQUEsWUFBQUYsTUFBQUEsRUFDQUcsWUFBQSxZQUFBQyxpQkNwQkEsUUFBQUMsYUFBQUMsRUFBQUMsR0FlQSxJQUFBLEdBZEFDLEdBQUEsR0FDQUMsRUFBQSxJQUVBQyxFQUFBQyxHQUFBQyxPQUFBTixHQUFBTyxPQUFBLFdBQ0FDLEtBQUEsUUFBQSxTQUNBQSxLQUFBLFFBQUFOLEdBQ0FNLEtBQUEsU0FBQUwsR0FDQUksT0FBQSxTQUNBQyxLQUFBLFlBQUEsb0JBRUFDLEdBQUFSLEdBR0FTLEtBQ0FDLEVBQUEsRUFBQUEsRUFBQUYsRUFBQSxHQUFBRyxPQUFBLEVBQUFELElBQ0FELEVBQUFHLEtBQUEsT0FBQUMsWUFBQSxJQUFBQSxZQUFBLElBQUFBLFlBQUEsSUFHQUMsR0FBQVYsR0FBQVcsTUFBQUMsVUFBQUMsaUJBQUEsRUFBQWhCLElBQ0FpQixFQUFBZCxHQUFBVyxNQUFBSSxTQUFBQyxPQUFBLEVBQUFsQixJQUNBbUIsRUFBQWpCLEdBQUFXLE1BQUFDLFVBQUFJLE1BQUFYLEVBRUEsSUFBQWEsSUFBQSxLQUFBLEtBQUEsS0FBQSxLQUFBLE1BQUFDLElBQUEsU0FBQUMsRUFBQWQsR0FDQSxNQUFBRixHQUFBZSxJQUFBLFNBQUFFLEVBQUFDLEdBQ0EsT0FBQVosRUFBQVksRUFBQVIsRUFBQU8sRUFBQWYsRUFBQSxRQUlBaUIsRUFBQXZCLEdBQUF3QixPQUFBQyxRQUFBUCxFQUVBUixHQUFBZ0IsT0FBQUgsRUFBQSxHQUFBSixJQUFBLFNBQUFFLEdBQUEsTUFBQUEsR0FBQVgsS0FDQUksRUFBQVksUUFBQSxFQUFBMUIsR0FBQTJCLElBQUFKLEVBQUFBLEVBQUFoQixPQUFBLEdBQUEsU0FBQWMsR0FBQSxNQUFB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RUN6RkEsUUFBQUMsV0FDQSxPQUNBZixNQUFBLE1BQ0FDLFdBQUEsS0FDQUMsS0FBQSxLQUNBQyxLQUFBLEtBQ0FDLElBQUEsTUFJQSxRQUFBcEUsaUJBQ0EsT0FDQWdFLE1BQUEsR0FDQUMsV0FBQSxJQUNBQyxLQUFBLEtBQ0FDLEtBQUEsSUFDQUMsSUFBQSxLQUlBLFFBQUFZLDJCQUNBLE9BQ0FoQixNQUFBLEVBQ0FDLFdBQUEsT0FDQUMsS0FBQSxFQUNBQyxLQUFBLE9BQ0FDLElBQUEsU0FJQSxRQUFBYSxzQkFDQSxPQUNBVixLQUFBLE9IaENBMUUsU0FBQXFGLGlCQUFBLG1CQUFBLFNBQUFDLEdBQ0FsRixZQUFBLGNBQ0EsRUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBRUFGLFlBQUEsWUFBQWdGLFdBSUE5RSxZQUFBLGVBQ0EsRUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBRUFBLFlBQUEscUJBQ0EsRUFBQSxFQUFBLEdBQUEsR0FBQSxHQUFBLE1FVkEsSUFBQW1GLGdCQUVBWixjQUFBIiwiZmlsZSI6ImpzL2FsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gIGNvbHVtbkdyYXBoKFwiI2NvMi1jaGFydFwiLCBbXG4gICAgMSwgMTAsIDIwLCAyMCwgMjUsIDUwXG4gIF0pO1xuICB1cGRhdGVHcmFwaCgnZ3doLWNoYXJ0JywgbW9ja0dXaCgpKTtcbiAgLy9jb2x1bW5HcmFwaChcIiNnd2gtY2hhcnRcIiwgW1xuICAgIC8vMSwgMTAsIDE1LCAyMCwgMzAsIDUwXG4gIC8vXSk7XG4gIGNvbHVtbkdyYXBoKFwiI2Nvc3QtY2hhcnRcIiwgW1xuICAgIDEsIDEwLCAxNSwgMTUsIDM1LCA1MFxuICBdKTtcbiAgY29sdW1uR3JhcGgoXCIjaW52ZXN0bWVudC1jaGFydFwiLCBbXG4gICAgMSwgNSwgMTAsIDE1LCA0NSwgNTBcbiAgXSk7XG59KTtcblxuXG5mdW5jdGlvbiB1cGRhdGVDYXJzICh2YWx1ZSkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyTnVtYmVyJykudmFsdWUgPSB2YWx1ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhclJhbmdlJykudmFsdWUgPSB2YWx1ZTtcbiAgdXBkYXRlR3JhcGgoJ2d3aC1jaGFydCcsIG1vY2tBZGp1c3RHV2goKSk7IFxufVxuXG4iLCJmdW5jdGlvbiBjb2x1bW5HcmFwaCAoYmluZFRvLCB2YWx1ZXMpIHtcbiAgdmFyIHcgPSA4MDtcbiAgdmFyIGggPSAzMDA7XG5cbiAgdmFyIHN2ZyA9IGQzLnNlbGVjdChiaW5kVG8pLmFwcGVuZChcInN2ZzpzdmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiY2hhcnRcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIHcpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgaCApXG4gICAgLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwzMDApXCIpO1xuXG4gIHZhciBtYXRyaXggPSBbdmFsdWVzXTtcblxuICAvLyBSYW5kb20gZm9yIG5vd1xuICB2YXIgY29sb3JzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0cml4WzBdLmxlbmd0aCAtMTsgaSsrKSB7XG4gICAgY29sb3JzLnB1c2goJ3JnYignICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJyknKTtcbiAgfVxuXG4gIHggPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2VSb3VuZEJhbmRzKFswLCB3XSk7XG4gIHkgPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbMCwgaF0pO1xuICB6ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlKGNvbG9ycyk7XG5cbiAgdmFyIHJlbWFwcGVkID1bXCJjMVwiLFwiYzJcIixcImMzXCIsXCJjNFwiLFwiYzVcIl0ubWFwKGZ1bmN0aW9uKGRhdCxpKXtcbiAgICByZXR1cm4gbWF0cml4Lm1hcChmdW5jdGlvbihkLGlpKXtcbiAgICAgIHJldHVybiB7eDogaWksIHk6IGRbaSsxXSB9O1xuICAgIH0pXG4gIH0pO1xuXG4gIHZhciBzdGFja2VkID0gZDMubGF5b3V0LnN0YWNrKCkocmVtYXBwZWQpO1xuXG4gIHguZG9tYWluKHN0YWNrZWRbMF0ubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSkpO1xuICB5LmRvbWFpbihbMCwgZDMubWF4KHN0YWNrZWRbc3RhY2tlZC5sZW5ndGggLSAxXSwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55MCArIGQueTsgfSldKTtcblxuICB2YXIgdmFsZ3JvdXAgPSBzdmcuc2VsZWN0QWxsKFwiZy52YWxncm91cFwiKVxuICAgIC5kYXRhKHN0YWNrZWQpXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwidmFsZ3JvdXBcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIHooaSk7IH0pXG4gICAgLnN0eWxlKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGQzLnJnYih6KGkpKS5kYXJrZXIoKTsgfSk7XG5cbiAgdmFyIHJlY3QgPSB2YWxncm91cC5zZWxlY3RBbGwoXCJyZWN0XCIpXG4gICAgLmRhdGEoZnVuY3Rpb24oZCl7cmV0dXJuIGQ7fSlcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6cmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQueCk7IH0pXG4gICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIC15KGQueTApIC0geShkLnkpOyB9KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC55KTsgfSlcbiAgICAuYXR0cihcIndpZHRoXCIsIE1hdGgubWluLmFwcGx5KG51bGwsIFt4LnJhbmdlQmFuZCgpLTIsIDEwMF0pKTtcbn1cblxuZnVuY3Rpb24gcHJlcHJvY2Vzc0RhdGEgKGRhdGEpIHtcbiAgLy8gSG9ycmlibGUga2x1ZGdlIHRvIGdldCB0aGluZ3Mgd29ya2luZyBmb3IgcHJvb2Ygb2YgY29uY2VwdC4uLlxuICB2YXIgdmFsdWVzID0gWzFdO1xuICB2YXIgdG90YWwgPSAwO1xuICBmb3IgKHZhciBrIGluIGRhdGEpIHtcbiAgICBpZihkYXRhLmhhc093blByb3BlcnR5KGspKXtcbiAgICAgIHRvdGFsICs9IGRhdGFba107XG4gICAgICB2YWx1ZXMucHVzaChkYXRhW2tdKTtcbiAgICB9XG4gIH1cblxuICAvLyBOZWVkIHBlcmNlbnQgdmFsdWVzIGZvciBjaGFydFxuICBmb3IgKHZhciBpID0gMTsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhbHVlc1tpXSA9IE1hdGgucm91bmQoKHZhbHVlc1tpXSAvIHRvdGFsKSAqIDEwMCk7XG4gIH1cblxuICByZXR1cm4gdmFsdWVzO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVHcmFwaCAoYmluZFRvLCBkYXRhKSB7XG4gIHZhciB3ID0gODA7XG4gIHZhciBoID0gMzAwO1xuXG4gIC8vIEhhY2t5OiByZW1vdmUgY2hhcnQgaWYgaXQgZXhpc3RzXG4gIC8vIFRPRE86IHRyYW5zaXRpb24hXG4gIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYmluZFRvKTtcbiAgY29uc29sZS5sb2coZWxlbWVudCk7XG4gIHdoaWxlIChlbGVtZW50LmZpcnN0Q2hpbGQpIHtcbiAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gIH1cblxuICB2YXIgc3ZnID0gZDMuc2VsZWN0KCcjJyArIGJpbmRUbykuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgdylcbiAgICAuYXR0cihcImhlaWdodFwiLCBoIClcbiAgICAuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLFwiICsgaCArIFwiKVwiKTtcblxuICB2YXIgbWF0cml4ID0gW3ByZXByb2Nlc3NEYXRhKGRhdGEpXTtcblxuICAvLyBSYW5kb20gZm9yIG5vd1xuICB2YXIgY29sb3JzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0cml4WzBdLmxlbmd0aCAtMTsgaSsrKSB7XG4gICAgY29sb3JzLnB1c2goJ3JnYignICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJyknKTtcbiAgfVxuXG4gIHggPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2VSb3VuZEJhbmRzKFswLCB3XSk7XG4gIHkgPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbMCwgaF0pO1xuICB6ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlKGNvbG9ycyk7XG5cbiAgdmFyIHJlbWFwcGVkID0gW1wiYzFcIixcImMyXCIsXCJjM1wiLFwiYzRcIixcImM1XCJdLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gICAgcmV0dXJuIG1hdHJpeC5tYXAoZnVuY3Rpb24oZCxpaSl7XG4gICAgICByZXR1cm4ge3g6IGlpLCB5OiBkW2krMV0gfTtcbiAgICB9KVxuICB9KTtcblxuICB2YXIgc3RhY2tlZCA9IGQzLmxheW91dC5zdGFjaygpKHJlbWFwcGVkKVxuXG4gIHguZG9tYWluKHN0YWNrZWRbMF0ubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSkpO1xuICB5LmRvbWFpbihbMCwgZDMubWF4KHN0YWNrZWRbc3RhY2tlZC5sZW5ndGggLSAxXSwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55MCArIGQueTsgfSldKTtcblxuICB2YXIgdmFsZ3JvdXAgPSBzdmcuc2VsZWN0QWxsKFwiZy52YWxncm91cFwiKVxuICAgIC5kYXRhKHN0YWNrZWQpXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwidmFsZ3JvdXBcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIHooaSk7IH0pXG4gICAgLnN0eWxlKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGQzLnJnYih6KGkpKS5kYXJrZXIoKTsgfSk7XG5cbiAgdmFyIHJlY3QgPSB2YWxncm91cC5zZWxlY3RBbGwoXCJyZWN0XCIpXG4gICAgLmRhdGEoZnVuY3Rpb24oZCl7cmV0dXJuIGQ7fSlcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6cmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQueCk7IH0pXG4gICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIC15KGQueTApIC0geShkLnkpOyB9KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC55KTsgfSlcbiAgICAuYXR0cihcIndpZHRoXCIsIE1hdGgubWluLmFwcGx5KG51bGwsIFt4LnJhbmdlQmFuZCgpLTIsIDEwMF0pKTtcbn1cblxuZnVuY3Rpb24gcmFuZG9tUkdCICgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1Nik7XG59XG4iLCIvLyByZWZlcmVuY2U6IGh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kLzFyalpaZzE5Z0g0U1QzWEZmUGFVbXZnQzkwQUNLZ1J3OHgtTWdvb3prTGZJL2VkaXQjZ2lkPTBcblxudmFyIGlucHV0X2V4YW1wbGUgPSB7XG5cdC8vICUgb2YgZWxlY3RyaWMgY2Fyc1xuXHQnZWxlY3RyaWNfY2Fycyc6IDJcbn1cblxuXG5mdW5jdGlvbiBzaG9ja2luZ1VwZGF0ZShpbnB1dHMpIHtcblxuXHRjb25zb2xlLmxvZyhcInNob2NraW5nVXBkYXRlIC0gSW5wdXRzOiBcIiArIEpTT04uc3RyaW5naWZ5KGlucHV0cykpO1xuXG5cblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0Ly8gQmFzZWxpbmUgZGF0YSBcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuXHQvLyBhbm51YWwgZ2VuZXJhdGlvbiBpbiBHaWdhd2F0dCBIb3Vyc1xuXHR2YXIgZ2VuX3Byb2R1Y3Rpb24gPSB7XG5cdFx0J0h5ZHJvJzogMjQwOTUsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDg3LFxuXHRcdCdXaW5kJzogMjE4Nyxcblx0XHQnQ29hbCc6IDE4MzIsXG5cdFx0J0dhcyc6IDY2MjZcblx0fVxuXG5cdC8vIGFubnVhbCBnZW5lcmF0aW9uIGVtaXNzaW9ucyBpbiBLaWxvdG9ucyBvZiBDTzIgRXF1aXZhbGVudFxuXHR2YXIgZ2VuX2VtaXNzaW9ucyA9IHtcblx0XHQnSHlkcm8nOiAwLFxuXHRcdCdHZW90aGVybWFsJzogODQ3LjMyLFxuXHRcdCdXaW5kJzogMCxcblx0XHQnQ29hbCc6IDEyMjIuMixcblx0XHQnR2FzJzogMzQwNS41MVxuXHR9XG5cblx0Ly8gYW5udWFsIHZlaGljbGUgZmxlZXQgZW1pc3Npb25zIGluIEtpbG90b25zIG9mIENPMiBFcXVpdmFsZW50XG5cdHZhciBmbGVldF9lbWlzc2lvbnMgPSB7XG5cdFx0J1JvYWQnOiAxMjY4OFxuXHR9XG4gXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdC8vIEJ1c2luZXNzIGxvZ2ljXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdFxuXHQvLyBbMV0gRWxlY3RyaWMgY2Fyc1xuXHQvLyBBU1NVTVBUSU9OOiB0aGVyZSBhcmUgZXNzZW50aWFsbHkgMCBlbGVjdHJpYyBjYXJzIGluIHRoZSBjdXJyZW50IGZsZWV0XG5cdHZhciBlbGVjdHJpY19jYXJzID0gaW5wdXRzWydlbGVjdHJpY19jYXJzJ107XG5cdHZhciBlbGVjdHJpY19wY3QgPSBlbGVjdHJpY19jYXJzLzEwMDtcblxuXHRmbGVldF9lbWlzc2lvbnNbJ1JvYWQnXSA9IGZsZWV0X2VtaXNzaW9uc1snUm9hZCddICogKDEtZWxlY3RyaWNfcGN0KTtcblxuXHQvLyBBU1NVTVBUSU9OOiBhbnkgdXB0aWNrIGluIHBvd2VyIGdlbmVyYXRpb24gcmVxdWlyZWQgdG8gbWVldFxuXHQvLyBlbGVjdHJpYyBjYXIgZGVtYW5kLCB3aWxsIGJlIG1ldCBwcm9wb3J0aW9uYWxseSBieSBhbGwgZ2VuZXJhdGlvbiBzb3VyY2VzXG5cdC8vIEFTU1VNUFRJT046IHR5cGljYWwgRVYgd2lsbCB1c2UgMC4yIGtXaCBmb3IgMSBrbSB0cmF2ZWxsZWRcblx0Ly8gYXZlcmFnZSB0cmF2ZWwgaXMgMTIwMzIga20gcGVyIHllYXJcblx0Ly8gZmxlZXQgc2l6ZSBpcyAzMzQxMDEzXG5cdGV2X3Bvd2VyX3JlcXRzID0gMTIwMzIgKiAwLjIgKiAzMzQxMDEzICogZWxlY3RyaWNfcGN0O1xuXHRcblx0Ly8gY29udmVydCBrd2ggdG8gZ3doXG5cdGV2X3Bvd2VyX3JlcXRzID0gZXZfcG93ZXJfcmVxdHMgLyAxMDAwMDAwO1xuXG5cdC8vIHdvcmsgb3V0IHRvdGFsIGN1cnJlbnQgZ2VuZXJhdGlvblxuXHR2YXIgdG90YWxfZ2VuID0gMDtcblx0Zm9yICh2YXIga2V5IGluIGdlbl9wcm9kdWN0aW9uKSB7XG5cdFx0dG90YWxfZ2VuICs9IGdlbl9wcm9kdWN0aW9uW2tleV07XG5cdH1cblxuXHR2YXIgaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMgPSAxICsgKGV2X3Bvd2VyX3JlcXRzIC8gdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ3RvdGFsOiAnICsgdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ2luY3JlYXNlIGZyb20gZWxlY3RyaWMgdmVoaWNsZXM6ICcgKyBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyk7XG5cblx0Y29uc29sZS5sb2coJ2V2X3Bvd2VyX3JlcXRzICcgKyBldl9wb3dlcl9yZXF0cyk7XG5cblx0Ly8gbm93IGFwcGx5IHRoYXQgZmFjdG9yIHRvIHRoZSBlbWlzc2lvbnMgLSBlbWlzc2lvbnMgZnJvbSBFViBwb3dlciByZXF1aXJlbWVudHNcblx0Zm9yICh2YXIga2V5IGluIGdlbl9lbWlzc2lvbnMpIHtcblx0XHRnZW5fZW1pc3Npb25zW2tleV0gPSBnZW5fZW1pc3Npb25zW2tleV0gKiBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cztcblx0fVxuXG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdC8vIE91dHB1dFxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHR2YXIgcmVzdWx0ID0ge1xuXHRcdCdnZW5fcHJvZHVjdGlvbic6IGdlbl9wcm9kdWN0aW9uLFxuXHRcdCdnZW5fZW1pc3Npb25zJzogZ2VuX2VtaXNzaW9ucyxcblx0XHQnZmxlZXRfZW1pc3Npb25zJzogZmxlZXRfZW1pc3Npb25zXG5cdH1cblxuXHRjb25zb2xlLmxvZyhcIlJlc3VsdDogXCIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcblxuXHRyZXR1cm4gcmVzdWx0O1xufVxuIiwiZnVuY3Rpb24gbW9ja0dXaCAoKSB7XG4gIHJldHVybiB7XG5cdFx0J0h5ZHJvJzogMjQwOTUsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDg3LFxuXHRcdCdXaW5kJzogMjE4Nyxcblx0XHQnQ29hbCc6IDE4MzIsXG5cdFx0J0dhcyc6IDY2MjZcblx0fTtcbn1cblxuZnVuY3Rpb24gbW9ja0FkanVzdEdXaCAoKSB7XG4gIHJldHVybiB7XG5cdFx0J0h5ZHJvJzogMjQsXG5cdFx0J0dlb3RoZXJtYWwnOiA2NDgsXG5cdFx0J1dpbmQnOiAxMjE4LFxuXHRcdCdDb2FsJzogODMyLFxuXHRcdCdHYXMnOiAzNjJcblx0fTtcbn1cblxuZnVuY3Rpb24gbW9ja0dlbmVyYXRpb25FbWlzc2lvbnMgKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDAsXG5cdFx0J0dlb3RoZXJtYWwnOiA4NDcuMzIsXG5cdFx0J1dpbmQnOiAwLFxuXHRcdCdDb2FsJzogMTIyMi4yLFxuXHRcdCdHYXMnOiAzNDA1LjUxXG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tGbGVldEVtaXNzaW9ucyAoKSB7XG4gIHJldHVybiB7XG5cdFx0J1JvYWQnOiAxMjY4OFxuXHR9O1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9