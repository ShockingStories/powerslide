function randomRGB(){return Math.floor(256*Math.random())}document.addEventListener("DOMContentLoaded",function(t){{var e=[100,90,80,70,60,50,40,30,20,10],n=d3.select("body").append("svg").attr("width",500).attr("height",500),r=n.selectAll("circle").data(e).enter().append("circle");r.attr("cx",150).attr("cy",150).attr("r",function(t){return t}).style("fill",function(t){return"rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")"})}d3.select("#slider").call(d3.slider().value([100,90,80,70,60,50,40,30,20,10]).orientation("vertical"))}),function(t,e){"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?(process.browser&&require("./d3.slider.css"),module.exports=e(require("d3"))):t.d3.slider=e(t.d3)}(this,function(t){return function(){"use strict";function e(e){e.each(function(){function e(e){"boolean"==typeof p&&(p=t.svg.axis().ticks(Math.round(u/100)).tickFormat(w).orient("horizontal"===m?"bottom":"right")),s=l.ticks?l.copy().range([0,u]):l.copy().rangePoints([0,u],.5),p.scale(s);var n=e.append("svg").classed("d3-slider-axis d3-slider-axis-"+p.orient(),!0).on("click",F),r=n.append("g");"horizontal"===m?(n.style("margin-left",-y+"px"),n.attr({width:u+2*y,height:y}),"top"===p.orient()?(n.style("top",-y+"px"),r.attr("transform","translate("+y+","+y+")")):r.attr("transform","translate("+y+",0)")):(n.style("top",-y+"px"),n.attr({width:y,height:u+2*y}),"left"===p.orient()?(n.style("left",-y+"px"),r.attr("transform","translate("+y+","+y+")")):r.attr("transform","translate(0,"+y+")")),r.call(p)}function g(){if("array"!=i(o)){var e=Math.max(0,Math.min(u,t.event.offsetX||t.event.layerX));n(l.invert?r(l.invert(e/u)):a(e/u))}}function v(){if("array"!=i(o)){var e=u-Math.max(0,Math.min(u,t.event.offsetY||t.event.layerY));n(l.invert?r(l.invert(e/u)):a(e/u))}}function b(){"handle-one"===t.event.sourceEvent.target.id?x=1:"handle-two"==t.event.sourceEvent.target.id&&(x=2);var e=Math.max(0,Math.min(u,t.event.x));n(l.invert?r(l.invert(e/u)):a(e/u))}function z(){"handle-one"===t.event.sourceEvent.target.id?x=1:"handle-two"==t.event.sourceEvent.target.id&&(x=2);var e=u-Math.max(0,Math.min(u,t.event.y));n(l.invert?r(l.invert(e/u)):a(e/u))}function F(){t.event.stopPropagation()}l||(l=t.scale.linear().domain([f,h])),o=o||l.domain()[0];var B=t.select(this).classed("d3-slider d3-slider-"+m,!0),G=t.behavior.drag();if(G.on("dragend",function(){k.slideend(t.event,o)}),"array"==i(o)&&2==o.length?(d=B.append("a").classed("d3-slider-handle",!0).attr("xlink:href","#").attr("id","handle-one").on("click",F).call(G),E=B.append("a").classed("d3-slider-handle",!0).attr("id","handle-two").attr("xlink:href","#").on("click",F).call(G)):d=B.append("a").classed("d3-slider-handle",!0).attr("xlink:href","#").attr("id","handle-one").on("click",F).call(G),"horizontal"===m){if(B.on("click",g),"array"==i(o)&&2==o.length){c=t.select(this).append("div").classed("d3-slider-range",!0),d.style("left",M(l(o[0]))),c.style("left",M(l(o[0]))),G.on("drag",b);var R=100-parseFloat(M(l(o[1])));E.style("left",M(l(o[1]))),c.style("right",R+"%"),G.on("drag",b)}else d.style("left",M(l(o))),G.on("drag",b);u=parseInt(B.style("width"),10)}else{if(B.on("click",v),G.on("drag",z),"array"==i(o)&&2==o.length){c=t.select(this).append("div").classed("d3-slider-range-vertical",!0),d.style("bottom",M(l(o[0]))),c.style("bottom",M(l(o[0]))),G.on("drag",z);var L=100-parseFloat(M(l(o[1])));E.style("bottom",M(l(o[1]))),c.style("top",L+"%"),G.on("drag",z)}else d.style("bottom",M(l(o))),G.on("drag",z);u=parseInt(B.style("height"),10)}p&&e(B)})}function n(e){var n="array"==i(o)&&2==o.length?o[x-1]:o,a=M(l(r(n))),s=M(l(r(e))),u="horizontal"===m?"left":"bottom";if(a!==s){if("array"==i(o)&&2==o.length?(o[x-1]=e,t.event&&k.slide(t.event,o)):t.event&&k.slide(t.event.sourceEvent||t.event,o=e),o[0]>=o[1])return;if(1===x)"array"==i(o)&&2==o.length&&("left"===u?c.style("left",s):c.style("bottom",s)),v?d.transition().styleTween(u,function(){return t.interpolate(a,s)}).duration("number"==typeof v?v:250):d.style(u,s);else{var f=100-parseFloat(s),h=100-parseFloat(s);"left"===u?c.style("right",f+"%"):c.style("top",h+"%"),v?E.transition().styleTween(u,function(){return t.interpolate(a,s)}).duration("number"==typeof v?v:250):E.style(u,s)}}}function r(t){if(t===l.domain()[0]||t===l.domain()[1])return t;var e=t;if(b)e=a(l(t));else{var n=(t-l.domain()[0])%g;e=t-n,2*Math.abs(n)>=g&&(e+=n>0?g:-g)}return e}function a(t){var e=l.ticks?l.ticks():l.domain(),n=e.map(function(e){return t-l(e)}),r=-1,a=0,i=l.ticks?l.range()[1]:l.rangeExtent()[1];do r++,Math.abs(n[r])<i&&(i=Math.abs(n[r]),a=r);while(n[r]>0&&r<n.length-1);return e[a]}function i(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}var o,l,s,d,c,u,f=0,h=100,g=.01,v=!0,m="horizontal",p=!1,y=50,x=1,b=!1,k=t.dispatch("slide","slideend"),M=t.format(".2%"),w=t.format(".0"),E=null;return e.min=function(t){return arguments.length?(f=t,e):f},e.max=function(t){return arguments.length?(h=t,e):h},e.step=function(t){return arguments.length?(g=t,e):g},e.animate=function(t){return arguments.length?(v=t,e):v},e.orientation=function(t){return arguments.length?(m=t,e):m},e.axis=function(t){return arguments.length?(p=t,e):p},e.margin=function(t){return arguments.length?(y=t,e):y},e.value=function(t){return arguments.length?(o&&n(r(t)),o=t,e):o},e.snap=function(t){return arguments.length?(b=t,e):b},e.scale=function(t){return arguments.length?(l=t,e):l},t.rebind(e,k,"on"),e}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImxpYi9kM3NsaWRlci5qcyJdLCJuYW1lcyI6WyJyYW5kb21SR0IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImNpcmNsZVJhZGlpIiwic3ZnQ29udGFpbmVyIiwiZDMiLCJzZWxlY3QiLCJhcHBlbmQiLCJhdHRyIiwiY2lyY2xlcyIsInNlbGVjdEFsbCIsImRhdGEiLCJlbnRlciIsImQiLCJzdHlsZSIsImNhbGwiLCJzbGlkZXIiLCJ2YWx1ZSIsIm9yaWVudGF0aW9uIiwicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJleHBvcnRzIiwicHJvY2VzcyIsImJyb3dzZXIiLCJyZXF1aXJlIiwibW9kdWxlIiwidGhpcyIsInNlbGVjdGlvbiIsImVhY2giLCJjcmVhdGVBeGlzIiwiZG9tIiwiYXhpcyIsInN2ZyIsInRpY2tzIiwicm91bmQiLCJzbGlkZXJMZW5ndGgiLCJ0aWNrRm9ybWF0Iiwib3JpZW50IiwiYXhpc1NjYWxlIiwic2NhbGUiLCJjb3B5IiwicmFuZ2UiLCJyYW5nZVBvaW50cyIsImNsYXNzZWQiLCJvbiIsInN0b3BQcm9wYWdhdGlvbiIsImciLCJtYXJnaW4iLCJ3aWR0aCIsImhlaWdodCIsIm9uQ2xpY2tIb3Jpem9udGFsIiwidG9UeXBlIiwicG9zIiwibWF4IiwibWluIiwib2Zmc2V0WCIsImxheWVyWCIsIm1vdmVIYW5kbGUiLCJpbnZlcnQiLCJzdGVwVmFsdWUiLCJuZWFyZXN0VGljayIsIm9uQ2xpY2tWZXJ0aWNhbCIsIm9mZnNldFkiLCJsYXllclkiLCJvbkRyYWdIb3Jpem9udGFsIiwic291cmNlRXZlbnQiLCJ0YXJnZXQiLCJpZCIsImFjdGl2ZSIsIngiLCJvbkRyYWdWZXJ0aWNhbCIsInkiLCJsaW5lYXIiLCJkb21haW4iLCJkaXYiLCJkcmFnIiwiYmVoYXZpb3IiLCJkaXNwYXRjaCIsInNsaWRlZW5kIiwibGVuZ3RoIiwiaGFuZGxlMSIsImhhbmRsZTIiLCJkaXZSYW5nZSIsImZvcm1hdFBlcmNlbnQiLCJwYXJzZUZsb2F0IiwicGFyc2VJbnQiLCJ0b3AiLCJuZXdWYWx1ZSIsImN1cnJlbnRWYWx1ZSIsIm9sZFBvcyIsIm5ld1BvcyIsInBvc2l0aW9uIiwic2xpZGUiLCJhbmltYXRlIiwidHJhbnNpdGlvbiIsInN0eWxlVHdlZW4iLCJpbnRlcnBvbGF0ZSIsImR1cmF0aW9uIiwidmFsIiwiYWxpZ25WYWx1ZSIsInNuYXAiLCJ2YWxNb2RTdGVwIiwic3RlcCIsImFicyIsImRpc3QiLCJtYXAiLCJpIiwiaW5kZXgiLCJyIiwicmFuZ2VFeHRlbnQiLCJ2IiwidG9TdHJpbmciLCJtYXRjaCIsInRvTG93ZXJDYXNlIiwiZm9ybWF0IiwiXyIsImFyZ3VtZW50cyIsInJlYmluZCJdLCJtYXBwaW5ncyI6IkFBeUJBLFFBQUFBLGFBQ0EsTUFBQUMsTUFBQUMsTUFBQSxJQUFBRCxLQUFBRSxVQTFCQUMsU0FBQUMsaUJBQUEsbUJBQUEsU0FBQUMsR0FDQSxDQUFBLEdBQUFDLElBQUEsSUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsSUFDQUMsRUFBQUMsR0FBQUMsT0FBQSxRQUFBQyxPQUFBLE9BQ0FDLEtBQUEsUUFBQSxLQUNBQSxLQUFBLFNBQUEsS0FFQUMsRUFBQUwsRUFBQU0sVUFBQSxVQUNBQyxLQUFBUixHQUNBUyxRQUNBTCxPQUFBLFNBQ0FFLEdBQ0FELEtBQUEsS0FBQSxLQUNBQSxLQUFBLEtBQUEsS0FDQUEsS0FBQSxJQUFBLFNBQUFLLEdBQUEsTUFBQUEsS0FDQUMsTUFBQSxPQUFBLFNBQUFELEdBQ0EsTUFBQSxPQUFBakIsWUFBQSxJQUFBQSxZQUFBLElBQUFBLFlBQUEsTUFHQVMsR0FBQUMsT0FBQSxXQUFBUyxLQUNBVixHQUFBVyxTQUNBQyxPQUFBLElBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBQ0FDLFlBQUEsZUNmQSxTQUFBQyxFQUFBQyxHQUNBLGtCQUFBQyxT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Q0E5RSxFQUFBakMsRUFBQStHLE9BQUEsTUFFQWpDLEVBQUEsSUF5WEEsT0FqRUFuRSxHQUFBd0MsSUFBQSxTQUFBNkQsR0FDQSxNQUFBQyxXQUFBckMsUUFDQXpCLEVBQUE2RCxFQUNBckcsR0FGQXdDLEdBS0F4QyxFQUFBdUMsSUFBQSxTQUFBOEQsR0FDQSxNQUFBQyxXQUFBckMsUUFDQTFCLEVBQUE4RCxFQUNBckcsR0FGQXVDLEdBS0F2QyxFQUFBd0YsS0FBQSxTQUFBYSxHQUNBLE1BQUFDLFdBQUFyQyxRQUNBdUIsRUFBQWEsRUFDQXJHLEdBRkF3RixHQUtBeEYsRUFBQStFLFFBQUEsU0FBQXNCLEdBQ0EsTUFBQUMsV0FBQXJDLFFBQ0FjLEVBQUFzQixFQUNBckcsR0FGQStFLEdBS0EvRSxFQUFBRSxZQUFBLFNBQUFtRyxHQUNBLE1BQUFDLFdBQUFyQyxRQUNBL0QsRUFBQW1HLEVBQ0FyRyxHQUZBRSxHQUtBRixFQUFBaUIsS0FBQSxTQUFBb0YsR0FDQSxNQUFBQyxXQUFBckMsUUFDQWhELEVBQUFvRixFQUNBckcsR0FGQWlCLEdBS0FqQixFQUFBaUMsT0FBQSxTQUFBb0UsR0FDQSxNQUFBQyxXQUFBckMsUUFDQWhDLEVBQUFvRSxFQUNBckcsR0FGQWlDLEdBS0FqQyxFQUFBQyxNQUFBLFNBQUFvRyxHQUNBLE1BQUFDLFdBQUFyQyxRQUNBaEUsR0FDQTBDLEVBQUFFLEVBQUF3RCxJQUVBcEcsRUFBQW9HLEVBQ0FyRyxHQUxBQyxHQVFBRCxFQUFBc0YsS0FBQSxTQUFBZSxHQUNBLE1BQUFDLFdBQUFyQyxRQUNBcUIsRUFBQWUsRUFDQXJHLEdBRkFzRixHQUtBdEYsRUFBQXlCLE1BQUEsU0FBQTRFLEdBQ0EsTUFBQUMsV0FBQXJDLFFBQ0F4QyxFQUFBNEUsRUFDQXJHLEdBRkF5QixHQUtBcEMsRUFBQWtILE9BQUF2RyxFQUFBK0QsRUFBQSxNQUVBL0QiLCJmaWxlIjoianMvYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgdmFyIGNpcmNsZVJhZGlpID0gWzEwMCwgOTAsIDgwLCA3MCwgNjAsIDUwLCA0MCwgMzAsIDIwLCAxMF07XG4gIHZhciBzdmdDb250YWluZXIgPSBkMy5zZWxlY3QoXCJib2R5XCIpLmFwcGVuZChcInN2Z1wiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgNTAwKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIDUwMCk7XG5cbiAgdmFyIGNpcmNsZXMgPSBzdmdDb250YWluZXIuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXG4gICAgLmRhdGEoY2lyY2xlUmFkaWkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKFwiY2lyY2xlXCIpO1xuICB2YXIgY2lyY2xlQXR0cmlidXRlcyA9IGNpcmNsZXNcbiAgICAuYXR0cihcImN4XCIsIDE1MClcbiAgICAuYXR0cihcImN5XCIsIDE1MClcbiAgICAuYXR0cihcInJcIiwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQ7IH0pXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIFwicmdiKFwiICsgcmFuZG9tUkdCKCkgKyBcIixcIiArIHJhbmRvbVJHQigpICsgXCIsXCIgKyByYW5kb21SR0IoKSArIFwiKVwiO1xuICAgIH0pO1xuXG4gIGQzLnNlbGVjdChcIiNzbGlkZXJcIikuY2FsbChcbiAgICBkMy5zbGlkZXIoKVxuICAgICAgLnZhbHVlKCBbIDEwMCwgOTAsIDgwLCA3MCwgNjAsIDUwLCA0MCwgMzAsIDIwLCAxMCBdKVxuICAgICAgLm9yaWVudGF0aW9uKCd2ZXJ0aWNhbCcpXG4gICk7XG59KTtcblxuZnVuY3Rpb24gcmFuZG9tUkdCICgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1Nik7XG59XG4iLCIvKlxuICAgIEQzLmpzIFNsaWRlclxuICAgIEluc3BpcmVkIGJ5IGpRdWVyeSBVSSBTbGlkZXJcbiAgICBDb3B5cmlnaHQgKGMpIDIwMTMsIEJqb3JuIFNhbmR2aWsgLSBodHRwOi8vYmxvZy50aGVtYXRpY21hcHBpbmcub3JnXG4gICAgQlNEIGxpY2Vuc2U6IGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2VcbiovXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoWydkMyddLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAocHJvY2Vzcy5icm93c2VyKSB7XG4gICAgICAvLyBCcm93c2VyaWZ5LiBJbXBvcnQgY3NzIHRvbyB1c2luZyBjc3NpZnkuXG4gICAgICByZXF1aXJlKCcuL2QzLnNsaWRlci5jc3MnKTtcbiAgICB9XG4gICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0XG4gICAgLy8gb25seSBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB0aGF0IHN1cHBvcnQgbW9kdWxlLmV4cG9ydHMsXG4gICAgLy8gbGlrZSBOb2RlLlxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCdkMycpKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgIHJvb3QuZDMuc2xpZGVyID0gZmFjdG9yeShyb290LmQzKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiAoZDMpIHtcbnJldHVybiBmdW5jdGlvbiBtb2R1bGUoKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIC8vIFB1YmxpYyB2YXJpYWJsZXMgd2lkdGggZGVmYXVsdCBzZXR0aW5nc1xuICB2YXIgbWluID0gMCxcbiAgICAgIG1heCA9IDEwMCxcbiAgICAgIHN0ZXAgPSAwLjAxLFxuICAgICAgYW5pbWF0ZSA9IHRydWUsXG4gICAgICBvcmllbnRhdGlvbiA9IFwiaG9yaXpvbnRhbFwiLFxuICAgICAgYXhpcyA9IGZhbHNlLFxuICAgICAgbWFyZ2luID0gNTAsXG4gICAgICB2YWx1ZSxcbiAgICAgIGFjdGl2ZSA9IDEsXG4gICAgICBzbmFwID0gZmFsc2UsXG4gICAgICBzY2FsZTtcblxuICAvLyBQcml2YXRlIHZhcmlhYmxlc1xuICB2YXIgYXhpc1NjYWxlLFxuICAgICAgZGlzcGF0Y2ggPSBkMy5kaXNwYXRjaChcInNsaWRlXCIsIFwic2xpZGVlbmRcIiksXG4gICAgICBmb3JtYXRQZXJjZW50ID0gZDMuZm9ybWF0KFwiLjIlXCIpLFxuICAgICAgdGlja0Zvcm1hdCA9IGQzLmZvcm1hdChcIi4wXCIpLFxuICAgICAgaGFuZGxlMSxcbiAgICAgIGhhbmRsZTIgPSBudWxsLFxuICAgICAgZGl2UmFuZ2UsXG4gICAgICBzbGlkZXJMZW5ndGg7XG5cbiAgZnVuY3Rpb24gc2xpZGVyKHNlbGVjdGlvbikge1xuICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBDcmVhdGUgc2NhbGUgaWYgbm90IGRlZmluZWQgYnkgdXNlclxuICAgICAgaWYgKCFzY2FsZSkge1xuICAgICAgICBzY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbbWluLCBtYXhdKTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RhcnQgdmFsdWVcbiAgICAgIHZhbHVlID0gdmFsdWUgfHwgc2NhbGUuZG9tYWluKClbMF07XG5cbiAgICAgIC8vIERJViBjb250YWluZXJcbiAgICAgIHZhciBkaXYgPSBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImQzLXNsaWRlciBkMy1zbGlkZXItXCIgKyBvcmllbnRhdGlvbiwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIHZhciBkcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpO1xuICAgICAgZHJhZy5vbignZHJhZ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGlzcGF0Y2guc2xpZGVlbmQoZDMuZXZlbnQsIHZhbHVlKTtcbiAgICAgIH0pXG5cbiAgICAgIC8vIFNsaWRlciBoYW5kbGVcbiAgICAgIC8vaWYgcmFuZ2Ugc2xpZGVyLCBjcmVhdGUgdHdvXG4gICAgICAvLyB2YXIgZGl2UmFuZ2U7XG5cbiAgICAgIGlmICh0b1R5cGUodmFsdWUpID09IFwiYXJyYXlcIiAmJiB2YWx1ZS5sZW5ndGggPT0gMikge1xuICAgICAgICBoYW5kbGUxID0gZGl2LmFwcGVuZChcImFcIilcbiAgICAgICAgICAuY2xhc3NlZChcImQzLXNsaWRlci1oYW5kbGVcIiwgdHJ1ZSlcbiAgICAgICAgICAuYXR0cihcInhsaW5rOmhyZWZcIiwgXCIjXCIpXG4gICAgICAgICAgLmF0dHIoJ2lkJywgXCJoYW5kbGUtb25lXCIpXG4gICAgICAgICAgLm9uKFwiY2xpY2tcIiwgc3RvcFByb3BhZ2F0aW9uKVxuICAgICAgICAgIC5jYWxsKGRyYWcpO1xuICAgICAgICBoYW5kbGUyID0gZGl2LmFwcGVuZChcImFcIilcbiAgICAgICAgICAuY2xhc3NlZChcImQzLXNsaWRlci1oYW5kbGVcIiwgdHJ1ZSlcbiAgICAgICAgICAuYXR0cignaWQnLCBcImhhbmRsZS10d29cIilcbiAgICAgICAgICAuYXR0cihcInhsaW5rOmhyZWZcIiwgXCIjXCIpXG4gICAgICAgICAgLm9uKFwiY2xpY2tcIiwgc3RvcFByb3BhZ2F0aW9uKVxuICAgICAgICAgIC5jYWxsKGRyYWcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGFuZGxlMSA9IGRpdi5hcHBlbmQoXCJhXCIpXG4gICAgICAgICAgLmNsYXNzZWQoXCJkMy1zbGlkZXItaGFuZGxlXCIsIHRydWUpXG4gICAgICAgICAgLmF0dHIoXCJ4bGluazpocmVmXCIsIFwiI1wiKVxuICAgICAgICAgIC5hdHRyKCdpZCcsIFwiaGFuZGxlLW9uZVwiKVxuICAgICAgICAgIC5vbihcImNsaWNrXCIsIHN0b3BQcm9wYWdhdGlvbilcbiAgICAgICAgICAuY2FsbChkcmFnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSG9yaXpvbnRhbCBzbGlkZXJcbiAgICAgIGlmIChvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcblxuICAgICAgICBkaXYub24oXCJjbGlja1wiLCBvbkNsaWNrSG9yaXpvbnRhbCk7XG4gICAgICAgIFxuICAgICAgICBpZiAodG9UeXBlKHZhbHVlKSA9PSBcImFycmF5XCIgJiYgdmFsdWUubGVuZ3RoID09IDIpIHtcbiAgICAgICAgICBkaXZSYW5nZSA9IGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoJ2RpdicpLmNsYXNzZWQoXCJkMy1zbGlkZXItcmFuZ2VcIiwgdHJ1ZSk7XG5cbiAgICAgICAgICBoYW5kbGUxLnN0eWxlKFwibGVmdFwiLCBmb3JtYXRQZXJjZW50KHNjYWxlKHZhbHVlWyAwIF0pKSk7XG4gICAgICAgICAgZGl2UmFuZ2Uuc3R5bGUoXCJsZWZ0XCIsIGZvcm1hdFBlcmNlbnQoc2NhbGUodmFsdWVbIDAgXSkpKTtcbiAgICAgICAgICBkcmFnLm9uKFwiZHJhZ1wiLCBvbkRyYWdIb3Jpem9udGFsKTtcblxuICAgICAgICAgIHZhciB3aWR0aCA9IDEwMCAtIHBhcnNlRmxvYXQoZm9ybWF0UGVyY2VudChzY2FsZSh2YWx1ZVsgMSBdKSkpO1xuICAgICAgICAgIGhhbmRsZTIuc3R5bGUoXCJsZWZ0XCIsIGZvcm1hdFBlcmNlbnQoc2NhbGUodmFsdWVbIDEgXSkpKTtcbiAgICAgICAgICBkaXZSYW5nZS5zdHlsZShcInJpZ2h0XCIsIHdpZHRoK1wiJVwiKTtcbiAgICAgICAgICBkcmFnLm9uKFwiZHJhZ1wiLCBvbkRyYWdIb3Jpem9udGFsKTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhhbmRsZTEuc3R5bGUoXCJsZWZ0XCIsIGZvcm1hdFBlcmNlbnQoc2NhbGUodmFsdWUpKSk7XG4gICAgICAgICAgZHJhZy5vbihcImRyYWdcIiwgb25EcmFnSG9yaXpvbnRhbCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNsaWRlckxlbmd0aCA9IHBhcnNlSW50KGRpdi5zdHlsZShcIndpZHRoXCIpLCAxMCk7XG5cbiAgICAgIH0gZWxzZSB7IC8vIFZlcnRpY2FsXG5cbiAgICAgICAgZGl2Lm9uKFwiY2xpY2tcIiwgb25DbGlja1ZlcnRpY2FsKTtcbiAgICAgICAgZHJhZy5vbihcImRyYWdcIiwgb25EcmFnVmVydGljYWwpO1xuICAgICAgICBpZiAodG9UeXBlKHZhbHVlKSA9PSBcImFycmF5XCIgJiYgdmFsdWUubGVuZ3RoID09IDIpIHtcbiAgICAgICAgICBkaXZSYW5nZSA9IGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoJ2RpdicpLmNsYXNzZWQoXCJkMy1zbGlkZXItcmFuZ2UtdmVydGljYWxcIiwgdHJ1ZSk7XG5cbiAgICAgICAgICBoYW5kbGUxLnN0eWxlKFwiYm90dG9tXCIsIGZvcm1hdFBlcmNlbnQoc2NhbGUodmFsdWVbIDAgXSkpKTtcbiAgICAgICAgICBkaXZSYW5nZS5zdHlsZShcImJvdHRvbVwiLCBmb3JtYXRQZXJjZW50KHNjYWxlKHZhbHVlWyAwIF0pKSk7XG4gICAgICAgICAgZHJhZy5vbihcImRyYWdcIiwgb25EcmFnVmVydGljYWwpO1xuXG4gICAgICAgICAgdmFyIHRvcCA9IDEwMCAtIHBhcnNlRmxvYXQoZm9ybWF0UGVyY2VudChzY2FsZSh2YWx1ZVsgMSBdKSkpO1xuICAgICAgICAgIGhhbmRsZTIuc3R5bGUoXCJib3R0b21cIiwgZm9ybWF0UGVyY2VudChzY2FsZSh2YWx1ZVsgMSBdKSkpO1xuICAgICAgICAgIGRpdlJhbmdlLnN0eWxlKFwidG9wXCIsIHRvcCtcIiVcIik7XG4gICAgICAgICAgZHJhZy5vbihcImRyYWdcIiwgb25EcmFnVmVydGljYWwpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaGFuZGxlMS5zdHlsZShcImJvdHRvbVwiLCBmb3JtYXRQZXJjZW50KHNjYWxlKHZhbHVlKSkpO1xuICAgICAgICAgIGRyYWcub24oXCJkcmFnXCIsIG9uRHJhZ1ZlcnRpY2FsKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2xpZGVyTGVuZ3RoID0gcGFyc2VJbnQoZGl2LnN0eWxlKFwiaGVpZ2h0XCIpLCAxMCk7XG5cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGF4aXMpIHtcbiAgICAgICAgY3JlYXRlQXhpcyhkaXYpO1xuICAgICAgfVxuXG5cbiAgICAgIGZ1bmN0aW9uIGNyZWF0ZUF4aXMoZG9tKSB7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGF4aXMgaWYgbm90IGRlZmluZWQgYnkgdXNlclxuICAgICAgICBpZiAodHlwZW9mIGF4aXMgPT09IFwiYm9vbGVhblwiKSB7XG5cbiAgICAgICAgICBheGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgICAudGlja3MoTWF0aC5yb3VuZChzbGlkZXJMZW5ndGggLyAxMDApKVxuICAgICAgICAgICAgICAudGlja0Zvcm1hdCh0aWNrRm9ybWF0KVxuICAgICAgICAgICAgICAub3JpZW50KChvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpID8gXCJib3R0b21cIiA6ICBcInJpZ2h0XCIpO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb3B5IHNsaWRlciBzY2FsZSB0byBtb3ZlIGZyb20gcGVyY2VudGFnZXMgdG8gcGl4ZWxzXG4gICAgICAgIGF4aXNTY2FsZSA9IHNjYWxlLnRpY2tzID8gc2NhbGUuY29weSgpLnJhbmdlKFswLCBzbGlkZXJMZW5ndGhdKSA6IHNjYWxlLmNvcHkoKS5yYW5nZVBvaW50cyhbMCwgc2xpZGVyTGVuZ3RoXSwgMC41KTtcbiAgICAgICAgICBheGlzLnNjYWxlKGF4aXNTY2FsZSk7XG5cbiAgICAgICAgICAvLyBDcmVhdGUgU1ZHIGF4aXMgY29udGFpbmVyXG4gICAgICAgIHZhciBzdmcgPSBkb20uYXBwZW5kKFwic3ZnXCIpXG4gICAgICAgICAgICAuY2xhc3NlZChcImQzLXNsaWRlci1heGlzIGQzLXNsaWRlci1heGlzLVwiICsgYXhpcy5vcmllbnQoKSwgdHJ1ZSlcbiAgICAgICAgICAgIC5vbihcImNsaWNrXCIsIHN0b3BQcm9wYWdhdGlvbik7XG5cbiAgICAgICAgdmFyIGcgPSBzdmcuYXBwZW5kKFwiZ1wiKTtcblxuICAgICAgICAvLyBIb3Jpem9udGFsIGF4aXNcbiAgICAgICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuXG4gICAgICAgICAgc3ZnLnN0eWxlKFwibWFyZ2luLWxlZnRcIiwgLW1hcmdpbiArIFwicHhcIik7XG5cbiAgICAgICAgICBzdmcuYXR0cih7XG4gICAgICAgICAgICB3aWR0aDogc2xpZGVyTGVuZ3RoICsgbWFyZ2luICogMixcbiAgICAgICAgICAgIGhlaWdodDogbWFyZ2luXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoYXhpcy5vcmllbnQoKSA9PT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgc3ZnLnN0eWxlKFwidG9wXCIsIC1tYXJnaW4gKyBcInB4XCIpO1xuICAgICAgICAgICAgZy5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgbWFyZ2luICsgXCIsXCIgKyBtYXJnaW4gKyBcIilcIik7XG4gICAgICAgICAgfSBlbHNlIHsgLy8gYm90dG9tXG4gICAgICAgICAgICBnLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4gKyBcIiwwKVwiKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHsgLy8gVmVydGljYWxcblxuICAgICAgICAgIHN2Zy5zdHlsZShcInRvcFwiLCAtbWFyZ2luICsgXCJweFwiKTtcblxuICAgICAgICAgIHN2Zy5hdHRyKHtcbiAgICAgICAgICAgIHdpZHRoOiBtYXJnaW4sXG4gICAgICAgICAgICBoZWlnaHQ6IHNsaWRlckxlbmd0aCArIG1hcmdpbiAqIDJcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmIChheGlzLm9yaWVudCgpID09PSBcImxlZnRcIikge1xuICAgICAgICAgICAgc3ZnLnN0eWxlKFwibGVmdFwiLCAtbWFyZ2luICsgXCJweFwiKTtcbiAgICAgICAgICAgIGcuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbiArIFwiLFwiICsgbWFyZ2luICsgXCIpXCIpO1xuICAgICAgICAgIH0gZWxzZSB7IC8vIHJpZ2h0ICAgICAgICAgIFxuICAgICAgICAgICAgZy5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgMCArIFwiLFwiICsgbWFyZ2luICsgXCIpXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgZy5jYWxsKGF4aXMpO1xuXG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uQ2xpY2tIb3Jpem9udGFsKCkge1xuICAgICAgICBpZiAodG9UeXBlKHZhbHVlKSAhPSBcImFycmF5XCIpIHtcbiAgICAgICAgICB2YXIgcG9zID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2xpZGVyTGVuZ3RoLCBkMy5ldmVudC5vZmZzZXRYIHx8IGQzLmV2ZW50LmxheWVyWCkpO1xuICAgICAgICAgIG1vdmVIYW5kbGUoc2NhbGUuaW52ZXJ0ID8gXG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFZhbHVlKHNjYWxlLmludmVydChwb3MgLyBzbGlkZXJMZW5ndGgpKVxuICAgICAgICAgICAgICAgICAgICA6IG5lYXJlc3RUaWNrKHBvcyAvIHNsaWRlckxlbmd0aCkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uQ2xpY2tWZXJ0aWNhbCgpIHtcbiAgICAgICAgaWYgKHRvVHlwZSh2YWx1ZSkgIT0gXCJhcnJheVwiKSB7XG4gICAgICAgICAgdmFyIHBvcyA9IHNsaWRlckxlbmd0aCAtIE1hdGgubWF4KDAsIE1hdGgubWluKHNsaWRlckxlbmd0aCwgZDMuZXZlbnQub2Zmc2V0WSB8fCBkMy5ldmVudC5sYXllclkpKTtcbiAgICAgICAgICBtb3ZlSGFuZGxlKHNjYWxlLmludmVydCA/IFxuICAgICAgICAgICAgICAgICAgICAgIHN0ZXBWYWx1ZShzY2FsZS5pbnZlcnQocG9zIC8gc2xpZGVyTGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgICAgOiBuZWFyZXN0VGljayhwb3MgLyBzbGlkZXJMZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkRyYWdIb3Jpem9udGFsKCkge1xuICAgICAgICBpZiAoIGQzLmV2ZW50LnNvdXJjZUV2ZW50LnRhcmdldC5pZCA9PT0gXCJoYW5kbGUtb25lXCIpIHtcbiAgICAgICAgICBhY3RpdmUgPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKCBkMy5ldmVudC5zb3VyY2VFdmVudC50YXJnZXQuaWQgPT0gXCJoYW5kbGUtdHdvXCIgKSB7XG4gICAgICAgICAgYWN0aXZlID0gMjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcG9zID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2xpZGVyTGVuZ3RoLCBkMy5ldmVudC54KSk7XG4gICAgICAgIG1vdmVIYW5kbGUoc2NhbGUuaW52ZXJ0ID8gXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBWYWx1ZShzY2FsZS5pbnZlcnQocG9zIC8gc2xpZGVyTGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgIDogbmVhcmVzdFRpY2socG9zIC8gc2xpZGVyTGVuZ3RoKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uRHJhZ1ZlcnRpY2FsKCkge1xuICAgICAgICBpZiAoIGQzLmV2ZW50LnNvdXJjZUV2ZW50LnRhcmdldC5pZCA9PT0gXCJoYW5kbGUtb25lXCIpIHtcbiAgICAgICAgICBhY3RpdmUgPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKCBkMy5ldmVudC5zb3VyY2VFdmVudC50YXJnZXQuaWQgPT0gXCJoYW5kbGUtdHdvXCIgKSB7XG4gICAgICAgICAgYWN0aXZlID0gMjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcG9zID0gc2xpZGVyTGVuZ3RoIC0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2xpZGVyTGVuZ3RoLCBkMy5ldmVudC55KSlcbiAgICAgICAgbW92ZUhhbmRsZShzY2FsZS5pbnZlcnQgPyBcbiAgICAgICAgICAgICAgICAgICAgc3RlcFZhbHVlKHNjYWxlLmludmVydChwb3MgLyBzbGlkZXJMZW5ndGgpKVxuICAgICAgICAgICAgICAgICAgOiBuZWFyZXN0VGljayhwb3MgLyBzbGlkZXJMZW5ndGgpKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKCkge1xuICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH1cblxuICAgIH0pO1xuXG4gIH1cblxuICAvLyBNb3ZlIHNsaWRlciBoYW5kbGUgb24gY2xpY2svZHJhZ1xuICBmdW5jdGlvbiBtb3ZlSGFuZGxlKG5ld1ZhbHVlKSB7XG4gICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHRvVHlwZSh2YWx1ZSkgPT0gXCJhcnJheVwiICAmJiB2YWx1ZS5sZW5ndGggPT0gMiA/IHZhbHVlW2FjdGl2ZSAtIDFdOiB2YWx1ZSxcbiAgICAgICAgb2xkUG9zID0gZm9ybWF0UGVyY2VudChzY2FsZShzdGVwVmFsdWUoY3VycmVudFZhbHVlKSkpLFxuICAgICAgICBuZXdQb3MgPSBmb3JtYXRQZXJjZW50KHNjYWxlKHN0ZXBWYWx1ZShuZXdWYWx1ZSkpKSxcbiAgICAgICAgcG9zaXRpb24gPSAob3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiKSA/IFwibGVmdFwiIDogXCJib3R0b21cIjtcbiAgICBpZiAob2xkUG9zICE9PSBuZXdQb3MpIHtcblxuICAgICAgaWYgKHRvVHlwZSh2YWx1ZSkgPT0gXCJhcnJheVwiICYmIHZhbHVlLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgIHZhbHVlWyBhY3RpdmUgLSAxIF0gPSBuZXdWYWx1ZTtcbiAgICAgICAgaWYgKGQzLmV2ZW50KSB7XG4gICAgICAgICAgZGlzcGF0Y2guc2xpZGUoZDMuZXZlbnQsIHZhbHVlICk7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZDMuZXZlbnQpIHtcbiAgICAgICAgICBkaXNwYXRjaC5zbGlkZShkMy5ldmVudC5zb3VyY2VFdmVudCB8fCBkMy5ldmVudCwgdmFsdWUgPSBuZXdWYWx1ZSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGlmICggdmFsdWVbIDAgXSA+PSB2YWx1ZVsgMSBdICkgcmV0dXJuO1xuICAgICAgaWYgKCBhY3RpdmUgPT09IDEgKSB7XG4gICAgICAgIGlmICh0b1R5cGUodmFsdWUpID09IFwiYXJyYXlcIiAmJiB2YWx1ZS5sZW5ndGggPT0gMikge1xuICAgICAgICAgIChwb3NpdGlvbiA9PT0gXCJsZWZ0XCIpID8gZGl2UmFuZ2Uuc3R5bGUoXCJsZWZ0XCIsIG5ld1BvcykgOiBkaXZSYW5nZS5zdHlsZShcImJvdHRvbVwiLCBuZXdQb3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFuaW1hdGUpIHtcbiAgICAgICAgICBoYW5kbGUxLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAuc3R5bGVUd2Vlbihwb3NpdGlvbiwgZnVuY3Rpb24oKSB7IHJldHVybiBkMy5pbnRlcnBvbGF0ZShvbGRQb3MsIG5ld1Bvcyk7IH0pXG4gICAgICAgICAgICAgIC5kdXJhdGlvbigodHlwZW9mIGFuaW1hdGUgPT09IFwibnVtYmVyXCIpID8gYW5pbWF0ZSA6IDI1MCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaGFuZGxlMS5zdHlsZShwb3NpdGlvbiwgbmV3UG9zKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgXG4gICAgICAgIHZhciB3aWR0aCA9IDEwMCAtIHBhcnNlRmxvYXQobmV3UG9zKTtcbiAgICAgICAgdmFyIHRvcCA9IDEwMCAtIHBhcnNlRmxvYXQobmV3UG9zKTtcblxuICAgICAgICAocG9zaXRpb24gPT09IFwibGVmdFwiKSA/IGRpdlJhbmdlLnN0eWxlKFwicmlnaHRcIiwgd2lkdGggKyBcIiVcIikgOiBkaXZSYW5nZS5zdHlsZShcInRvcFwiLCB0b3AgKyBcIiVcIik7XG4gICAgICAgIFxuICAgICAgICBpZiAoYW5pbWF0ZSkge1xuICAgICAgICAgIGhhbmRsZTIudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgIC5zdHlsZVR3ZWVuKHBvc2l0aW9uLCBmdW5jdGlvbigpIHsgcmV0dXJuIGQzLmludGVycG9sYXRlKG9sZFBvcywgbmV3UG9zKTsgfSlcbiAgICAgICAgICAgICAgLmR1cmF0aW9uKCh0eXBlb2YgYW5pbWF0ZSA9PT0gXCJudW1iZXJcIikgPyBhbmltYXRlIDogMjUwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBoYW5kbGUyLnN0eWxlKHBvc2l0aW9uLCBuZXdQb3MpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIG5lYXJlc3Qgc3RlcCB2YWx1ZVxuICBmdW5jdGlvbiBzdGVwVmFsdWUodmFsKSB7XG5cbiAgICBpZiAodmFsID09PSBzY2FsZS5kb21haW4oKVswXSB8fCB2YWwgPT09IHNjYWxlLmRvbWFpbigpWzFdKSB7XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH1cblxuICAgIHZhciBhbGlnblZhbHVlID0gdmFsO1xuICAgIGlmIChzbmFwKSB7XG4gICAgICBhbGlnblZhbHVlID0gbmVhcmVzdFRpY2soc2NhbGUodmFsKSk7XG4gICAgfSBlbHNle1xuICAgICAgdmFyIHZhbE1vZFN0ZXAgPSAodmFsIC0gc2NhbGUuZG9tYWluKClbMF0pICUgc3RlcDtcbiAgICAgIGFsaWduVmFsdWUgPSB2YWwgLSB2YWxNb2RTdGVwO1xuXG4gICAgICBpZiAoTWF0aC5hYnModmFsTW9kU3RlcCkgKiAyID49IHN0ZXApIHtcbiAgICAgICAgYWxpZ25WYWx1ZSArPSAodmFsTW9kU3RlcCA+IDApID8gc3RlcCA6IC1zdGVwO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gYWxpZ25WYWx1ZTtcblxuICB9XG5cbiAgLy8gRmluZCB0aGUgbmVhcmVzdCB0aWNrXG4gIGZ1bmN0aW9uIG5lYXJlc3RUaWNrKHBvcykge1xuICAgIHZhciB0aWNrcyA9IHNjYWxlLnRpY2tzID8gc2NhbGUudGlja3MoKSA6IHNjYWxlLmRvbWFpbigpO1xuICAgIHZhciBkaXN0ID0gdGlja3MubWFwKGZ1bmN0aW9uKGQpIHtyZXR1cm4gcG9zIC0gc2NhbGUoZCk7fSk7XG4gICAgdmFyIGkgPSAtMSxcbiAgICAgICAgaW5kZXggPSAwLFxuICAgICAgICByID0gc2NhbGUudGlja3MgPyBzY2FsZS5yYW5nZSgpWzFdIDogc2NhbGUucmFuZ2VFeHRlbnQoKVsxXTtcbiAgICBkbyB7XG4gICAgICAgIGkrKztcbiAgICAgICAgaWYgKE1hdGguYWJzKGRpc3RbaV0pIDwgcikge1xuICAgICAgICAgIHIgPSBNYXRoLmFicyhkaXN0W2ldKTtcbiAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgIH07XG4gICAgfSB3aGlsZSAoZGlzdFtpXSA+IDAgJiYgaSA8IGRpc3QubGVuZ3RoIC0gMSk7XG5cbiAgICByZXR1cm4gdGlja3NbaW5kZXhdO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgdHlwZSBvZiBhbiBvYmplY3RcbiAgZnVuY3Rpb24gdG9UeXBlKHYpIHtcbiAgICByZXR1cm4gKHt9KS50b1N0cmluZy5jYWxsKHYpLm1hdGNoKC9cXHMoW2EtekEtWl0rKS8pWzFdLnRvTG93ZXJDYXNlKCk7XG4gIH07XG5cbiAgLy8gR2V0dGVyL3NldHRlciBmdW5jdGlvbnNcbiAgc2xpZGVyLm1pbiA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBtaW47XG4gICAgbWluID0gXztcbiAgICByZXR1cm4gc2xpZGVyO1xuICB9O1xuXG4gIHNsaWRlci5tYXggPSBmdW5jdGlvbihfKSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gbWF4O1xuICAgIG1heCA9IF87XG4gICAgcmV0dXJuIHNsaWRlcjtcbiAgfTtcblxuICBzbGlkZXIuc3RlcCA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBzdGVwO1xuICAgIHN0ZXAgPSBfO1xuICAgIHJldHVybiBzbGlkZXI7XG4gIH07XG5cbiAgc2xpZGVyLmFuaW1hdGUgPSBmdW5jdGlvbihfKSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gYW5pbWF0ZTtcbiAgICBhbmltYXRlID0gXztcbiAgICByZXR1cm4gc2xpZGVyO1xuICB9O1xuXG4gIHNsaWRlci5vcmllbnRhdGlvbiA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBvcmllbnRhdGlvbjtcbiAgICBvcmllbnRhdGlvbiA9IF87XG4gICAgcmV0dXJuIHNsaWRlcjtcbiAgfTtcblxuICBzbGlkZXIuYXhpcyA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBheGlzO1xuICAgIGF4aXMgPSBfO1xuICAgIHJldHVybiBzbGlkZXI7XG4gIH07XG5cbiAgc2xpZGVyLm1hcmdpbiA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBtYXJnaW47XG4gICAgbWFyZ2luID0gXztcbiAgICByZXR1cm4gc2xpZGVyO1xuICB9O1xuXG4gIHNsaWRlci52YWx1ZSA9IGZ1bmN0aW9uKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB2YWx1ZTtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIG1vdmVIYW5kbGUoc3RlcFZhbHVlKF8pKTtcbiAgICB9O1xuICAgIHZhbHVlID0gXztcbiAgICByZXR1cm4gc2xpZGVyO1xuICB9O1xuXG4gIHNsaWRlci5zbmFwID0gZnVuY3Rpb24oXykge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHNuYXA7XG4gICAgc25hcCA9IF87XG4gICAgcmV0dXJuIHNsaWRlcjtcbiAgfTtcblxuICBzbGlkZXIuc2NhbGUgPSBmdW5jdGlvbihfKSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gc2NhbGU7XG4gICAgc2NhbGUgPSBfO1xuICAgIHJldHVybiBzbGlkZXI7XG4gIH07XG5cbiAgZDMucmViaW5kKHNsaWRlciwgZGlzcGF0Y2gsIFwib25cIik7XG5cbiAgcmV0dXJuIHNsaWRlcjtcblxufVxufSkpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9