function updateCars(t){document.getElementById("carNumber").value=t,document.getElementById("carRange").value=t;var n=shockingUpdate({electric_cars:t});console.log("Data from shockingUpdate: ",n),updateGraph("gwh-chart",n.gen_production),updateGraph("co2-chart",{Geothermal:n.gen_emissions.Geothermal,Coal:n.gen_emissions.Coal,Gas:n.gen_emissions.Gas,Road:n.fleet_emissions.Road})}function preprocessData(t,n){var e=[1],r=0;for(var a in t)t.hasOwnProperty(a)&&(r+=t[a],e.push(t[a]));n>0&&e.push(n);for(var o=1;o<e.length;o++)e[o]=Math.round(e[o]/r*100);return e}function updateTotal(t,n){var e=0;for(var r in n)n.hasOwnProperty(r)&&(e+=n[r]);return e=Math.round(e),console.log("Updated total: ",e),document.getElementById(t).innerHTML=e,e}function updateGraph(t,n){var e=80,r=300;console.log("Data passed in: ",n);var a=t.split("-")[0]+"-total",o=updateTotal(a,n);totals[a]||(console.log("Element: ",a,document.getElementById(a).innerHTML),totals[a]=parseInt(document.getElementById(a).innerHTML,10),console.log("TOTALS: ",totals));for(var s=totals[a]-o,l=document.getElementById(t);l.firstChild;)l.removeChild(l.firstChild);var c=d3.select("#"+t).append("svg:svg").attr("class","chart").attr("width",e).attr("height",r).append("svg:g").attr("transform","translate(0,"+r+")");console.log("DELTA: ",s);for(var i=[preprocessData(n,s)],d=[],u=0;u<i[0].length-1;u++)d.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")"),s>0&&(d[i[0].length-1]="rgb(255,255,255)");x=d3.scale.ordinal().rangeRoundBands([0,e]),y=d3.scale.linear().range([0,r]),z=d3.scale.ordinal().range(d);for(var g=[],u=1;u<i[0].length;u++)g.push("c"+u);var p=g.map(function(t,n){return i.map(function(t,e){return{x:e,y:t[n+1]}})}),m=d3.layout.stack()(p);x.domain(m[0].map(function(t){return t.x})),y.domain([0,d3.max(m[m.length-1],function(t){return t.y0+t.y})]);{var h=c.selectAll("g.valgroup").data(m).enter().append("svg:g").attr("class","valgroup").style("fill",function(t,n){return z(n)}).style("stroke",function(t,n){return d3.rgb(z(n)).darker()});h.selectAll("rect").data(function(t){return t}).enter().append("svg:rect").attr("x",function(t){return x(t.x)}).attr("y",function(t){return-y(t.y0)-y(t.y)}).attr("height",function(t){return y(t.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function randomRGB(){return Math.floor(256*Math.random())}function columnGraph(t,n){for(var e=80,r=300,a=d3.select(t).append("svg:svg").attr("class","chart").attr("width",e).attr("height",r).append("svg:g").attr("transform","translate(0,300)"),o=[n],s=[],l=0;l<o[0].length-1;l++)s.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,e]),y=d3.scale.linear().range([0,r]),z=d3.scale.ordinal().range(s);var c=["c1","c2","c3","c4","c5"].map(function(t,n){return o.map(function(t,e){return{x:e,y:t[n+1]}})}),i=d3.layout.stack()(c);x.domain(i[0].map(function(t){return t.x})),y.domain([0,d3.max(i[i.length-1],function(t){return t.y0+t.y})]);{var d=a.selectAll("g.valgroup").data(i).enter().append("svg:g").attr("class","valgroup").style("fill",function(t,n){return z(n)}).style("stroke",function(t,n){return d3.rgb(z(n)).darker()});d.selectAll("rect").data(function(t){return t}).enter().append("svg:rect").attr("x",function(t){return x(t.x)}).attr("y",function(t){return-y(t.y0)-y(t.y)}).attr("height",function(t){return y(t.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function shockingUpdate(t){console.log("shockingUpdate - Inputs: "+JSON.stringify(t));var n=getBaseline(),e=n.gen_production,r=n.gen_emissions,a=n.gen_cost,o={Road:12688},s=t.electric_cars,l=s/100;o.Road=o.Road*(1-l),ev_power_reqts=2406.4*3341013*l,ev_power_reqts/=1e6;var c=0;for(var i in e)c+=e[i];var d=1+ev_power_reqts/c;console.log("total: "+c),console.log("increase from electric vehicles: "+d),console.log("ev_power_reqts "+ev_power_reqts);var u=(t.solar_houses,5260*t.solar_houses);u/=1e6,console.log("solar production: "+u);var g=u/c;d-=g;for(var i in r)r[i]=r[i]*d;for(var i in e)e[i]=e[i]*d;e.Solar=u;for(var i in r)r[i]=r[i]*d;for(var i in a)a[i]=a[i]*d;var p={gen_production:e,gen_emissions:r,gen_cost:a,fleet_emissions:o};return console.log("Result: "+JSON.stringify(p)),p}function getBaseline(){var t={Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626},n={Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51},e={Hydro:100,Geothermal:150,Wind:200,Coal:250,Gas:300},r={gen_production:t,gen_emissions:n,gen_cost:e};return r}function mockGWh(){return{Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626}}function mockAdjustGWh(){return{Hydro:24,Geothermal:648,Wind:1218,Coal:832,Gas:362}}function mockGenerationEmissions(){return{Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51}}function mockFleetEmissions(){return{Road:12688}}var totals={};document.addEventListener("DOMContentLoaded",function(t){updateCars(0),columnGraph("#cost-chart",[1,10,15,15,35,50]),columnGraph("#investment-chart",[1,5,10,15,45,50])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXJ0LmpzIiwiZW5naW5lLmpzIiwibW9jay5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVDYXJzIiwidmFsdWUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZGF0YSIsInNob2NraW5nVXBkYXRlIiwiZWxlY3RyaWNfY2FycyIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVHcmFwaCIsImdlbl9wcm9kdWN0aW9uIiwiR2VvdGhlcm1hbCIsImdlbl9lbWlzc2lvbnMiLCJDb2FsIiwiR2FzIiwiUm9hZCIsImZsZWV0X2VtaXNzaW9ucyIsInByZXByb2Nlc3NEYXRhIiwiZGVsdGEiLCJ2YWx1ZXMiLCJ0b3RhbCIsImsiLCJoYXNPd25Qcm9wZXJ0eSIsInB1c2giLCJpIiwibGVuZ3RoIiwiTWF0aCIsInJvdW5kIiwidXBkYXRlVG90YWwiLCJ0b3RhbElkIiwiaW5uZXJIVE1MIiwiYmluZFRvIiwidyIsImgiLCJzcGxpdCIsIm5ld1RvdGFsIiwidG90YWxzIiwicGFyc2VJbnQiLCJlbGVtZW50IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwic3ZnIiwiZDMiLCJzZWxlY3QiLCJhcHBlbmQiLCJhdHRyIiwibWF0cml4IiwiY29sb3JzIiwicmFuZG9tUkdCIiwieCIsInNjYWxlIiwib3JkaW5hbCIsInJhbmdlUm91bmRCYW5kcyIsInkiLCJsaW5lYXIiLCJyYW5nZSIsInoiLCJhIiwicmVtYXBwZWQiLCJtYXAiLCJkYXQiLCJkIiwiaWkiLCJzdGFja2VkIiwibGF5b3V0Iiwic3RhY2siLCJkb21haW4iLCJtYXgiLCJ5MCIsInZhbGdyb3VwIiwic2VsZWN0QWxsIiwiZW50ZXIiLCJzdHlsZSIsInJnYiIsImRhcmtlciIsIm1pbiIsImFwcGx5IiwicmFuZ2VCYW5kIiwiZmxvb3IiLCJyYW5kb20iLCJjb2x1bW5HcmFwaCIsImlucHV0cyIsIkpTT04iLCJzdHJpbmdpZnkiLCJiYXNlbGluZSIsImdldEJhc2VsaW5lIiwiZ2VuX2Nvc3QiLCJlbGVjdHJpY19wY3QiLCJldl9wb3dlcl9yZXF0cyIsInRvdGFsX2dlbiIsImtleSIsImluY3JlYXNlX2luX3Bvd2VyX3JlcXRzIiwic29sYXJfcHJvZHVjdGlvbiIsImRlY3JlYXNlX2R1ZV90b19zb2xhciIsInJlc3VsdCIsIkh5ZHJvIiwiV2luZCIsIm1vY2tHV2giLCJtb2NrQWRqdXN0R1doIiwibW9ja0dlbmVyYXRpb25FbWlzc2lvbnMiLCJtb2NrRmxlZXRFbWlzc2lvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiXSwibWFwcGluZ3MiOiJBQWFBLFFBQUFBLFlBQUFDLEdBQ0FDLFNBQUFDLGVBQUEsYUFBQUYsTUFBQUEsRUFDQUMsU0FBQUMsZUFBQSxZQUFBRixNQUFBQSxDQUVBLElBQUFHLEdBQUFDLGdCQUFBQyxjQUFBTCxHQUVBTSxTQUFBQyxJQUFBLDZCQUFBSixHQUNBSyxZQUFBLFlBQUFMLEVBQUFNLGdCQUNBRCxZQUFBLGFBQ0FFLFdBQUFQLEVBQUFRLGNBQUEsV0FDQUMsS0FBQVQsRUFBQVEsY0FBQSxLQUNBRSxJQUFBVixFQUFBUSxjQUFBLElBQ0FHLEtBQUFYLEVBQUFZLGdCQUFBLE9DekJBLFFBQUFDLGdCQUFBYixFQUFBYyxHQUVBLEdBQUFDLElBQUEsR0FDQUMsRUFBQSxDQUNBLEtBQUEsR0FBQUMsS0FBQWpCLEdBQ0FBLEVBQUFrQixlQUFBRCxLQUNBRCxHQUFBaEIsRUFBQWlCLEdBQ0FGLEVBQUFJLEtBQUFuQixFQUFBaUIsSUFLQUgsR0FBQSxHQUNBQyxFQUFBSSxLQUFBTCxFQUlBLEtBQUEsR0FBQU0sR0FBQSxFQUFBQSxFQUFBTCxFQUFBTSxPQUFBRCxJQUNBTCxFQUFBSyxHQUFBRSxLQUFBQyxNQUFBUixFQUFBSyxHQUFBSixFQUFBLElBR0EsT0FBQUQsR0FHQSxRQUFBUyxhQUFBQyxFQUFBekIsR0FDQSxHQUFBZ0IsR0FBQSxDQUNBLEtBQUEsR0FBQUMsS0FBQWpCLEdBQ0FBLEVBQUFrQixlQUFBRCxLQUNBRCxHQUFBaEIsRUFBQWlCLEdBT0EsT0FKQUQsR0FBQU0s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QUEsbUJBQUEsU0FBQUMsR0FDQXRHLFdBQUEsR0FDQWdGLFlBQUEsZUFDQSxFQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsS0FFQUEsWUFBQSxxQkFDQSxFQUFBLEVBQUEsR0FBQSxHQUFBLEdBQUEiLCJmaWxlIjoianMvYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHRvdGFscyA9IHt9O1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbihldmVudCkge1xuICB1cGRhdGVDYXJzKDApO1xuICBjb2x1bW5HcmFwaChcIiNjb3N0LWNoYXJ0XCIsIFtcbiAgICAxLCAxMCwgMTUsIDE1LCAzNSwgNTBcbiAgXSk7XG4gIGNvbHVtbkdyYXBoKFwiI2ludmVzdG1lbnQtY2hhcnRcIiwgW1xuICAgIDEsIDUsIDEwLCAxNSwgNDUsIDUwXG4gIF0pO1xufSk7XG5cblxuZnVuY3Rpb24gdXBkYXRlQ2FycyAodmFsdWUpIHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhck51bWJlcicpLnZhbHVlID0gdmFsdWU7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJSYW5nZScpLnZhbHVlID0gdmFsdWU7XG5cbiAgdmFyIGRhdGEgPSBzaG9ja2luZ1VwZGF0ZSh7J2VsZWN0cmljX2NhcnMnOiB2YWx1ZX0pO1xuXG4gIGNvbnNvbGUubG9nKFwiRGF0YSBmcm9tIHNob2NraW5nVXBkYXRlOiBcIiwgZGF0YSk7XG4gIHVwZGF0ZUdyYXBoKCdnd2gtY2hhcnQnLCBkYXRhLmdlbl9wcm9kdWN0aW9uKTtcbiAgdXBkYXRlR3JhcGgoJ2NvMi1jaGFydCcsIHtcbiAgICAnR2VvdGhlcm1hbCc6IGRhdGEuZ2VuX2VtaXNzaW9uc1snR2VvdGhlcm1hbCddLFxuICAgICdDb2FsJzogZGF0YS5nZW5fZW1pc3Npb25zWydDb2FsJ10sXG4gICAgJ0dhcyc6IGRhdGEuZ2VuX2VtaXNzaW9uc1snR2FzJ10sXG4gICAgJ1JvYWQnOiBkYXRhLmZsZWV0X2VtaXNzaW9uc1snUm9hZCddXG4gIH0pO1xufVxuXG4iLCJmdW5jdGlvbiBwcmVwcm9jZXNzRGF0YSAoZGF0YSwgZGVsdGEpIHtcbiAgLy8gSG9ycmlibGUga2x1ZGdlIHRvIGdldCB0aGluZ3Mgd29ya2luZyBmb3IgcHJvb2Ygb2YgY29uY2VwdC4uLlxuICB2YXIgdmFsdWVzID0gWzFdO1xuICB2YXIgdG90YWwgPSAwO1xuICBmb3IgKHZhciBrIGluIGRhdGEpIHtcbiAgICBpZihkYXRhLmhhc093blByb3BlcnR5KGspKXtcbiAgICAgIHRvdGFsICs9IGRhdGFba107XG4gICAgICB2YWx1ZXMucHVzaChkYXRhW2tdKTtcbiAgICB9XG4gIH1cblxuICAvLyBkZWx0YSByZXByZXNlbnRzIGNoYW5nZSBpbiB0b3RhbCB2YWx1ZVxuICBpZiAoZGVsdGEgPiAwKSB7XG4gICAgdmFsdWVzLnB1c2goZGVsdGEpO1xuICB9XG5cbiAgLy8gTmVlZCBwZXJjZW50IHZhbHVlcyBmb3IgY2hhcnRcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YWx1ZXNbaV0gPSBNYXRoLnJvdW5kKCh2YWx1ZXNbaV0gLyB0b3RhbCkgKiAxMDApO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlcztcbn1cblxuZnVuY3Rpb24gdXBkYXRlVG90YWwodG90YWxJZCwgZGF0YSkge1xuICB2YXIgdG90YWwgPSAwO1xuICBmb3IgKHZhciBrIGluIGRhdGEpIHtcbiAgICBpZihkYXRhLmhhc093blByb3BlcnR5KGspKXtcbiAgICAgIHRvdGFsICs9IGRhdGFba107XG4gICAgfVxuICB9XG4gIHRvdGFsID0gTWF0aC5yb3VuZCh0b3RhbCk7XG4gIGNvbnNvbGUubG9nKFwiVXBkYXRlZCB0b3RhbDogXCIsIHRvdGFsKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodG90YWxJZCkuaW5uZXJIVE1MID0gdG90YWw7XG5cbiAgcmV0dXJuIHRvdGFsO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVHcmFwaCAoYmluZFRvLCBkYXRhKSB7XG4gIHZhciB3ID0gODA7XG4gIHZhciBoID0gMzAwO1xuXG4gIGNvbnNvbGUubG9nKFwiRGF0YSBwYXNzZWQgaW46IFwiLCBkYXRhKTtcbiAgdmFyIHRvdGFsSWQgPSBiaW5kVG8uc3BsaXQoJy0nKVswXSArICctdG90YWwnO1xuICB2YXIgbmV3VG90YWwgPSB1cGRhdGVUb3RhbCh0b3RhbElkLCBkYXRhKTtcblxuICAvLyBTdG9yZSBhcyBnbG9iYWwgZm9yIHRoZSBsaWZlIG9mIHRoZSBkb2N1bWVudFxuICBpZiAoIXRvdGFsc1t0b3RhbElkXSkge1xuICAgIGNvbnNvbGUubG9nKFwiRWxlbWVudDogXCIsdG90YWxJZCwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodG90YWxJZCkuaW5uZXJIVE1MKTtcbiAgICB0b3RhbHNbdG90YWxJZF0gPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0b3RhbElkKS5pbm5lckhUTUwsIDEwKTtcbiAgICBjb25zb2xlLmxvZyhcIlRPVEFMUzogXCIsIHRvdGFscyk7XG4gIH1cbiAgdmFyIGRlbHRhID0gdG90YWxzW3RvdGFsSWRdIC0gbmV3VG90YWw7XG5cbiAgLy8gSGFja3k6IHJlbW92ZSBjaGFydCBpZiBpdCBleGlzdHNcbiAgLy8gVE9ETzogdHJhbnNpdGlvbiFcbiAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChiaW5kVG8pO1xuICB3aGlsZSAoZWxlbWVudC5maXJzdENoaWxkKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICB9XG5cbiAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnIycgKyBiaW5kVG8pLmFwcGVuZChcInN2ZzpzdmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiY2hhcnRcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIHcpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgaCApXG4gICAgLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGggKyBcIilcIik7XG5cbiAgLy8gSWYgZGlmZmVyZW5jZSBiZXR3ZWVuIHRvdGFscyBpcyBwb3NpdGl2ZSwgYW4gYWRkaXRpb25hbCBhcnJheSBlbGVtZW50XG4gIC8vIHdpbGwgYmUgYWRkZWQgdG8gcGFkIHRoZSBjaGFydCBhcyB0aGUgdG90YWwgc2hyaW5rc1xuICBjb25zb2xlLmxvZyhcIkRFTFRBOiBcIiwgZGVsdGEpO1xuICB2YXIgbWF0cml4ID0gW3ByZXByb2Nlc3NEYXRhKGRhdGEsIGRlbHRhKV07XG5cbiAgLy8gUmFuZG9tIGZvciBub3dcbiAgdmFyIGNvbG9ycyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdHJpeFswXS5sZW5ndGggLTE7IGkrKykge1xuICAgIGNvbG9ycy5wdXNoKCdyZ2IoJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcpJyk7XG5cbiAgICAvLyBQYWRkaW5nIGNvbG91clxuICAgIGlmIChkZWx0YSA+IDApIHtcbiAgICAgIGNvbG9yc1ttYXRyaXhbMF0ubGVuZ3RoLTFdID0gXCJyZ2IoMjU1LDI1NSwyNTUpXCI7XG4gICAgfVxuICB9XG5cbiAgeCA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZVJvdW5kQmFuZHMoWzAsIHddKTtcbiAgeSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFswLCBoXSk7XG4gIHogPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2UoY29sb3JzKTtcblxuICAvLyBDb3BlIHdpdGggdmFyaWFibGUgbnVtYmVyIG9mIHByb3BlcnRpZXMsIGZvciBub3dcbiAgdmFyIGEgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBtYXRyaXhbMF0ubGVuZ3RoOyBpKyspIHtcbiAgICBhLnB1c2goXCJjXCIgKyBpKTtcbiAgfVxuICAvL3ZhciByZW1hcHBlZCA9IFtcImMxXCIsXCJjMlwiLFwiYzNcIixcImM0XCIsXCJjNVwiXS5tYXAoZnVuY3Rpb24oZGF0LGkpe1xuICB2YXIgcmVtYXBwZWQgPSBhLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gICAgcmV0dXJuIG1hdHJpeC5tYXAoZnVuY3Rpb24oZCxpaSl7XG4gICAgICByZXR1cm4ge3g6IGlpLCB5OiBkW2krMV0gfTtcbiAgICB9KVxuICB9KTtcblxuICB2YXIgc3RhY2tlZCA9IGQzLmxheW91dC5zdGFjaygpKHJlbWFwcGVkKVxuXG4gIHguZG9tYWluKHN0YWNrZWRbMF0ubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSkpO1xuICB5LmRvbWFpbihbMCwgZDMubWF4KHN0YWNrZWRbc3RhY2tlZC5sZW5ndGggLSAxXSwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55MCArIGQueTsgfSldKTtcblxuICB2YXIgdmFsZ3JvdXAgPSBzdmcuc2VsZWN0QWxsKFwiZy52YWxncm91cFwiKVxuICAgIC5kYXRhKHN0YWNrZWQpXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwidmFsZ3JvdXBcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIHooaSk7IH0pXG4gICAgLnN0eWxlKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGQzLnJnYih6KGkpKS5kYXJrZXIoKTsgfSk7XG5cbiAgdmFyIHJlY3QgPSB2YWxncm91cC5zZWxlY3RBbGwoXCJyZWN0XCIpXG4gICAgLmRhdGEoZnVuY3Rpb24oZCl7cmV0dXJuIGQ7fSlcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6cmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQueCk7IH0pXG4gICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIC15KGQueTApIC0geShkLnkpOyB9KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC55KTsgfSlcbiAgICAuYXR0cihcIndpZHRoXCIsIE1hdGgubWluLmFwcGx5KG51bGwsIFt4LnJhbmdlQmFuZCgpLTIsIDEwMF0pKTtcbn1cblxuZnVuY3Rpb24gcmFuZG9tUkdCICgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1Nik7XG59XG5cbmZ1bmN0aW9uIGNvbHVtbkdyYXBoIChiaW5kVG8sIHZhbHVlcykge1xuICB2YXIgdyA9IDgwO1xuICB2YXIgaCA9IDMwMDtcblxuICB2YXIgc3ZnID0gZDMuc2VsZWN0KGJpbmRUbykuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgdylcbiAgICAuYXR0cihcImhlaWdodFwiLCBoIClcbiAgICAuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLDMwMClcIik7XG5cbiAgdmFyIG1hdHJpeCA9IFt2YWx1ZXNdO1xuXG4gIC8vIFJhbmRvbSBmb3Igbm93XG4gIHZhciBjb2xvcnMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRyaXhbMF0ubGVuZ3RoIC0xOyBpKyspIHtcbiAgICBjb2xvcnMucHVzaCgncmdiKCcgKyByYW5kb21SR0IoKSArICcsJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnKScpO1xuICB9XG5cbiAgeCA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZVJvdW5kQmFuZHMoWzAsIHddKTtcbiAgeSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFswLCBoXSk7XG4gIHogPSBkMy5zY2FsZS5vcmRpbmFsKCkucmFuZ2UoY29sb3JzKTtcblxuICB2YXIgcmVtYXBwZWQgPVtcImMxXCIsXCJjMlwiLFwiYzNcIixcImM0XCIsXCJjNVwiXS5tYXAoZnVuY3Rpb24oZGF0LGkpe1xuICAgIHJldHVybiBtYXRyaXgubWFwKGZ1bmN0aW9uKGQsaWkpe1xuICAgICAgcmV0dXJuIHt4OiBpaSwgeTogZFtpKzFdIH07XG4gICAgfSlcbiAgfSk7XG5cbiAgdmFyIHN0YWNrZWQgPSBkMy5sYXlvdXQuc3RhY2soKShyZW1hcHBlZCk7XG5cbiAgeC5kb21haW4oc3RhY2tlZFswXS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KSk7XG4gIHkuZG9tYWluKFswLCBkMy5tYXgoc3RhY2tlZFtzdGFja2VkLmxlbmd0aCAtIDFdLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkwICsgZC55OyB9KV0pO1xuXG4gIHZhciB2YWxncm91cCA9IHN2Zy5zZWxlY3RBbGwoXCJnLnZhbGdyb3VwXCIpXG4gICAgLmRhdGEoc3RhY2tlZClcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ2YWxncm91cFwiKVxuICAgIC5zdHlsZShcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4geihpKTsgfSlcbiAgICAuc3R5bGUoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gZDMucmdiKHooaSkpLmRhcmtlcigpOyB9KTtcblxuICB2YXIgcmVjdCA9IHZhbGdyb3VwLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAuZGF0YShmdW5jdGlvbihkKXtyZXR1cm4gZDt9KVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHgoZC54KTsgfSlcbiAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gLXkoZC55MCkgLSB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLnkpOyB9KVxuICAgIC5hdHRyKFwid2lkdGhcIiwgTWF0aC5taW4uYXBwbHkobnVsbCwgW3gucmFuZ2VCYW5kKCktMiwgMTAwXSkpO1xufVxuXG4iLCIvLyByZWZlcmVuY2U6IGh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kLzFyalpaZzE5Z0g0U1QzWEZmUGFVbXZnQzkwQUNLZ1J3OHgtTWdvb3prTGZJL2VkaXQjZ2lkPTBcblxuXG5mdW5jdGlvbiBzaG9ja2luZ1VwZGF0ZShpbnB1dHMpIHtcblxuXHRjb25zb2xlLmxvZyhcInNob2NraW5nVXBkYXRlIC0gSW5wdXRzOiBcIiArIEpTT04uc3RyaW5naWZ5KGlucHV0cykpO1xuXG5cdHZhciBiYXNlbGluZSA9IGdldEJhc2VsaW5lKCk7XG5cdHZhciBnZW5fcHJvZHVjdGlvbiA9IGJhc2VsaW5lWydnZW5fcHJvZHVjdGlvbiddO1xuXHR2YXIgZ2VuX2VtaXNzaW9ucyAgPSBiYXNlbGluZVsnZ2VuX2VtaXNzaW9ucyddO1xuXHR2YXIgZ2VuX2Nvc3QgICAgICAgPSBiYXNlbGluZVsnZ2VuX2Nvc3QnXTtcblxuXHQvLyBhbm51YWwgdmVoaWNsZSBmbGVldCBlbWlzc2lvbnMgaW4gS2lsb3RvbnMgb2YgQ08yIEVxdWl2YWxlbnRcblx0dmFyIGZsZWV0X2VtaXNzaW9ucyA9IHtcblx0XHQnUm9hZCc6IDEyNjg4XG5cdH1cbiBcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0Ly8gQnVzaW5lc3MgbG9naWNcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tXG5cdC8vIFsxXSBFbGVjdHJpYyBjYXJzXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tXG5cblx0Ly8gQVNTVU1QVElPTjogdGhlcmUgYXJlIGVzc2VudGlhbGx5IDAgZWxlY3RyaWMgY2FycyBpbiB0aGUgY3VycmVudCBmbGVldFxuXHR2YXIgZWxlY3RyaWNfY2FycyA9IGlucHV0c1snZWxlY3RyaWNfY2FycyddO1xuXHR2YXIgZWxlY3RyaWNfcGN0ID0gZWxlY3RyaWNfY2Fycy8xMDA7XG5cblx0ZmxlZXRfZW1pc3Npb25zWydSb2FkJ10gPSBmbGVldF9lbWlzc2lvbnNbJ1JvYWQnXSAqICgxLWVsZWN0cmljX3BjdCk7XG5cblx0Ly8gQVNTVU1QVElPTjogYW55IHVwdGljayBpbiBwb3dlciBnZW5lcmF0aW9uIHJlcXVpcmVkIHRvIG1lZXRcblx0Ly8gZWxlY3RyaWMgY2FyIGRlbWFuZCwgd2lsbCBiZSBtZXQgcHJvcG9ydGlvbmFsbHkgYnkgYWxsIGdlbmVyYXRpb24gc291cmNlc1xuXHQvLyBBU1NVTVBUSU9OOiB0eXBpY2FsIEVWIHdpbGwgdXNlIDAuMiBrV2ggZm9yIDEga20gdHJhdmVsbGVkXG5cdC8vIGF2ZXJhZ2UgdHJhdmVsIGlzIDEyMDMyIGttIHBlciB5ZWFyXG5cdC8vIGZsZWV0IHNpemUgaXMgMzM0MTAxM1xuXHRldl9wb3dlcl9yZXF0cyA9IDEyMDMyICogMC4yICogMzM0MTAxMyAqIGVsZWN0cmljX3BjdDtcblx0XG5cdC8vIGNvbnZlcnQga3doIHRvIGd3aFxuXHRldl9wb3dlcl9yZXF0cyA9IGV2X3Bvd2VyX3JlcXRzIC8gMTAwMDAwMDtcblxuXHQvLyB3b3JrIG91dCB0b3RhbCBjdXJyZW50IGdlbmVyYXRpb25cblx0dmFyIHRvdGFsX2dlbiA9IDA7XG5cdGZvciAodmFyIGtleSBpbiBnZW5fcHJvZHVjdGlvbikge1xuXHRcdHRvdGFsX2dlbiArPSBnZW5fcHJvZHVjdGlvbltrZXldO1xuXHR9XG5cblx0dmFyIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzID0gMSArIChldl9wb3dlcl9yZXF0cyAvIHRvdGFsX2dlbik7XG5cdGNvbnNvbGUubG9nKCd0b3RhbDogJyArIHRvdGFsX2dlbik7XG5cdGNvbnNvbGUubG9nKCdpbmNyZWFzZSBmcm9tIGVsZWN0cmljIHZlaGljbGVzOiAnICsgaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMpO1xuXG5cdGNvbnNvbGUubG9nKCdldl9wb3dlcl9yZXF0cyAnICsgZXZfcG93ZXJfcmVxdHMpO1xuXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tXG5cdC8vIFsyXSBTb2xhciBIb3VzZXNcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblx0dmFyIHNvbGFyX2hvdXNlcyA9IGlucHV0c1snc29sYXJfaG91c2VzJ107XG5cblx0Ly8gQVNTVU1QVElPTiAtIGVhY2ggaG91c2Vob2xkIGdlbmVyYXRlcyA1MjYwIEtXaCBwZXIgeWVhclxuXHR2YXIgc29sYXJfcHJvZHVjdGlvbiA9IGlucHV0c1snc29sYXJfaG91c2VzJ10gKiA1MjYwO1xuXHQvLyBjb252ZXJ0IHRvIEd3aFxuXHRzb2xhcl9wcm9kdWN0aW9uID0gc29sYXJfcHJvZHVjdGlvbiAvIDEwMDAwMDA7XG5cblx0Y29uc29sZS5sb2coJ3NvbGFyIHByb2R1Y3Rpb246ICcgKyBzb2xhcl9wcm9kdWN0aW9uKTtcblx0XG5cdC8vIHJlZHVjZSBwcm9wb3J0aW9uYWxseSBhbGwgdGhlIG90aGVyIHByb2R1Y3Rpb24gYW5kIGVtaXNzaW9uc1xuXHR2YXIgZGVjcmVhc2VfZHVlX3RvX3NvbGFyID0gc29sYXJfcHJvZHVjdGlvbiAvIHRvdGFsX2dlbjtcblx0aW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMgLT0gZGVjcmVhc2VfZHVlX3RvX3NvbGFyO1xuXHRcblx0Zm9yICh2YXIga2V5IGluIGdlbl9lbWlzc2lvbnMpIHtcblx0XHRnZW5fZW1pc3Npb25zW2tleV0gPSBnZW5fZW1pc3Npb25zW2tleV0gKiBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cztcblx0fVxuXG5cdC8vIGFwcGx5IHRoZSBmYWN0b3IgdG8gdGhlIHByb2R1Y3Rpb25cblx0Zm9yICh2YXIga2V5IGluIGdlbl9wcm9kdWN0aW9uKSB7XG5cdFx0Z2VuX3Byb2R1Y3Rpb25ba2V5XSA9IGdlbl9wcm9kdWN0aW9uW2tleV0gKiBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cztcblx0fVxuXG5cdC8vIG5vdyBhZGQgaW4gdGhlIHNvbGFyXG5cdGdlbl9wcm9kdWN0aW9uWydTb2xhciddID0gc29sYXJfcHJvZHVjdGlvbjtcblxuXHQvLyBub3cgYXBwbHkgdGhhdCBmYWN0b3IgdG8gdGhlIGVtaXNzaW9ucyAtIGVtaXNzaW9ucyBmcm9tIEVWIHBvd2VyIHJlcXVpcmVtZW50c1xuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX2VtaXNzaW9ucykge1xuXHRcdGdlbl9lbWlzc2lvbnNba2V5XSA9IGdlbl9lbWlzc2lvbnNba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gYWxzbyBhcHBseSB0aGUgc2FtZSBmYWN0b3IgdG8gdGhlIGdlbmVyYXRpb24gY29zdFxuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX2Nvc3QpIHtcblx0XHRnZW5fY29zdFtrZXldID0gZ2VuX2Nvc3Rba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0Ly8gT3V0cHV0XG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdHZhciByZXN1bHQgPSB7XG5cdFx0J2dlbl9wcm9kdWN0aW9uJzogZ2VuX3Byb2R1Y3Rpb24sXG5cdFx0J2dlbl9lbWlzc2lvbnMnOiBnZW5fZW1pc3Npb25zLFxuXHRcdCdnZW5fY29zdCc6IGdlbl9jb3N0LFxuXHRcdCdmbGVldF9lbWlzc2lvbnMnOiBmbGVldF9lbWlzc2lvbnNcblx0fVxuXG5cdGNvbnNvbGUubG9nKFwiUmVzdWx0OiBcIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpO1xuXG5cdHJldHVybiByZXN1bHQ7XG59XG5cblxuZnVuY3Rpb24gZ2V0QmFzZWxpbmUoKSB7XG5cblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0Ly8gQmFzZWxpbmUgZGF0YSA6IDIwMTMvMjAxNFxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG5cdC8vIGFubnVhbCBnZW5lcmF0aW9uIGluIEdpZ2F3YXR0IEhvdXJzXG5cdHZhciBnZW5fcHJvZHVjdGlvbiA9IHtcblx0XHQnSHlkcm8nOiAyNDA5NSxcblx0XHQnR2VvdGhlcm1hbCc6IDY0ODcsXG5cdFx0J1dpbmQnOiAyMTg3LFxuXHRcdCdDb2FsJzogMTgzMixcblx0XHQnR2FzJzogNjYyNlxuXHR9XG5cblx0Ly8gYW5udWFsIGdlbmVyYXRpb24gZW1pc3Npb25zIGluIEtpbG90b25zIG9mIENPMiBFcXVpdmFsZW50XG5cdHZhciBnZW5fZW1pc3Npb25zID0ge1xuXHRcdCdIeWRybyc6IDAsXG5cdFx0J0dlb3RoZXJtYWwnOiA4NDcuMzIsXG5cdFx0J1dpbmQnOiAwLFxuXHRcdCdDb2FsJzogMTIyMi4yLFxuXHRcdCdHYXMnOiAzNDA1LjUxXG5cdH1cblxuXHQvLyBhbm51YWwgZ2VuZXJhdGlvbiBjb3N0cyBpbiAuLi4/XG5cdC8vIFRPRE86IHdhaXRpbmcgZm9yIHRoZSBhY3R1YWwgbnVtYmVyc1xuXHR2YXIgZ2VuX2Nvc3QgPSB7XG5cdFx0J0h5ZHJvJzogMTAwLFxuXHRcdCdHZW90aGVybWFsJzogMTUwLFxuXHRcdCdXaW5kJzogMjAwLFxuXHRcdCdDb2FsJzogMjUwLFxuXHRcdCdHYXMnOiAzMDBcblx0fVxuXG5cdHZhciByZXN1bHQgPSB7XG5cdFx0J2dlbl9wcm9kdWN0aW9uJzogZ2VuX3Byb2R1Y3Rpb24sXG5cdFx0J2dlbl9lbWlzc2lvbnMnOiBnZW5fZW1pc3Npb25zLFxuXHRcdCdnZW5fY29zdCc6IGdlbl9jb3N0LFxuXHR9XG5cblx0cmV0dXJuIHJlc3VsdDtcbn1cbiIsImZ1bmN0aW9uIG1vY2tHV2ggKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDI0MDk1LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4Nyxcblx0XHQnV2luZCc6IDIxODcsXG5cdFx0J0NvYWwnOiAxODMyLFxuXHRcdCdHYXMnOiA2NjI2XG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tBZGp1c3RHV2ggKCkge1xuICByZXR1cm4ge1xuXHRcdCdIeWRybyc6IDI0LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4LFxuXHRcdCdXaW5kJzogMTIxOCxcblx0XHQnQ29hbCc6IDgzMixcblx0XHQnR2FzJzogMzYyXG5cdH07XG59XG5cbmZ1bmN0aW9uIG1vY2tHZW5lcmF0aW9uRW1pc3Npb25zICgpIHtcbiAgcmV0dXJuIHtcblx0XHQnSHlkcm8nOiAwLFxuXHRcdCdHZW90aGVybWFsJzogODQ3LjMyLFxuXHRcdCdXaW5kJzogMCxcblx0XHQnQ29hbCc6IDEyMjIuMixcblx0XHQnR2FzJzogMzQwNS41MVxuXHR9O1xufVxuXG5mdW5jdGlvbiBtb2NrRmxlZXRFbWlzc2lvbnMgKCkge1xuICByZXR1cm4ge1xuXHRcdCdSb2FkJzogMTI2ODhcblx0fTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==