function getRangeValues(){return{carNumber:document.getElementById("carNumber").value,solarNumber:document.getElementById("solarNumber").value,homeNumber:document.getElementById("homeNumber").value,powerOffNumber:document.getElementById("powerOffNumber").value,windfarmNumber:document.getElementById("windfarmNumber").value,busNumber:document.getElementById("busNumber").value,bicycleNumber:document.getElementById("bicycleNumber").value}}function updateCars(e){document.getElementById("carNumber").value=e,document.getElementById("carRange").value=e;var t=shockingUpdate(getRangeValues());updateGraph("gwh-chart",t.gen_production),updateGraph("co2-chart",{Geothermal:t.gen_emissions.Geothermal,Coal:t.gen_emissions.Coal,Gas:t.gen_emissions.Gas,Road:t.fleet_emissions.Road})}function preprocessData(e,t){var r=[1],n=0;for(var a in e)e.hasOwnProperty(a)&&(n+=e[a],r.push(e[a]));t>0&&r.push(t);for(var o=1;o<r.length;o++)r[o]=Math.round(r[o]/n*100);return r}function updateTotal(e,t){var r=0;for(var n in t)t.hasOwnProperty(n)&&(r+=t[n]);return r=Math.round(r),document.getElementById(e).innerHTML=r,r}function updateGraph(e,t){var r=80,n=300,a=e.split("-")[0]+"-total",o=updateTotal(a,t);totals[a]||(totals[a]=parseInt(document.getElementById(a).innerHTML,10));for(var l=totals[a]-o,u=document.getElementById(e);u.firstChild;)u.removeChild(u.firstChild);for(var s=d3.select("#"+e).append("svg:svg").attr("class","chart").attr("width",r).attr("height",n).append("svg:g").attr("transform","translate(0,"+n+")"),d=[preprocessData(t,l)],c=[],i=0;i<d[0].length-1;i++)c.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");l>0&&(c[d[0].length-1]="rgb(255,255,255)"),x=d3.scale.ordinal().rangeRoundBands([0,r]),y=d3.scale.linear().range([0,n]),z=d3.scale.ordinal().range(c);for(var m=[],i=1;i<d[0].length;i++)m.push("c"+i);var g=m.map(function(e,t){return d.map(function(e,r){return{x:r,y:e[t+1]}})}),p=d3.layout.stack()(g);x.domain(p[0].map(function(e){return e.x})),y.domain([0,d3.max(p[p.length-1],function(e){return e.y0+e.y})]);{var f=s.selectAll("g.valgroup").data(p).enter().append("svg:g").attr("class","valgroup").style("fill",function(e,t){return z(t)}).style("stroke",function(e,t){return d3.rgb(z(t)).darker()});f.selectAll("rect").data(function(e){return e}).enter().append("svg:rect").attr("x",function(e){return x(e.x)}).attr("y",function(e){return-y(e.y0)-y(e.y)}).attr("height",function(e){return y(e.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function randomRGB(){return Math.floor(256*Math.random())}function columnGraph(e,t){for(var r=80,n=300,a=d3.select(e).append("svg:svg").attr("class","chart").attr("width",r).attr("height",n).append("svg:g").attr("transform","translate(0,300)"),o=[t],l=[],u=0;u<o[0].length-1;u++)l.push("rgb("+randomRGB()+","+randomRGB()+","+randomRGB()+")");x=d3.scale.ordinal().rangeRoundBands([0,r]),y=d3.scale.linear().range([0,n]),z=d3.scale.ordinal().range(l);var s=["c1","c2","c3","c4","c5"].map(function(e,t){return o.map(function(e,r){return{x:r,y:e[t+1]}})}),d=d3.layout.stack()(s);x.domain(d[0].map(function(e){return e.x})),y.domain([0,d3.max(d[d.length-1],function(e){return e.y0+e.y})]);{var c=a.selectAll("g.valgroup").data(d).enter().append("svg:g").attr("class","valgroup").style("fill",function(e,t){return z(t)}).style("stroke",function(e,t){return d3.rgb(z(t)).darker()});c.selectAll("rect").data(function(e){return e}).enter().append("svg:rect").attr("x",function(e){return x(e.x)}).attr("y",function(e){return-y(e.y0)-y(e.y)}).attr("height",function(e){return y(e.y)}).attr("width",Math.min.apply(null,[x.rangeBand()-2,100]))}}function shockingUpdate(e){console.log("shockingUpdate - Inputs: "+JSON.stringify(e));var t=getBaseline(),r=t.gen_production,n=t.gen_emissions,a=t.gen_cost,o={Road:12688},l=e.carNumber,u=l/100;o.Road=o.Road*(1-u),ev_power_reqts=2406.4*3341013*u,ev_power_reqts/=1e6;var s=0;for(var d in r)s+=r[d];var c=1+ev_power_reqts/s;console.log("total: "+s),console.log("increase from electric vehicles: "+c),console.log("ev_power_reqts "+ev_power_reqts);var i=(e.solarNumber,5260*e.solarNumber);i/=1e6,console.log("solar production: "+i);var m=i/s;c-=m;for(var d in n)n[d]=n[d]*c;for(var d in r)r[d]=r[d]*c;r.Solar=i;for(var d in n)n[d]=n[d]*c;for(var d in a)a[d]=a[d]*c;var g={gen_production:r,gen_emissions:n,gen_cost:a,fleet_emissions:o};return console.log("Result: "+JSON.stringify(g)),g}function getBaseline(){var e={Hydro:24095,Geothermal:6487,Wind:2187,Coal:1832,Gas:6626},t={Hydro:0,Geothermal:847.32,Wind:0,Coal:1222.2,Gas:3405.51},r={Hydro:53872180,Geothermal:59535e3,Wind:43484e3,Coal:34177200,Gas:161044192},n={gen_production:e,gen_emissions:t,gen_cost:r};return n}var totals={};document.addEventListener("DOMContentLoaded",function(e){updateCars(0),columnGraph("#cost-chart",[1,10,15,15,35,50]),columnGraph("#investment-chart",[1,5,10,15,45,50])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXJ0LmpzIiwiZW5naW5lLmpzIl0sIm5hbWVzIjpbImdldFJhbmdlVmFsdWVzIiwiY2FyTnVtYmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwic29sYXJOdW1iZXIiLCJob21lTnVtYmVyIiwicG93ZXJPZmZOdW1iZXIiLCJ3aW5kZmFybU51bWJlciIsImJ1c051bWJlciIsImJpY3ljbGVOdW1iZXIiLCJ1cGRhdGVDYXJzIiwiZGF0YSIsInNob2NraW5nVXBkYXRlIiwidXBkYXRlR3JhcGgiLCJnZW5fcHJvZHVjdGlvbiIsIkdlb3RoZXJtYWwiLCJnZW5fZW1pc3Npb25zIiwiQ29hbCIsIkdhcyIsIlJvYWQiLCJmbGVldF9lbWlzc2lvbnMiLCJwcmVwcm9jZXNzRGF0YSIsImRlbHRhIiwidmFsdWVzIiwidG90YWwiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJwdXNoIiwiaSIsImxlbmd0aCIsIk1hdGgiLCJyb3VuZCIsInVwZGF0ZVRvdGFsIiwidG90YWxJZCIsImlubmVySFRNTCIsImJpbmRUbyIsInciLCJoIiwic3BsaXQiLCJuZXdUb3RhbCIsInRvdGFscyIsInBhcnNlSW50IiwiZWxlbWVudCIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInN2ZyIsImQzIiwic2VsZWN0IiwiYXBwZW5kIiwiYXR0ciIsIm1hdHJpeCIsImNvbG9ycyIsInJhbmRvbVJHQiIsIngiLCJzY2FsZSIsIm9yZGluYWwiLCJyYW5nZVJvdW5kQmFuZHMiLCJ5IiwibGluZWFyIiwicmFuZ2UiLCJ6IiwiYSIsInJlbWFwcGVkIiwibWFwIiwiZGF0IiwiZCIsImlpIiwic3RhY2tlZCIsImxheW91dCIsInN0YWNrIiwiZG9tYWluIiwibWF4IiwieTAiLCJ2YWxncm91cCIsInNlbGVjdEFsbCIsImVudGVyIiwic3R5bGUiLCJyZ2IiLCJkYXJrZXIiLCJtaW4iLCJhcHBseSIsInJhbmdlQmFuZCIsImZsb29yIiwicmFuZG9tIiwiY29sdW1uR3JhcGgiLCJpbnB1dHMiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImJhc2VsaW5lIiwiZ2V0QmFzZWxpbmUiLCJnZW5fY29zdCIsImVsZWN0cmljX3BjdCIsImV2X3Bvd2VyX3JlcXRzIiwidG90YWxfZ2VuIiwia2V5IiwiaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMiLCJzb2xhcl9wcm9kdWN0aW9uIiwiZGVjcmVhc2VfZHVlX3RvX3NvbGFyIiwicmVzdWx0IiwiSHlkcm8iLCJXaW5kIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Il0sIm1hcHBpbmdzIjoiQUFhQSxRQUFBQSxrQkFDQSxPQUNBQyxVQUFBQyxTQUFBQyxlQUFBLGFBQUFDLE1BQ0FDLFlBQUFILFNBQUFDLGVBQUEsZUFBQUMsTUFDQUUsV0FBQUosU0FBQUMsZUFBQSxjQUFBQyxNQUNBRyxlQUFBTCxTQUFBQyxlQUFBLGtCQUFBQyxNQUNBSSxlQUFBTixTQUFBQyxlQUFBLGtCQUFBQyxNQUNBSyxVQUFBUCxTQUFBQyxlQUFBLGFBQUFDLE1BQ0FNLGNBQUFSLFNBQUFDLGVBQUEsaUJBQUFDLE9BSUEsUUFBQU8sWUFBQVAsR0FDQUYsU0FBQUMsZUFBQSxhQUFBQyxNQUFBQSxFQUNBRixTQUFBQyxlQUFBLFlBQUFDLE1BQUFBLENBRUEsSUFBQVEsR0FBQUMsZUFBQWIsaUJBRUFjLGFBQUEsWUFBQUYsRUFBQUcsZ0JBQ0FELFlBQUEsYUFDQUUsV0FBQUosRUFBQUssY0FBQSxXQUNBQyxLQUFBTixFQUFBSyxjQUFBLEtBQ0FFLElBQUFQLEVBQUFLLGNBQUEsSUFDQUcsS0FBQVIsRUFBQVMsZ0JBQUEsT0NwQ0EsUUFBQUMsZ0JBQUFWLEVBQUFXLEdBRUEsR0FBQUMsSUFBQSxHQUNBQyxFQUFBLENBQ0EsS0FBQSxHQUFBQyxLQUFBZCxHQUNBQSxFQUFBZSxlQUFBRCxLQUNBRCxHQUFBYixFQUFBYyxHQUNBRixFQUFBSSxLQUFBaEIsRUFBQWMsSUFLQUgsR0FBQSxHQUNBQyxFQUFBSSxLQUFBTCxFQUlBLEtBQUEsR0FBQU0s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QUFBQyxHQUFBRCxFQUFBSCxDQUNBRSxJQUFBRSxDQUVBLEtBQUEsR0FBQUgsS0FBQWhGLEdBQ0FBLEVBQUFnRixHQUFBaEYsRUFBQWdGLEdBQUFDLENBSUEsS0FBQSxHQUFBRCxLQUFBbEYsR0FDQUEsRUFBQWtGLEdBQUFsRixFQUFBa0YsR0FBQUMsQ0FJQW5GLEdBQUEsTUFBQW9GLENBR0EsS0FBQSxHQUFBRixLQUFBaEYsR0FDQUEsRUFBQWdGLEdBQUFoRixFQUFBZ0YsR0FBQUMsQ0FJQSxLQUFBLEdBQUFELEtBQUFKLEdBQ0FBLEVBQUFJLEdBQUFKLEVBQUFJLEdBQUFDLENBTUEsSUFBQUcsSUFDQXRGLGVBQUFBLEVBQ0FFLGNBQUFBLEVBQ0E0RSxTQUFBQSxFQUNBeEUsZ0JBQUFBLEVBS0EsT0FGQWtFLFNBQUFDLElBQUEsV0FBQUMsS0FBQUMsVUFBQVcsSUFFQUEsRUFJQSxRQUFBVCxlQU9BLEdBQUE3RSxJQUNBdUYsTUFBQSxNQUNBdEYsV0FBQSxLQUNBdUYsS0FBQSxLQUNBckYsS0FBQSxLQUNBQyxJQUFBLE1BSUFGLEdBQ0FxRixNQUFBLEVBQ0F0RixXQUFBLE9BQ0F1RixLQUFBLEVBQ0FyRixLQUFBLE9BQ0FDLElBQUEsU0FJQTBFLEdBQ0FTLE1BQUEsU0FDQXRGLFdBQUEsUUFDQXVGLEtBQUEsUUFDQXJGLEtBQUEsU0FDQUMsSUFBQSxXQUdBa0YsR0FDQXRGLGVBQUFBLEVBQ0FFLGNBQUFBLEVBQ0E0RSxTQUFBQSxFQUdBLE9BQUFRLEdGbEpBLEdBQUE1RCxVQUVBdkMsVUFBQXNHLGlCQUFBLG1CQUFBLFNBQUFDLEdBQ0E5RixXQUFBLEdBQ0EwRSxZQUFBLGVBQ0EsRUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBRUFBLFlBQUEscUJBQ0EsRUFBQSxFQUFBLEdBQUEsR0FBQSxHQUFBIiwiZmlsZSI6ImpzL2FsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0b3RhbHMgPSB7fTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgdXBkYXRlQ2FycygwKTtcbiAgY29sdW1uR3JhcGgoXCIjY29zdC1jaGFydFwiLCBbXG4gICAgMSwgMTAsIDE1LCAxNSwgMzUsIDUwXG4gIF0pO1xuICBjb2x1bW5HcmFwaChcIiNpbnZlc3RtZW50LWNoYXJ0XCIsIFtcbiAgICAxLCA1LCAxMCwgMTUsIDQ1LCA1MFxuICBdKTtcbn0pO1xuXG4vLyBFYWNoIHNsaWRlcidzIHZhbHVlLCB0byBwYXNzIHRvIGNhbGN1bGF0b3JcbmZ1bmN0aW9uIGdldFJhbmdlVmFsdWVzICgpIHtcbiAgcmV0dXJuIHtcbiAgICAnY2FyTnVtYmVyJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhck51bWJlcicpLnZhbHVlLFxuICAgICdzb2xhck51bWJlcic6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb2xhck51bWJlcicpLnZhbHVlLFxuICAgICdob21lTnVtYmVyJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hvbWVOdW1iZXInKS52YWx1ZSxcbiAgICAncG93ZXJPZmZOdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG93ZXJPZmZOdW1iZXInKS52YWx1ZSxcbiAgICAnd2luZGZhcm1OdW1iZXInOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2luZGZhcm1OdW1iZXInKS52YWx1ZSxcbiAgICAnYnVzTnVtYmVyJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1c051bWJlcicpLnZhbHVlLFxuICAgICdiaWN5Y2xlTnVtYmVyJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpY3ljbGVOdW1iZXInKS52YWx1ZVxuICB9O1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDYXJzICh2YWx1ZSkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyTnVtYmVyJykudmFsdWUgPSB2YWx1ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhclJhbmdlJykudmFsdWUgPSB2YWx1ZTtcblxuICB2YXIgZGF0YSA9IHNob2NraW5nVXBkYXRlKGdldFJhbmdlVmFsdWVzKCkpO1xuXG4gIHVwZGF0ZUdyYXBoKCdnd2gtY2hhcnQnLCBkYXRhLmdlbl9wcm9kdWN0aW9uKTtcbiAgdXBkYXRlR3JhcGgoJ2NvMi1jaGFydCcsIHtcbiAgICAnR2VvdGhlcm1hbCc6IGRhdGEuZ2VuX2VtaXNzaW9uc1snR2VvdGhlcm1hbCddLFxuICAgICdDb2FsJzogZGF0YS5nZW5fZW1pc3Npb25zWydDb2FsJ10sXG4gICAgJ0dhcyc6IGRhdGEuZ2VuX2VtaXNzaW9uc1snR2FzJ10sXG4gICAgJ1JvYWQnOiBkYXRhLmZsZWV0X2VtaXNzaW9uc1snUm9hZCddXG4gIH0pO1xufVxuXG4iLCJmdW5jdGlvbiBwcmVwcm9jZXNzRGF0YSAoZGF0YSwgZGVsdGEpIHtcbiAgLy8gSG9ycmlibGUga2x1ZGdlIHRvIGdldCB0aGluZ3Mgd29ya2luZyBmb3IgcHJvb2Ygb2YgY29uY2VwdC4uLlxuICB2YXIgdmFsdWVzID0gWzFdO1xuICB2YXIgdG90YWwgPSAwO1xuICBmb3IgKHZhciBrIGluIGRhdGEpIHtcbiAgICBpZihkYXRhLmhhc093blByb3BlcnR5KGspKXtcbiAgICAgIHRvdGFsICs9IGRhdGFba107XG4gICAgICB2YWx1ZXMucHVzaChkYXRhW2tdKTtcbiAgICB9XG4gIH1cblxuICAvLyBkZWx0YSByZXByZXNlbnRzIGRpZmZlcmVuY2UgZnJvbSBvcmlnaW5hbCB0b3RhbCB2YWx1ZVxuICBpZiAoZGVsdGEgPiAwKSB7XG4gICAgdmFsdWVzLnB1c2goZGVsdGEpO1xuICB9XG5cbiAgLy8gTmVlZCBwZXJjZW50IHZhbHVlcyBmb3IgY2hhcnRcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YWx1ZXNbaV0gPSBNYXRoLnJvdW5kKCh2YWx1ZXNbaV0gLyB0b3RhbCkgKiAxMDApO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlcztcbn1cblxuZnVuY3Rpb24gdXBkYXRlVG90YWwodG90YWxJZCwgZGF0YSkge1xuICB2YXIgdG90YWwgPSAwO1xuICBmb3IgKHZhciBrIGluIGRhdGEpIHtcbiAgICBpZihkYXRhLmhhc093blByb3BlcnR5KGspKXtcbiAgICAgIHRvdGFsICs9IGRhdGFba107XG4gICAgfVxuICB9XG4gIHRvdGFsID0gTWF0aC5yb3VuZCh0b3RhbCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRvdGFsSWQpLmlubmVySFRNTCA9IHRvdGFsO1xuXG4gIHJldHVybiB0b3RhbDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlR3JhcGggKGJpbmRUbywgZGF0YSkge1xuICB2YXIgdyA9IDgwO1xuICB2YXIgaCA9IDMwMDtcblxuICB2YXIgdG90YWxJZCA9IGJpbmRUby5zcGxpdCgnLScpWzBdICsgJy10b3RhbCc7XG4gIHZhciBuZXdUb3RhbCA9IHVwZGF0ZVRvdGFsKHRvdGFsSWQsIGRhdGEpO1xuXG4gIC8vIFN0b3JlIGFzIGdsb2JhbCBmb3IgdGhlIGxpZmUgb2YgdGhlIGRvY3VtZW50XG4gIGlmICghdG90YWxzW3RvdGFsSWRdKSB7XG4gICAgdG90YWxzW3RvdGFsSWRdID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodG90YWxJZCkuaW5uZXJIVE1MLCAxMCk7XG4gIH1cbiAgdmFyIGRlbHRhID0gdG90YWxzW3RvdGFsSWRdIC0gbmV3VG90YWw7XG5cbiAgLy8gSGFja3k6IHJlbW92ZSBjaGFydCBpZiBpdCBleGlzdHNcbiAgLy8gVE9ETzogdHJhbnNpdGlvbiFcbiAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChiaW5kVG8pO1xuICB3aGlsZSAoZWxlbWVudC5maXJzdENoaWxkKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICB9XG5cbiAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnIycgKyBiaW5kVG8pLmFwcGVuZChcInN2ZzpzdmdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiY2hhcnRcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIHcpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgaCApXG4gICAgLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGggKyBcIilcIik7XG5cbiAgLy8gSWYgZGlmZmVyZW5jZSBiZXR3ZWVuIHRvdGFscyBpcyBwb3NpdGl2ZSwgYW4gYWRkaXRpb25hbCBhcnJheSBlbGVtZW50XG4gIC8vIHdpbGwgYmUgYWRkZWQgdG8gcGFkIHRoZSBjaGFydCBhcyB0aGUgdG90YWwgc2hyaW5rc1xuICB2YXIgbWF0cml4ID0gW3ByZXByb2Nlc3NEYXRhKGRhdGEsIGRlbHRhKV07XG5cbiAgLy8gUmFuZG9tIGZvciBub3dcbiAgdmFyIGNvbG9ycyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdHJpeFswXS5sZW5ndGggLTE7IGkrKykge1xuICAgIGNvbG9ycy5wdXNoKCdyZ2IoJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcpJyk7XG4gIH1cblxuICAvLyBQYWRkaW5nIGNvbG91clxuICBpZiAoZGVsdGEgPiAwKSB7XG4gICAgY29sb3JzW21hdHJpeFswXS5sZW5ndGgtMV0gPSAncmdiKDI1NSwyNTUsMjU1KSc7XG4gIH1cblxuICB4ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlUm91bmRCYW5kcyhbMCwgd10pO1xuICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKTtcbiAgeiA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZShjb2xvcnMpO1xuXG4gIC8vIENvcGUgd2l0aCB2YXJpYWJsZSBudW1iZXIgb2YgcHJvcGVydGllcywgZm9yIG5vd1xuICB2YXIgYSA9IFtdO1xuICBmb3IgKHZhciBpID0gMTsgaSA8IG1hdHJpeFswXS5sZW5ndGg7IGkrKykge1xuICAgIGEucHVzaChcImNcIiArIGkpO1xuICB9XG4gIC8vdmFyIHJlbWFwcGVkID0gW1wiYzFcIixcImMyXCIsXCJjM1wiLFwiYzRcIixcImM1XCJdLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gIHZhciByZW1hcHBlZCA9IGEubWFwKGZ1bmN0aW9uKGRhdCxpKXtcbiAgICByZXR1cm4gbWF0cml4Lm1hcChmdW5jdGlvbihkLGlpKXtcbiAgICAgIHJldHVybiB7eDogaWksIHk6IGRbaSsxXSB9O1xuICAgIH0pXG4gIH0pO1xuXG4gIHZhciBzdGFja2VkID0gZDMubGF5b3V0LnN0YWNrKCkocmVtYXBwZWQpXG5cbiAgeC5kb21haW4oc3RhY2tlZFswXS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KSk7XG4gIHkuZG9tYWluKFswLCBkMy5tYXgoc3RhY2tlZFtzdGFja2VkLmxlbmd0aCAtIDFdLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkwICsgZC55OyB9KV0pO1xuXG4gIHZhciB2YWxncm91cCA9IHN2Zy5zZWxlY3RBbGwoXCJnLnZhbGdyb3VwXCIpXG4gICAgLmRhdGEoc3RhY2tlZClcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ2YWxncm91cFwiKVxuICAgIC5zdHlsZShcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4geihpKTsgfSlcbiAgICAuc3R5bGUoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gZDMucmdiKHooaSkpLmRhcmtlcigpOyB9KTtcblxuICB2YXIgcmVjdCA9IHZhbGdyb3VwLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAuZGF0YShmdW5jdGlvbihkKXtyZXR1cm4gZDt9KVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHgoZC54KTsgfSlcbiAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gLXkoZC55MCkgLSB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLnkpOyB9KVxuICAgIC5hdHRyKFwid2lkdGhcIiwgTWF0aC5taW4uYXBwbHkobnVsbCwgW3gucmFuZ2VCYW5kKCktMiwgMTAwXSkpO1xufVxuXG5mdW5jdGlvbiByYW5kb21SR0IgKCkge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjU2KTtcbn1cblxuZnVuY3Rpb24gY29sdW1uR3JhcGggKGJpbmRUbywgdmFsdWVzKSB7XG4gIHZhciB3ID0gODA7XG4gIHZhciBoID0gMzAwO1xuXG4gIHZhciBzdmcgPSBkMy5zZWxlY3QoYmluZFRvKS5hcHBlbmQoXCJzdmc6c3ZnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcImNoYXJ0XCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGggKVxuICAgIC5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsMzAwKVwiKTtcblxuICB2YXIgbWF0cml4ID0gW3ZhbHVlc107XG5cbiAgLy8gUmFuZG9tIGZvciBub3dcbiAgdmFyIGNvbG9ycyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdHJpeFswXS5sZW5ndGggLTE7IGkrKykge1xuICAgIGNvbG9ycy5wdXNoKCdyZ2IoJyArIHJhbmRvbVJHQigpICsgJywnICsgcmFuZG9tUkdCKCkgKyAnLCcgKyByYW5kb21SR0IoKSArICcpJyk7XG4gIH1cblxuICB4ID0gZDMuc2NhbGUub3JkaW5hbCgpLnJhbmdlUm91bmRCYW5kcyhbMCwgd10pO1xuICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKTtcbiAgeiA9IGQzLnNjYWxlLm9yZGluYWwoKS5yYW5nZShjb2xvcnMpO1xuXG4gIHZhciByZW1hcHBlZCA9W1wiYzFcIixcImMyXCIsXCJjM1wiLFwiYzRcIixcImM1XCJdLm1hcChmdW5jdGlvbihkYXQsaSl7XG4gICAgcmV0dXJuIG1hdHJpeC5tYXAoZnVuY3Rpb24oZCxpaSl7XG4gICAgICByZXR1cm4ge3g6IGlpLCB5OiBkW2krMV0gfTtcbiAgICB9KVxuICB9KTtcblxuICB2YXIgc3RhY2tlZCA9IGQzLmxheW91dC5zdGFjaygpKHJlbWFwcGVkKTtcblxuICB4LmRvbWFpbihzdGFja2VkWzBdLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLng7IH0pKTtcbiAgeS5kb21haW4oWzAsIGQzLm1heChzdGFja2VkW3N0YWNrZWQubGVuZ3RoIC0gMV0sIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueTAgKyBkLnk7IH0pXSk7XG5cbiAgdmFyIHZhbGdyb3VwID0gc3ZnLnNlbGVjdEFsbChcImcudmFsZ3JvdXBcIilcbiAgICAuZGF0YShzdGFja2VkKVxuICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInZhbGdyb3VwXCIpXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiB6KGkpOyB9KVxuICAgIC5zdHlsZShcInN0cm9rZVwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBkMy5yZ2IoeihpKSkuZGFya2VyKCk7IH0pO1xuXG4gIHZhciByZWN0ID0gdmFsZ3JvdXAuc2VsZWN0QWxsKFwicmVjdFwiKVxuICAgIC5kYXRhKGZ1bmN0aW9uKGQpe3JldHVybiBkO30pXG4gICAgLmVudGVyKCkuYXBwZW5kKFwic3ZnOnJlY3RcIilcbiAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLngpOyB9KVxuICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiAteShkLnkwKSAtIHkoZC55KTsgfSlcbiAgICAuYXR0cihcImhlaWdodFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQueSk7IH0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBNYXRoLm1pbi5hcHBseShudWxsLCBbeC5yYW5nZUJhbmQoKS0yLCAxMDBdKSk7XG59XG5cbiIsIi8vIHJlZmVyZW5jZTogaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvMXJqWlpnMTlnSDRTVDNYRmZQYVVtdmdDOTBBQ0tnUnc4eC1NZ29vemtMZkkvZWRpdCNnaWQ9MFxuXG5cbmZ1bmN0aW9uIHNob2NraW5nVXBkYXRlKGlucHV0cykge1xuXG5cdGNvbnNvbGUubG9nKFwic2hvY2tpbmdVcGRhdGUgLSBJbnB1dHM6IFwiICsgSlNPTi5zdHJpbmdpZnkoaW5wdXRzKSk7XG5cblx0dmFyIGJhc2VsaW5lID0gZ2V0QmFzZWxpbmUoKTtcblx0dmFyIGdlbl9wcm9kdWN0aW9uID0gYmFzZWxpbmVbJ2dlbl9wcm9kdWN0aW9uJ107XG5cdHZhciBnZW5fZW1pc3Npb25zICA9IGJhc2VsaW5lWydnZW5fZW1pc3Npb25zJ107XG5cdHZhciBnZW5fY29zdCAgICAgICA9IGJhc2VsaW5lWydnZW5fY29zdCddO1xuXG5cdC8vIGFubnVhbCB2ZWhpY2xlIGZsZWV0IGVtaXNzaW9ucyBpbiBLaWxvdG9ucyBvZiBDTzIgRXF1aXZhbGVudFxuXHR2YXIgZmxlZXRfZW1pc3Npb25zID0ge1xuXHRcdCdSb2FkJzogMTI2ODhcblx0fVxuIFxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBCdXNpbmVzcyBsb2dpY1xuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gWzFdIEVsZWN0cmljIGNhcnNcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblxuXHQvLyBBU1NVTVBUSU9OOiB0aGVyZSBhcmUgZXNzZW50aWFsbHkgMCBlbGVjdHJpYyBjYXJzIGluIHRoZSBjdXJyZW50IGZsZWV0XG5cdHZhciBjYXJOdW1iZXIgPSBpbnB1dHNbJ2Nhck51bWJlciddO1xuXHR2YXIgZWxlY3RyaWNfcGN0ID0gY2FyTnVtYmVyLzEwMDtcblxuXHRmbGVldF9lbWlzc2lvbnNbJ1JvYWQnXSA9IGZsZWV0X2VtaXNzaW9uc1snUm9hZCddICogKDEtZWxlY3RyaWNfcGN0KTtcblxuXHQvLyBBU1NVTVBUSU9OOiBhbnkgdXB0aWNrIGluIHBvd2VyIGdlbmVyYXRpb24gcmVxdWlyZWQgdG8gbWVldFxuXHQvLyBlbGVjdHJpYyBjYXIgZGVtYW5kLCB3aWxsIGJlIG1ldCBwcm9wb3J0aW9uYWxseSBieSBhbGwgZ2VuZXJhdGlvbiBzb3VyY2VzXG5cdC8vIEFTU1VNUFRJT046IHR5cGljYWwgRVYgd2lsbCB1c2UgMC4yIGtXaCBmb3IgMSBrbSB0cmF2ZWxsZWRcblx0Ly8gYXZlcmFnZSB0cmF2ZWwgaXMgMTIwMzIga20gcGVyIHllYXJcblx0Ly8gZmxlZXQgc2l6ZSBpcyAzMzQxMDEzXG5cdGV2X3Bvd2VyX3JlcXRzID0gMTIwMzIgKiAwLjIgKiAzMzQxMDEzICogZWxlY3RyaWNfcGN0O1xuXHRcblx0Ly8gY29udmVydCBrd2ggdG8gZ3doXG5cdGV2X3Bvd2VyX3JlcXRzID0gZXZfcG93ZXJfcmVxdHMgLyAxMDAwMDAwO1xuXG5cdC8vIHdvcmsgb3V0IHRvdGFsIGN1cnJlbnQgZ2VuZXJhdGlvblxuXHR2YXIgdG90YWxfZ2VuID0gMDtcblx0Zm9yICh2YXIga2V5IGluIGdlbl9wcm9kdWN0aW9uKSB7XG5cdFx0dG90YWxfZ2VuICs9IGdlbl9wcm9kdWN0aW9uW2tleV07XG5cdH1cblxuXHR2YXIgaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHMgPSAxICsgKGV2X3Bvd2VyX3JlcXRzIC8gdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ3RvdGFsOiAnICsgdG90YWxfZ2VuKTtcblx0Y29uc29sZS5sb2coJ2luY3JlYXNlIGZyb20gZWxlY3RyaWMgdmVoaWNsZXM6ICcgKyBpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyk7XG5cblx0Y29uc29sZS5sb2coJ2V2X3Bvd2VyX3JlcXRzICcgKyBldl9wb3dlcl9yZXF0cyk7XG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gWzJdIFNvbGFyIEhvdXNlc1xuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLVxuXHR2YXIgc29sYXJOdW1iZXIgPSBpbnB1dHNbJ3NvbGFyTnVtYmVyJ107XG5cblx0Ly8gQVNTVU1QVElPTiAtIGVhY2ggaG91c2Vob2xkIGdlbmVyYXRlcyA1MjYwIEtXaCBwZXIgeWVhclxuXHR2YXIgc29sYXJfcHJvZHVjdGlvbiA9IGlucHV0c1snc29sYXJOdW1iZXInXSAqIDUyNjA7XG5cdC8vIGNvbnZlcnQgdG8gR3doXG5cdHNvbGFyX3Byb2R1Y3Rpb24gPSBzb2xhcl9wcm9kdWN0aW9uIC8gMTAwMDAwMDtcblxuXHRjb25zb2xlLmxvZygnc29sYXIgcHJvZHVjdGlvbjogJyArIHNvbGFyX3Byb2R1Y3Rpb24pO1xuXHRcblx0Ly8gcmVkdWNlIHByb3BvcnRpb25hbGx5IGFsbCB0aGUgb3RoZXIgcHJvZHVjdGlvbiBhbmQgZW1pc3Npb25zXG5cdHZhciBkZWNyZWFzZV9kdWVfdG9fc29sYXIgPSBzb2xhcl9wcm9kdWN0aW9uIC8gdG90YWxfZ2VuO1xuXHRpbmNyZWFzZV9pbl9wb3dlcl9yZXF0cyAtPSBkZWNyZWFzZV9kdWVfdG9fc29sYXI7XG5cdFxuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX2VtaXNzaW9ucykge1xuXHRcdGdlbl9lbWlzc2lvbnNba2V5XSA9IGdlbl9lbWlzc2lvbnNba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gYXBwbHkgdGhlIGZhY3RvciB0byB0aGUgcHJvZHVjdGlvblxuXHRmb3IgKHZhciBrZXkgaW4gZ2VuX3Byb2R1Y3Rpb24pIHtcblx0XHRnZW5fcHJvZHVjdGlvbltrZXldID0gZ2VuX3Byb2R1Y3Rpb25ba2V5XSAqIGluY3JlYXNlX2luX3Bvd2VyX3JlcXRzO1xuXHR9XG5cblx0Ly8gbm93IGFkZCBpbiB0aGUgc29sYXJcblx0Z2VuX3Byb2R1Y3Rpb25bJ1NvbGFyJ10gPSBzb2xhcl9wcm9kdWN0aW9uO1xuXG5cdC8vIG5vdyBhcHBseSB0aGF0IGZhY3RvciB0byB0aGUgZW1pc3Npb25zIC0gZW1pc3Npb25zIGZyb20gRVYgcG93ZXIgcmVxdWlyZW1lbnRzXG5cdGZvciAodmFyIGtleSBpbiBnZW5fZW1pc3Npb25zKSB7XG5cdFx0Z2VuX2VtaXNzaW9uc1trZXldID0gZ2VuX2VtaXNzaW9uc1trZXldICogaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHM7XG5cdH1cblxuXHQvLyBhbHNvIGFwcGx5IHRoZSBzYW1lIGZhY3RvciB0byB0aGUgZ2VuZXJhdGlvbiBjb3N0XG5cdGZvciAodmFyIGtleSBpbiBnZW5fY29zdCkge1xuXHRcdGdlbl9jb3N0W2tleV0gPSBnZW5fY29zdFtrZXldICogaW5jcmVhc2VfaW5fcG93ZXJfcmVxdHM7XG5cdH1cblxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBPdXRwdXRcblx0Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblx0dmFyIHJlc3VsdCA9IHtcblx0XHQnZ2VuX3Byb2R1Y3Rpb24nOiBnZW5fcHJvZHVjdGlvbixcblx0XHQnZ2VuX2VtaXNzaW9ucyc6IGdlbl9lbWlzc2lvbnMsXG5cdFx0J2dlbl9jb3N0JzogZ2VuX2Nvc3QsXG5cdFx0J2ZsZWV0X2VtaXNzaW9ucyc6IGZsZWV0X2VtaXNzaW9uc1xuXHR9XG5cblx0Y29uc29sZS5sb2coXCJSZXN1bHQ6IFwiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG5cblx0cmV0dXJuIHJlc3VsdDtcbn1cblxuXG5mdW5jdGlvbiBnZXRCYXNlbGluZSgpIHtcblxuXHQvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXHQvLyBCYXNlbGluZSBkYXRhIDogMjAxMy8yMDE0XG5cdC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cblx0Ly8gYW5udWFsIGdlbmVyYXRpb24gaW4gR2lnYXdhdHQgSG91cnNcblx0dmFyIGdlbl9wcm9kdWN0aW9uID0ge1xuXHRcdCdIeWRybyc6IDI0MDk1LFxuXHRcdCdHZW90aGVybWFsJzogNjQ4Nyxcblx0XHQnV2luZCc6IDIxODcsXG5cdFx0J0NvYWwnOiAxODMyLFxuXHRcdCdHYXMnOiA2NjI2XG5cdH1cblxuXHQvLyBhbm51YWwgZ2VuZXJhdGlvbiBlbWlzc2lvbnMgaW4gS2lsb3RvbnMgb2YgQ08yIEVxdWl2YWxlbnRcblx0dmFyIGdlbl9lbWlzc2lvbnMgPSB7XG5cdFx0J0h5ZHJvJzogMCxcblx0XHQnR2VvdGhlcm1hbCc6IDg0Ny4zMixcblx0XHQnV2luZCc6IDAsXG5cdFx0J0NvYWwnOiAxMjIyLjIsXG5cdFx0J0dhcyc6IDM0MDUuNTFcblx0fVxuXG5cdC8vIGFubnVhbCBnZW5lcmF0aW9uIGNvc3RzIGluICROWiBwZXIgeWVhciAoSSB0aGluaylcblx0dmFyIGdlbl9jb3N0ID0ge1xuXHRcdCdIeWRybyc6IDUzODcyMTgwLFxuXHRcdCdHZW90aGVybWFsJzogNTk1MzUwMDAsXG5cdFx0J1dpbmQnOiA0MzQ4NDAwMCxcblx0XHQnQ29hbCc6IDM0MTc3MjAwLFxuXHRcdCdHYXMnOiAxNjEwNDQxOTJcblx0fVxuXG5cdHZhciByZXN1bHQgPSB7XG5cdFx0J2dlbl9wcm9kdWN0aW9uJzogZ2VuX3Byb2R1Y3Rpb24sXG5cdFx0J2dlbl9lbWlzc2lvbnMnOiBnZW5fZW1pc3Npb25zLFxuXHRcdCdnZW5fY29zdCc6IGdlbl9jb3N0LFxuXHR9XG5cblx0cmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==